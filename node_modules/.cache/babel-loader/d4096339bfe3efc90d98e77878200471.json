{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _callbacks = require(\"../../core/utils/callbacks\");\n\nvar _callbacks2 = _interopRequireDefault(_callbacks);\n\nvar _translator = require(\"../../animation/translator\");\n\nvar _translator2 = _interopRequireDefault(_translator);\n\nvar _ui = require(\"../widget/ui.errors\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _window2 = _interopRequireDefault(_window);\n\nvar _dialog = require(\"../dialog\");\n\nvar _dialog2 = _interopRequireDefault(_dialog);\n\nvar _utils = require(\"./utils.recurrence\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _dom = require(\"../../core/utils/dom\");\n\nvar _dom2 = _interopRequireDefault(_dom);\n\nvar _date = require(\"../../core/utils/date\");\n\nvar _date2 = _interopRequireDefault(_date);\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _array = require(\"../../core/utils/array\");\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _type2 = _interopRequireDefault(_type);\n\nvar _devices = require(\"../../core/devices\");\n\nvar _devices2 = _interopRequireDefault(_devices);\n\nvar _config = require(\"../../core/config\");\n\nvar _config2 = _interopRequireDefault(_config);\n\nvar _data = require(\"../../core/utils/data\");\n\nvar _data2 = _interopRequireDefault(_data);\n\nvar _component_registrator = require(\"../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _date_serialization = require(\"../../core/utils/date_serialization\");\n\nvar _date_serialization2 = _interopRequireDefault(_date_serialization);\n\nvar _date3 = require(\"../../localization/date\");\n\nvar _date4 = _interopRequireDefault(_date3);\n\nvar _ui3 = require(\"../widget/ui.widget\");\n\nvar _ui4 = _interopRequireDefault(_ui3);\n\nvar _uiScheduler = require(\"./ui.scheduler.subscribes\");\n\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\n\nvar _desktopTooltipStrategy = require(\"./tooltip_strategies/desktopTooltipStrategy\");\n\nvar _mobileTooltipStrategy = require(\"./tooltip_strategies/mobileTooltipStrategy\");\n\nvar _appointmentPopup = require(\"./appointmentPopup\");\n\nvar _appointmentPopup2 = _interopRequireDefault(_appointmentPopup);\n\nvar _uiScheduler3 = require(\"./ui.scheduler.header\");\n\nvar _uiScheduler4 = _interopRequireDefault(_uiScheduler3);\n\nvar _uiScheduler5 = require(\"./workspaces/ui.scheduler.work_space_day\");\n\nvar _uiScheduler6 = _interopRequireDefault(_uiScheduler5);\n\nvar _uiScheduler7 = require(\"./workspaces/ui.scheduler.work_space_week\");\n\nvar _uiScheduler8 = _interopRequireDefault(_uiScheduler7);\n\nvar _uiScheduler9 = require(\"./workspaces/ui.scheduler.work_space_work_week\");\n\nvar _uiScheduler10 = _interopRequireDefault(_uiScheduler9);\n\nvar _uiScheduler11 = require(\"./workspaces/ui.scheduler.work_space_month\");\n\nvar _uiScheduler12 = _interopRequireDefault(_uiScheduler11);\n\nvar _uiScheduler13 = require(\"./workspaces/ui.scheduler.timeline_day\");\n\nvar _uiScheduler14 = _interopRequireDefault(_uiScheduler13);\n\nvar _uiScheduler15 = require(\"./workspaces/ui.scheduler.timeline_week\");\n\nvar _uiScheduler16 = _interopRequireDefault(_uiScheduler15);\n\nvar _uiScheduler17 = require(\"./workspaces/ui.scheduler.timeline_work_week\");\n\nvar _uiScheduler18 = _interopRequireDefault(_uiScheduler17);\n\nvar _uiScheduler19 = require(\"./workspaces/ui.scheduler.timeline_month\");\n\nvar _uiScheduler20 = _interopRequireDefault(_uiScheduler19);\n\nvar _uiScheduler21 = require(\"./workspaces/ui.scheduler.agenda\");\n\nvar _uiScheduler22 = _interopRequireDefault(_uiScheduler21);\n\nvar _uiScheduler23 = require(\"./ui.scheduler.resource_manager\");\n\nvar _uiScheduler24 = _interopRequireDefault(_uiScheduler23);\n\nvar _uiScheduler25 = require(\"./ui.scheduler.appointment_model\");\n\nvar _uiScheduler26 = _interopRequireDefault(_uiScheduler25);\n\nvar _uiScheduler27 = require(\"./ui.scheduler.appointments\");\n\nvar _uiScheduler28 = _interopRequireDefault(_uiScheduler27);\n\nvar _uiSchedulerAppointments = require(\"./ui.scheduler.appointments.layout_manager\");\n\nvar _uiSchedulerAppointments2 = _interopRequireDefault(_uiSchedulerAppointments);\n\nvar _compactAppointmentsHelper = require(\"./compactAppointmentsHelper\");\n\nvar _uiScheduler29 = require(\"./timezones/ui.scheduler.timezones\");\n\nvar _uiScheduler30 = _interopRequireDefault(_uiScheduler29);\n\nvar _async_template_mixin = require(\"../shared/async_template_mixin\");\n\nvar _async_template_mixin2 = _interopRequireDefault(_async_template_mixin);\n\nvar _data_helper = require(\"../../data_helper\");\n\nvar _data_helper2 = _interopRequireDefault(_data_helper);\n\nvar _ui5 = require(\"./ui.loading\");\n\nvar _ui6 = _interopRequireDefault(_ui5);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _deferred2 = _interopRequireDefault(_deferred);\n\nvar _empty_template = require(\"../../core/templates/empty_template\");\n\nvar _bindable_template = require(\"../../core/templates/bindable_template\");\n\nvar _themes = require(\"../themes\");\n\nvar _themes2 = _interopRequireDefault(_themes);\n\nvar _browser = require(\"../../core/utils/browser\");\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _support = require(\"../../core/utils/support\");\n\nvar _utils3 = require(\"./utils\");\n\nvar _utils4 = _interopRequireDefault(_utils3);\n\nvar _constants = require(\"./constants\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar when = _deferred2.default.when;\nvar Deferred = _deferred2.default.Deferred;\nvar toMs = _date2.default.dateToMilliseconds;\nvar WIDGET_CLASS = \"dx-scheduler\";\nvar WIDGET_SMALL_CLASS = \"\".concat(WIDGET_CLASS, \"-small\");\nvar WIDGET_ADAPTIVE_CLASS = \"\".concat(WIDGET_CLASS, \"-adaptive\");\nvar WIDGET_WIN_NO_TOUCH_CLASS = \"\".concat(WIDGET_CLASS, \"-win-no-touch\");\nvar WIDGET_READONLY_CLASS = \"\".concat(WIDGET_CLASS, \"-readonly\");\nvar RECURRENCE_EDITOR_ITEM_CLASS = \"\".concat(WIDGET_CLASS, \"-recurrence-rule-item\");\nvar RECURRENCE_EDITOR_OPENED_ITEM_CLASS = \"\".concat(WIDGET_CLASS, \"-recurrence-rule-item-opened\");\nvar WIDGET_SMALL_WIDTH = 400;\nvar FULL_DATE_FORMAT = \"yyyyMMddTHHmmss\";\nvar UTC_FULL_DATE_FORMAT = FULL_DATE_FORMAT + \"Z\";\nvar VIEWS_CONFIG = {\n  day: {\n    workSpace: _uiScheduler6.default,\n    renderingStrategy: \"vertical\"\n  },\n  week: {\n    workSpace: _uiScheduler8.default,\n    renderingStrategy: \"vertical\"\n  },\n  workWeek: {\n    workSpace: _uiScheduler10.default,\n    renderingStrategy: \"vertical\"\n  },\n  month: {\n    workSpace: _uiScheduler12.default,\n    renderingStrategy: \"horizontalMonth\"\n  },\n  timelineDay: {\n    workSpace: _uiScheduler14.default,\n    renderingStrategy: \"horizontal\"\n  },\n  timelineWeek: {\n    workSpace: _uiScheduler16.default,\n    renderingStrategy: \"horizontal\"\n  },\n  timelineWorkWeek: {\n    workSpace: _uiScheduler18.default,\n    renderingStrategy: \"horizontal\"\n  },\n  timelineMonth: {\n    workSpace: _uiScheduler20.default,\n    renderingStrategy: \"horizontalMonthLine\"\n  },\n  agenda: {\n    workSpace: _uiScheduler22.default,\n    renderingStrategy: \"agenda\"\n  }\n};\n\nvar Scheduler = _ui4.default.inherit({\n  _getDefaultOptions: function () {\n    return (0, _extend.extend)(this.callBase(), {\n      views: [\"day\", \"week\"],\n      currentView: \"day\",\n      currentDate: _date2.default.trimTime(new Date()),\n      min: void 0,\n      max: void 0,\n      dateSerializationFormat: void 0,\n      firstDayOfWeek: void 0,\n      groups: [],\n      resources: [],\n      dataSource: null,\n      customizeDateNavigatorText: void 0,\n      appointmentTemplate: \"item\",\n      dropDownAppointmentTemplate: \"dropDownAppointment\",\n      appointmentCollectorTemplate: \"appointmentCollector\",\n      dataCellTemplate: null,\n      timeCellTemplate: null,\n      resourceCellTemplate: null,\n      dateCellTemplate: null,\n      startDayHour: 0,\n      endDayHour: 24,\n      editing: {\n        allowAdding: true,\n        allowDeleting: true,\n        allowDragging: true,\n        allowResizing: true,\n        allowUpdating: true\n      },\n      showAllDayPanel: true,\n      showCurrentTimeIndicator: true,\n      shadeUntilCurrentTime: false,\n      indicatorUpdateInterval: 3e5,\n      indicatorTime: void 0,\n      recurrenceEditMode: \"dialog\",\n      cellDuration: 30,\n      maxAppointmentsPerCell: \"auto\",\n      selectedCellData: [],\n      groupByDate: false,\n      onAppointmentRendered: null,\n      onAppointmentClick: null,\n      onAppointmentDblClick: null,\n      onAppointmentContextMenu: null,\n      onCellClick: null,\n      onCellContextMenu: null,\n      onAppointmentAdding: null,\n      onAppointmentAdded: null,\n      onAppointmentUpdating: null,\n      onAppointmentUpdated: null,\n      onAppointmentDeleting: null,\n      onAppointmentDeleted: null,\n      onAppointmentFormOpening: null,\n      appointmentTooltipTemplate: \"appointmentTooltip\",\n      appointmentPopupTemplate: \"appointmentPopup\",\n      crossScrollingEnabled: false,\n      useDropDownViewSwitcher: false,\n      startDateExpr: \"startDate\",\n      endDateExpr: \"endDate\",\n      textExpr: \"text\",\n      descriptionExpr: \"description\",\n      allDayExpr: \"allDay\",\n      recurrenceRuleExpr: \"recurrenceRule\",\n      recurrenceExceptionExpr: \"recurrenceException\",\n      remoteFiltering: false,\n      timeZone: \"\",\n      startDateTimeZoneExpr: \"startDateTimeZone\",\n      endDateTimeZoneExpr: \"endDateTimeZone\",\n      noDataText: _message2.default.format(\"dxCollectionWidget-noDataText\"),\n      adaptivityEnabled: false,\n      allowMultipleCellSelection: true,\n      _appointmentTooltipOffset: {\n        x: 0,\n        y: 0\n      },\n      _appointmentTooltipButtonsPosition: \"bottom\",\n      _appointmentTooltipOpenButtonText: _message2.default.format(\"dxScheduler-openAppointment\"),\n      _dropDownButtonIcon: \"overflow\",\n      _appointmentCountPerCell: 2,\n      _collectorOffset: 0,\n      _appointmentOffset: 26\n    });\n  },\n  _defaultOptionsRules: function () {\n    return this.callBase().concat([{\n      device: function () {\n        return \"desktop\" === _devices2.default.real().deviceType && !_devices2.default.isSimulator();\n      },\n      options: {\n        focusStateEnabled: true\n      }\n    }, {\n      device: function () {\n        return !_devices2.default.current().generic;\n      },\n      options: {\n        useDropDownViewSwitcher: true,\n        editing: {\n          allowDragging: false,\n          allowResizing: false\n        }\n      }\n    }, {\n      device: function () {\n        return _themes2.default.isMaterial();\n      },\n      options: {\n        useDropDownViewSwitcher: true,\n        dateCellTemplate: function (data, index, element) {\n          var text = data.text;\n          text.split(\" \").forEach(function (text, index) {\n            var span = (0, _renderer2.default)(\"<span>\").text(text).addClass(\"dx-scheduler-header-panel-cell-date\");\n            (0, _renderer2.default)(element).append(span);\n\n            if (!index) {\n              (0, _renderer2.default)(element).append(\" \");\n            }\n          });\n        },\n        _appointmentTooltipOffset: {\n          x: 0,\n          y: 11\n        },\n        _appointmentTooltipButtonsPosition: \"top\",\n        _appointmentTooltipOpenButtonText: null,\n        _dropDownButtonIcon: \"chevrondown\",\n        _appointmentCountPerCell: 1,\n        _collectorOffset: 20,\n        _appointmentOffset: 30\n      }\n    }]);\n  },\n  _setDeprecatedOptions: function () {\n    this.callBase();\n    (0, _extend.extend)(this._deprecatedOptions, {\n      onAppointmentFormCreated: {\n        since: \"18.2\",\n        alias: \"onAppointmentFormOpening\"\n      },\n      dropDownAppointmentTemplate: {\n        since: \"19.2\",\n        message: \"appointmentTooltipTemplate\"\n      }\n    });\n  },\n  _postponeDataSourceLoading: function (promise) {\n    this.postponedOperations.add(\"_reloadDataSource\", this._reloadDataSource.bind(this), promise);\n  },\n  _postponeResourceLoading: function () {\n    var _this = this;\n\n    var whenLoaded = this.postponedOperations.add(\"_loadResources\", function () {\n      return _this._loadResources();\n    });\n    var resolveCallbacks = new Deferred();\n    whenLoaded.done(function (resources) {\n      resolveCallbacks.resolve(resources);\n    });\n\n    this._postponeDataSourceLoading(whenLoaded);\n\n    return resolveCallbacks.promise();\n  },\n  _optionChanged: function (args) {\n    var _this2 = this;\n\n    var value = args.value;\n    var name = args.name;\n\n    switch (args.name) {\n      case \"customizeDateNavigatorText\":\n        this._updateOption(\"header\", name, value);\n\n        break;\n\n      case \"firstDayOfWeek\":\n        this._updateOption(\"workSpace\", name, value);\n\n        this._updateOption(\"header\", name, value);\n\n        break;\n\n      case \"currentDate\":\n        value = this._dateOption(name);\n        value = _date2.default.trimTime(new Date(value));\n        this.option(\"selectedCellData\", []);\n\n        this._workSpace.option(name, new Date(value));\n\n        this._header.option(name, new Date(value));\n\n        this._header.option(\"displayedDate\", this._workSpace._getViewStartByOptions());\n\n        this._appointments.option(\"items\", []);\n\n        this._filterAppointmentsByDate();\n\n        this._postponeDataSourceLoading();\n\n        break;\n\n      case \"dataSource\":\n        this._initDataSource();\n\n        this._customizeStoreLoadOptions();\n\n        this._appointmentModel.setDataSource(this._dataSource);\n\n        this._postponeResourceLoading().done(function (resources) {\n          _this2._filterAppointmentsByDate();\n\n          _this2._updateOption(\"workSpace\", \"showAllDayPanel\", _this2.option(\"showAllDayPanel\"));\n        });\n\n        break;\n\n      case \"min\":\n      case \"max\":\n        value = this._dateOption(name);\n\n        this._updateOption(\"header\", name, new Date(value));\n\n        this._updateOption(\"workSpace\", name, new Date(value));\n\n        break;\n\n      case \"views\":\n        this._processCurrentView();\n\n        if (this._getCurrentViewOptions()) {\n          this.repaint();\n        } else {\n          this._header.option(name, value);\n        }\n\n        break;\n\n      case \"useDropDownViewSwitcher\":\n        this._header.option(name, value);\n\n        break;\n\n      case \"currentView\":\n        this._processCurrentView();\n\n        this.getLayoutManager().initRenderingStrategy(this._getAppointmentsRenderingStrategy());\n\n        this._appointments.option({\n          items: [],\n          allowDrag: this._allowDragging(),\n          allowResize: this._allowResizing(),\n          itemTemplate: this._getAppointmentTemplate(\"appointmentTemplate\")\n        });\n\n        this._postponeResourceLoading().done(function (resources) {\n          _this2._refreshWorkSpace(resources);\n\n          _this2._updateHeader();\n\n          _this2._filterAppointmentsByDate();\n\n          _this2._appointments.option(\"allowAllDayResize\", \"day\" !== value);\n        });\n\n        break;\n\n      case \"appointmentTemplate\":\n        this._appointments.option(\"itemTemplate\", value);\n\n        break;\n\n      case \"dateCellTemplate\":\n      case \"resourceCellTemplate\":\n      case \"dataCellTemplate\":\n      case \"timeCellTemplate\":\n        this._updateOption(\"workSpace\", name, value);\n\n        this.repaint();\n        break;\n\n      case \"groups\":\n        this._postponeResourceLoading().done(function (resources) {\n          _this2._refreshWorkSpace(resources);\n\n          _this2._filterAppointmentsByDate();\n        });\n\n        break;\n\n      case \"resources\":\n        this._resourcesManager.setResources(this.option(\"resources\"));\n\n        this._appointmentModel.setDataAccessors(this._combineDataAccessors());\n\n        this._postponeResourceLoading().done(function (resources) {\n          _this2._appointments.option(\"items\", []);\n\n          _this2._refreshWorkSpace(resources);\n\n          _this2._filterAppointmentsByDate();\n        });\n\n        break;\n\n      case \"startDayHour\":\n      case \"endDayHour\":\n        this._appointments.option(\"items\", []);\n\n        this._updateOption(\"workSpace\", name, value);\n\n        this._appointments.repaint();\n\n        this._filterAppointmentsByDate();\n\n        this._postponeDataSourceLoading();\n\n        break;\n\n      case \"onAppointmentAdding\":\n      case \"onAppointmentAdded\":\n      case \"onAppointmentUpdating\":\n      case \"onAppointmentUpdated\":\n      case \"onAppointmentDeleting\":\n      case \"onAppointmentDeleted\":\n      case \"onAppointmentFormOpening\":\n        this._actions[name] = this._createActionByOption(name);\n        break;\n\n      case \"onAppointmentRendered\":\n        this._appointments.option(\"onItemRendered\", this._getAppointmentRenderedAction());\n\n        break;\n\n      case \"onAppointmentClick\":\n        this._appointments.option(\"onItemClick\", this._createActionByOption(name));\n\n        break;\n\n      case \"onAppointmentDblClick\":\n        this._appointments.option(name, this._createActionByOption(name));\n\n        break;\n\n      case \"onAppointmentContextMenu\":\n        this._appointments.option(\"onItemContextMenu\", this._createActionByOption(name));\n\n        break;\n\n      case \"noDataText\":\n      case \"allowMultipleCellSelection\":\n      case \"selectedCellData\":\n      case \"accessKey\":\n      case \"onCellClick\":\n        this._workSpace.option(name, value);\n\n        break;\n\n      case \"onCellContextMenu\":\n        this._workSpace.option(name, value);\n\n        break;\n\n      case \"crossScrollingEnabled\":\n        this._postponeResourceLoading().done(function (resources) {\n          _this2._appointments.option(\"items\", []);\n\n          _this2._refreshWorkSpace(resources);\n\n          if (_this2._readyToRenderAppointments) {\n            _this2._appointments.option(\"items\", _this2._getAppointmentsToRepaint());\n          }\n        });\n\n        break;\n\n      case \"cellDuration\":\n        this._appointments.option(\"items\", []);\n\n        if (this._readyToRenderAppointments) {\n          this._updateOption(\"workSpace\", \"hoursInterval\", value / 60);\n\n          this._appointments.option(\"items\", this._getAppointmentsToRepaint());\n        }\n\n        break;\n\n      case \"tabIndex\":\n      case \"focusStateEnabled\":\n        this._updateOption(\"header\", name, value);\n\n        this._updateOption(\"workSpace\", name, value);\n\n        this._appointments.option(name, value);\n\n        this.callBase(args);\n        break;\n\n      case \"width\":\n        this._updateOption(\"header\", name, value);\n\n        if (this.option(\"crossScrollingEnabled\")) {\n          this._updateOption(\"workSpace\", \"width\", value);\n        }\n\n        this.callBase(args);\n\n        this._dimensionChanged();\n\n        break;\n\n      case \"height\":\n        this.callBase(args);\n\n        this._dimensionChanged();\n\n        break;\n\n      case \"editing\":\n        this._initEditing();\n\n        var editing = this._editing;\n\n        this._bringEditingModeToAppointments(editing);\n\n        this.hideAppointmentTooltip();\n\n        this._cleanPopup();\n\n        break;\n\n      case \"showAllDayPanel\":\n        this._postponeResourceLoading().done(function (resources) {\n          _this2._filterAppointmentsByDate();\n\n          _this2._updateOption(\"workSpace\", \"allDayExpanded\", value);\n\n          _this2._updateOption(\"workSpace\", name, value);\n        });\n\n        break;\n\n      case \"showCurrentTimeIndicator\":\n      case \"indicatorTime\":\n      case \"indicatorUpdateInterval\":\n      case \"shadeUntilCurrentTime\":\n      case \"groupByDate\":\n        this._updateOption(\"workSpace\", name, value);\n\n        this.repaint();\n        break;\n\n      case \"appointmentDragging\":\n      case \"appointmentTooltipTemplate\":\n      case \"appointmentPopupTemplate\":\n      case \"recurrenceEditMode\":\n      case \"remoteFiltering\":\n      case \"timeZone\":\n      case \"dropDownAppointmentTemplate\":\n      case \"appointmentCollectorTemplate\":\n      case \"_appointmentTooltipOffset\":\n      case \"_appointmentTooltipButtonsPosition\":\n      case \"_appointmentTooltipOpenButtonText\":\n      case \"_dropDownButtonIcon\":\n      case \"_appointmentCountPerCell\":\n      case \"_collectorOffset\":\n      case \"_appointmentOffset\":\n        this.repaint();\n        break;\n\n      case \"dateSerializationFormat\":\n        break;\n\n      case \"maxAppointmentsPerCell\":\n        break;\n\n      case \"startDateExpr\":\n      case \"endDateExpr\":\n      case \"startDateTimeZoneExpr\":\n      case \"endDateTimeZoneExpr\":\n      case \"textExpr\":\n      case \"descriptionExpr\":\n      case \"allDayExpr\":\n      case \"recurrenceRuleExpr\":\n      case \"recurrenceExceptionExpr\":\n        this._updateExpression(name, value);\n\n        this._appointmentModel.setDataAccessors(this._combineDataAccessors());\n\n        this._initAppointmentTemplate();\n\n        this.repaint();\n        break;\n\n      case \"adaptivityEnabled\":\n        this._toggleAdaptiveClass();\n\n        this.repaint();\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _updateHeader: function () {\n    var viewCountConfig = this._getViewCountConfig();\n\n    this._header.option(\"intervalCount\", viewCountConfig.intervalCount);\n\n    this._header.option(\"displayedDate\", this._workSpace._getViewStartByOptions());\n\n    this._header.option(\"min\", this._dateOption(\"min\"));\n\n    this._header.option(\"max\", this._dateOption(\"max\"));\n\n    this._header.option(\"currentDate\", this._dateOption(\"currentDate\"));\n\n    this._header.option(\"firstDayOfWeek\", this._getCurrentViewOption(\"firstDayOfWeek\"));\n\n    this._header.option(\"currentView\", this._currentView);\n  },\n  _dateOption: function (optionName) {\n    var optionValue = this._getCurrentViewOption(optionName);\n\n    return _date_serialization2.default.deserializeDate(optionValue);\n  },\n  _getSerializationFormat: function (optionName) {\n    var value = this._getCurrentViewOption(optionName);\n\n    if (\"number\" === typeof value) {\n      return \"number\";\n    }\n\n    if (!_type2.default.isString(value)) {\n      return;\n    }\n\n    return _date_serialization2.default.getDateSerializationFormat(value);\n  },\n  _bringEditingModeToAppointments: function (editing) {\n    var editingConfig = {\n      allowDelete: editing.allowUpdating && editing.allowDeleting\n    };\n\n    if (!this._isAgenda()) {\n      editingConfig.allowDrag = editing.allowDragging;\n      editingConfig.allowResize = editing.allowResizing;\n      editingConfig.allowAllDayResize = editing.allowResizing && this._supportAllDayResizing();\n    }\n\n    this._appointments.option(editingConfig);\n\n    this.repaint();\n  },\n  _isAgenda: function () {\n    return \"agenda\" === this._getAppointmentsRenderingStrategy();\n  },\n  _allowDragging: function () {\n    return this._editing.allowDragging && !this._isAgenda();\n  },\n  _allowResizing: function () {\n    return this._editing.allowResizing && !this._isAgenda();\n  },\n  _allowAllDayResizing: function () {\n    return this._editing.allowResizing && this._supportAllDayResizing();\n  },\n  _supportAllDayResizing: function () {\n    return \"day\" !== this._getCurrentViewType() || this._currentView.intervalCount > 1;\n  },\n  _isAllDayExpanded: function (items) {\n    return this.option(\"showAllDayPanel\") && this._appointmentModel.hasAllDayAppointments(items, this._getCurrentViewOption(\"startDayHour\"), this._getCurrentViewOption(\"endDayHour\"));\n  },\n  _getTimezoneOffsetByOption: function (date) {\n    return this._calculateTimezoneByValue(this.option(\"timeZone\"), date);\n  },\n  _calculateTimezoneByValue: function (timezone, date) {\n    var result = timezone;\n\n    if (\"string\" === typeof timezone) {\n      date = date || new Date();\n      var dateUtc = Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes());\n      result = _uiScheduler30.default.getTimezoneOffsetById(timezone, dateUtc);\n    }\n\n    return result;\n  },\n  _filterAppointmentsByDate: function () {\n    var dateRange = this._workSpace.getDateRange();\n\n    this._appointmentModel.filterByDate(dateRange[0], dateRange[1], this.option(\"remoteFiltering\"), this.option(\"dateSerializationFormat\"));\n  },\n  _loadResources: function () {\n    var groups = this._getCurrentViewOption(\"groups\");\n\n    var result = new Deferred();\n\n    this._resourcesManager.loadResources(groups).done(function (resources) {\n      this._loadedResources = resources;\n      result.resolve(resources);\n    }.bind(this));\n\n    return result.promise();\n  },\n  _dataSourceLoadedCallback: (0, _callbacks2.default)(),\n  _reloadDataSource: function () {\n    var result = new Deferred();\n\n    if (this._dataSource) {\n      this._dataSource.load().done(function () {\n        _ui6.default.hide();\n\n        this._fireContentReadyAction(result);\n      }.bind(this)).fail(function () {\n        _ui6.default.hide();\n\n        result.reject();\n      });\n\n      this._dataSource.isLoading() && _ui6.default.show({\n        container: this.$element(),\n        position: {\n          of: this.$element()\n        }\n      });\n    } else {\n      this._fireContentReadyAction(result);\n    }\n\n    return result.promise();\n  },\n  _fireContentReadyAction: function (result) {\n    this.callBase();\n    result && result.resolve();\n  },\n  _dimensionChanged: function () {\n    var filteredItems = this.getFilteredItems();\n\n    this._toggleSmallClass();\n\n    if (!this._isAgenda() && filteredItems && this._isVisible()) {\n      this._workSpace._cleanAllowedPositions();\n\n      this._workSpace.option(\"allDayExpanded\", this._isAllDayExpanded(filteredItems));\n\n      this._workSpace._dimensionChanged();\n\n      var appointments = this._layoutManager.createAppointmentsMap(filteredItems);\n\n      this._appointments.option(\"items\", appointments);\n    }\n\n    this.hideAppointmentTooltip();\n    this.resizePopup();\n\n    this._appointmentPopup.updatePopupFullScreenMode();\n  },\n  _clean: function () {\n    this._cleanPopup();\n\n    this.callBase();\n  },\n  _toggleSmallClass: function () {\n    var width = this.$element().get(0).getBoundingClientRect().width;\n    this.$element().toggleClass(WIDGET_SMALL_CLASS, width < WIDGET_SMALL_WIDTH);\n  },\n  _toggleAdaptiveClass: function () {\n    this.$element().toggleClass(WIDGET_ADAPTIVE_CLASS, this.option(\"adaptivityEnabled\"));\n  },\n  _visibilityChanged: function (visible) {\n    visible && this._dimensionChanged();\n  },\n  _dataSourceOptions: function () {\n    return {\n      paginate: false\n    };\n  },\n  _init: function () {\n    this._initExpressions({\n      startDate: this.option(\"startDateExpr\"),\n      endDate: this.option(\"endDateExpr\"),\n      startDateTimeZone: this.option(\"startDateTimeZoneExpr\"),\n      endDateTimeZone: this.option(\"endDateTimeZoneExpr\"),\n      allDay: this.option(\"allDayExpr\"),\n      text: this.option(\"textExpr\"),\n      description: this.option(\"descriptionExpr\"),\n      recurrenceRule: this.option(\"recurrenceRuleExpr\"),\n      recurrenceException: this.option(\"recurrenceExceptionExpr\")\n    });\n\n    this.callBase();\n\n    this._initDataSource();\n\n    this._loadedResources = [];\n    this._proxiedCustomizeStoreLoadOptionsHandler = this._customizeStoreLoadOptionsHandler.bind(this);\n\n    this._customizeStoreLoadOptions();\n\n    this.$element().addClass(WIDGET_CLASS).toggleClass(WIDGET_WIN_NO_TOUCH_CLASS, !!(_browser2.default.msie && _support.touch));\n\n    this._initEditing();\n\n    this._resourcesManager = new _uiScheduler24.default(this.option(\"resources\"));\n\n    var combinedDataAccessors = this._combineDataAccessors();\n\n    this._appointmentModel = new _uiScheduler26.default(this._dataSource, combinedDataAccessors, this.getAppointmentDurationInMinutes());\n\n    this._initActions();\n\n    this._compactAppointmentsHelper = new _compactAppointmentsHelper.CompactAppointmentsHelper(this);\n    this._subscribes = _uiScheduler2.default;\n  },\n  _initTemplates: function () {\n    this.callBase();\n\n    this._initAppointmentTemplate();\n\n    this._defaultTemplates.appointmentTooltip = new _empty_template.EmptyTemplate();\n    this._defaultTemplates.dropDownAppointment = new _empty_template.EmptyTemplate();\n  },\n  setDefaultTemplate: function (templateName, template) {\n    this._defaultTemplates[templateName] = template;\n  },\n  _initAppointmentTemplate: function () {\n    var _this3 = this;\n\n    var expr = this._dataAccessors.expr;\n\n    var createGetter = function (property) {\n      return _data2.default.compileGetter(\"appointmentData.\".concat(property));\n    };\n\n    this._defaultTemplates.item = new _bindable_template.BindableTemplate(function ($container, data, model) {\n      _this3.getAppointmentsInstance()._renderAppointmentTemplate($container, data, model);\n    }, [\"html\", \"text\", \"startDate\", \"endDate\", \"allDay\", \"description\", \"recurrenceRule\", \"recurrenceException\", \"startDateTimeZone\", \"endDateTimeZone\"], this.option(\"integrationOptions.watchMethod\"), {\n      text: createGetter(expr.textExpr),\n      startDate: createGetter(expr.startDateExpr),\n      endDate: createGetter(expr.endDateExpr),\n      startDateTimeZone: createGetter(expr.startDateTimeZoneExpr),\n      endDateTimeZone: createGetter(expr.endDateTimeZoneExpr),\n      allDay: createGetter(expr.allDayExpr),\n      recurrenceRule: createGetter(expr.recurrenceRuleExpr)\n    });\n  },\n  _combineDataAccessors: function () {\n    var resourcesDataAccessors = this._resourcesManager._dataAccessors;\n    var result = (0, _extend.extend)(true, {}, this._dataAccessors);\n    (0, _iterator.each)(resourcesDataAccessors, function (type, accessor) {\n      result[type].resources = accessor;\n    }.bind(this));\n    return result;\n  },\n  _renderContent: function () {\n    this._renderContentImpl();\n  },\n  _dataSourceChangedHandler: function (result) {\n    if (this._readyToRenderAppointments) {\n      this._workSpaceRecalculation.done(function () {\n        this._filteredItems = this.fire(\"prerenderFilter\");\n\n        this._workSpace.option(\"allDayExpanded\", this._isAllDayExpanded(this._filteredItems));\n\n        if (this._isAgenda()) {\n          this.getRenderingStrategyInstance().calculateRows(this._filteredItems, 7, this.option(\"currentDate\"), true);\n        }\n\n        if (this._filteredItems.length && this._isVisible()) {\n          this._appointments.option(\"items\", this._getAppointmentsToRepaint());\n\n          this._appointmentModel.cleanModelState();\n        } else {\n          this._appointments.option(\"items\", []);\n        }\n\n        if (this._isAgenda()) {\n          this._workSpace._renderView();\n\n          this._dataSourceLoadedCallback.fireWith(this, [result]);\n        }\n      }.bind(this));\n    }\n  },\n  _getAppointmentsToRepaint: function () {\n    var appointments = this._layoutManager.createAppointmentsMap(this._filteredItems);\n\n    return this._layoutManager.getRepaintedAppointments(appointments, this.getAppointmentsInstance().option(\"items\"));\n  },\n  _initExpressions: function (fields) {\n    var isDateField = function (field) {\n      return \"startDate\" === field || \"endDate\" === field;\n    };\n\n    if (!this._dataAccessors) {\n      this._dataAccessors = {\n        getter: {},\n        setter: {},\n        expr: {}\n      };\n    }\n\n    (0, _iterator.each)(fields, function (name, expr) {\n      if (expr) {\n        var getter = _data2.default.compileGetter(expr);\n\n        var setter = _data2.default.compileSetter(expr);\n\n        var dateGetter;\n        var dateSetter;\n\n        if (isDateField(name)) {\n          var that = this;\n\n          dateGetter = function () {\n            var value = getter.apply(this, arguments);\n\n            if ((0, _config2.default)().forceIsoDateParsing) {\n              if (!that.option(\"dateSerializationFormat\")) {\n                var format = _date_serialization2.default.getDateSerializationFormat(value);\n\n                if (format) {\n                  that.option(\"dateSerializationFormat\", format);\n                }\n              }\n\n              value = _date_serialization2.default.deserializeDate(value);\n            }\n\n            return value;\n          };\n\n          dateSetter = function (object, value) {\n            if ((0, _config2.default)().forceIsoDateParsing || that.option(\"dateSerializationFormat\")) {\n              value = _date_serialization2.default.serializeDate(value, that.option(\"dateSerializationFormat\"));\n            }\n\n            setter.call(this, object, value);\n          };\n        }\n\n        this._dataAccessors.getter[name] = dateGetter || getter;\n        this._dataAccessors.setter[name] = dateSetter || setter;\n        this._dataAccessors.expr[name + \"Expr\"] = expr;\n      } else {\n        delete this._dataAccessors.getter[name];\n        delete this._dataAccessors.setter[name];\n        delete this._dataAccessors.expr[name + \"Expr\"];\n      }\n    }.bind(this));\n  },\n  _updateExpression: function (name, value) {\n    var exprObj = {};\n    exprObj[name.replace(\"Expr\", \"\")] = value;\n\n    this._initExpressions(exprObj);\n  },\n  _initEditing: function () {\n    var editing = this.option(\"editing\");\n    this._editing = {\n      allowAdding: !!editing,\n      allowUpdating: !!editing,\n      allowDeleting: !!editing,\n      allowResizing: !!editing,\n      allowDragging: !!editing\n    };\n\n    if (_type2.default.isObject(editing)) {\n      this._editing = (0, _extend.extend)(this._editing, editing);\n    }\n\n    this._editing.allowDragging = this._editing.allowDragging && this._editing.allowUpdating;\n    this._editing.allowResizing = this._editing.allowResizing && this._editing.allowUpdating;\n    this.$element().toggleClass(WIDGET_READONLY_CLASS, this._isReadOnly());\n  },\n  _isReadOnly: function () {\n    var result = true;\n    var editing = this._editing;\n\n    for (var prop in editing) {\n      if (Object.prototype.hasOwnProperty.call(editing, prop)) {\n        result = result && !editing[prop];\n      }\n    }\n\n    return result;\n  },\n  _customizeStoreLoadOptions: function () {\n    this._dataSource && this._dataSource.on(\"customizeStoreLoadOptions\", this._proxiedCustomizeStoreLoadOptionsHandler);\n  },\n  _dispose: function () {\n    this._appointmentTooltip && this._appointmentTooltip.dispose();\n    this.hideAppointmentPopup();\n    this.hideAppointmentTooltip();\n\n    this._cleanAsyncTemplatesTimer();\n\n    this._dataSource && this._dataSource.off(\"customizeStoreLoadOptions\", this._proxiedCustomizeStoreLoadOptionsHandler);\n    this.callBase();\n  },\n  _customizeStoreLoadOptionsHandler: function (options) {\n    options.storeLoadOptions.dxScheduler = {\n      startDate: this.getStartViewDate(),\n      endDate: this.getEndViewDate(),\n      resources: this.option(\"resources\")\n    };\n  },\n  _initActions: function () {\n    this._actions = {\n      onAppointmentAdding: this._createActionByOption(\"onAppointmentAdding\"),\n      onAppointmentAdded: this._createActionByOption(\"onAppointmentAdded\"),\n      onAppointmentUpdating: this._createActionByOption(\"onAppointmentUpdating\"),\n      onAppointmentUpdated: this._createActionByOption(\"onAppointmentUpdated\"),\n      onAppointmentDeleting: this._createActionByOption(\"onAppointmentDeleting\"),\n      onAppointmentDeleted: this._createActionByOption(\"onAppointmentDeleted\"),\n      onAppointmentFormOpening: this._createActionByOption(\"onAppointmentFormOpening\")\n    };\n  },\n  _getAppointmentRenderedAction: function () {\n    return this._createActionByOption(\"onAppointmentRendered\", {\n      excludeValidators: [\"disabled\", \"readOnly\"]\n    });\n  },\n  _renderFocusTarget: _common.noop,\n  _initMarkup: function () {\n    this.callBase();\n\n    this._processCurrentView();\n\n    this._renderHeader();\n\n    this._layoutManager = new _uiSchedulerAppointments2.default(this, this._getAppointmentsRenderingStrategy());\n    this._appointments = this._createComponent(\"<div>\", _uiScheduler28.default, this._appointmentsConfig());\n\n    this._appointments.option(\"itemTemplate\", this._getAppointmentTemplate(\"appointmentTemplate\"));\n\n    this._appointmentTooltip = new (this.option(\"adaptivityEnabled\") ? _mobileTooltipStrategy.MobileTooltipStrategy : _desktopTooltipStrategy.DesktopTooltipStrategy)(this._getAppointmentTooltipOptions());\n    this._appointmentPopup = new _appointmentPopup2.default(this);\n\n    if (this._isLoaded()) {\n      this._initMarkupCore(this._loadedResources);\n\n      this._dataSourceChangedHandler(this._dataSource.items());\n\n      this._fireContentReadyAction();\n    } else {\n      this._loadResources().done(function (resources) {\n        this._initMarkupCore(resources);\n\n        this._reloadDataSource();\n      }.bind(this));\n    }\n  },\n  _getAppointmentTooltipOptions: function () {\n    var _this4 = this;\n\n    var that = this;\n    return {\n      createComponent: that._createComponent.bind(that),\n      container: that.$element(),\n      getScrollableContainer: that.getWorkSpaceScrollableContainer.bind(that),\n      setDefaultTemplate: that.setDefaultTemplate.bind(that),\n      getAppointmentTemplate: that._getAppointmentTemplate.bind(that),\n      showAppointmentPopup: that.showAppointmentPopup.bind(that),\n      getTextAndFormatDate: function (data, currentData, format) {\n        return that.fire(\"getTextAndFormatDate\", data, currentData, format);\n      },\n      checkAndDeleteAppointment: that.checkAndDeleteAppointment.bind(that),\n      isAppointmentInAllDayPanel: that.isAppointmentInAllDayPanel.bind(that),\n      getSingleAppointmentData: function (appointmentData, targetElement) {\n        var $appointment = (0, _renderer2.default)(targetElement);\n        return _this4._getSingleAppointmentData(appointmentData, {\n          data: appointmentData,\n          target: $appointment.get(0),\n          $appointment: $appointment\n        });\n      }\n    };\n  },\n  checkAndDeleteAppointment: function (data, appointmentData) {\n    var that = this;\n    var startDate = that.fire(\"getField\", \"startDate\", appointmentData);\n\n    that._checkRecurringAppointment(data, appointmentData, startDate, function () {\n      that.deleteAppointment(data);\n    }, true);\n  },\n  _getExtraAppointmentTooltipOptions: function () {\n    return {\n      rtlEnabled: this.option(\"rtlEnabled\"),\n      focusStateEnabled: this.option(\"focusStateEnabled\"),\n      editing: this.option(\"editing\"),\n      offset: this.option(\"_appointmentTooltipOffset\")\n    };\n  },\n  isAppointmentInAllDayPanel: function (appointmentData) {\n    var workSpace = this._workSpace;\n    var itTakesAllDay = this.appointmentTakesAllDay(appointmentData);\n    return itTakesAllDay && workSpace.supportAllDayRow() && workSpace.option(\"showAllDayPanel\");\n  },\n  _initMarkupCore: function (resources) {\n    var _this5 = this;\n\n    this._readyToRenderAppointments = _window2.default.hasWindow();\n    this._workSpace && this._cleanWorkspace();\n\n    this._renderWorkSpace(resources);\n\n    this._appointments.option({\n      fixedContainer: this._workSpace.getFixedContainer(),\n      allDayContainer: this._workSpace.getAllDayContainer()\n    });\n\n    this._waitAsyncTemplates(function () {\n      _this5._workSpaceRecalculation && _this5._workSpaceRecalculation.resolve();\n    });\n\n    this._filterAppointmentsByDate();\n  },\n  _isLoaded: function () {\n    return this._isResourcesLoaded() && this._isDataSourceLoaded();\n  },\n  _isResourcesLoaded: function () {\n    return _type2.default.isDefined(this._loadedResources);\n  },\n  _isDataSourceLoaded: function () {\n    return this._dataSource && this._dataSource.isLoaded();\n  },\n  _render: function () {\n    this._toggleSmallClass();\n\n    this._toggleAdaptiveClass();\n\n    this.callBase();\n  },\n  _renderHeader: function () {\n    var $header = (0, _renderer2.default)(\"<div>\").appendTo(this.$element());\n    this._header = this._createComponent($header, _uiScheduler4.default, this._headerConfig());\n  },\n  _headerConfig: function () {\n    var result;\n\n    var currentViewOptions = this._getCurrentViewOptions();\n\n    var countConfig = this._getViewCountConfig();\n\n    result = (0, _extend.extend)({\n      firstDayOfWeek: this.option(\"firstDayOfWeek\"),\n      currentView: this._currentView,\n      tabIndex: this.option(\"tabIndex\"),\n      focusStateEnabled: this.option(\"focusStateEnabled\"),\n      width: this.option(\"width\"),\n      rtlEnabled: this.option(\"rtlEnabled\"),\n      useDropDownViewSwitcher: this.option(\"useDropDownViewSwitcher\"),\n      _dropDownButtonIcon: this.option(\"_dropDownButtonIcon\"),\n      customizeDateNavigatorText: this.option(\"customizeDateNavigatorText\")\n    }, currentViewOptions);\n    result.observer = this;\n    result.intervalCount = countConfig.intervalCount;\n    result.views = this.option(\"views\");\n    result.min = new Date(this._dateOption(\"min\"));\n    result.max = new Date(this._dateOption(\"max\"));\n    result.currentDate = _date2.default.trimTime(new Date(this._dateOption(\"currentDate\")));\n    return result;\n  },\n  _appointmentsConfig: function () {\n    var that = this;\n    var config = {\n      observer: this,\n      onItemRendered: this._getAppointmentRenderedAction(),\n      onItemClick: this._createActionByOption(\"onAppointmentClick\"),\n      onItemContextMenu: this._createActionByOption(\"onAppointmentContextMenu\"),\n      onAppointmentDblClick: this._createActionByOption(\"onAppointmentDblClick\"),\n      tabIndex: this.option(\"tabIndex\"),\n      focusStateEnabled: this.option(\"focusStateEnabled\"),\n      allowDrag: this._allowDragging(),\n      allowDelete: this._editing.allowUpdating && this._editing.allowDeleting,\n      allowResize: this._allowResizing(),\n      allowAllDayResize: this._allowAllDayResizing(),\n      rtlEnabled: this.option(\"rtlEnabled\"),\n      currentView: this.option(\"currentView\"),\n      onContentReady: function () {\n        that._workSpace && that._workSpace.option(\"allDayExpanded\", that._isAllDayExpanded(that.getFilteredItems()));\n      }\n    };\n    return config;\n  },\n  getCollectorOffset: function () {\n    if (this._workSpace.needApplyCollectorOffset() && !this.option(\"adaptivityEnabled\")) {\n      return this.option(\"_collectorOffset\");\n    } else {\n      return 0;\n    }\n  },\n  getAppointmentDurationInMinutes: function () {\n    return this._getCurrentViewOption(\"cellDuration\");\n  },\n  _processCurrentView: function () {\n    var views = this.option(\"views\");\n    var currentView = this.option(\"currentView\");\n    var that = this;\n    this._currentView = currentView;\n    (0, _iterator.each)(views, function (_, view) {\n      var isViewIsObject = _type2.default.isObject(view);\n\n      var viewName = isViewIsObject ? view.name : view;\n      var viewType = view.type;\n\n      if (currentView === viewName || currentView === viewType) {\n        that._currentView = view;\n        return false;\n      }\n    });\n  },\n  _getCurrentViewType: function () {\n    return this._currentView.type || this._currentView;\n  },\n  _getAppointmentsRenderingStrategy: function () {\n    return VIEWS_CONFIG[this._getCurrentViewType()].renderingStrategy;\n  },\n  _renderWorkSpace: function (groups) {\n    this._readyToRenderAppointments && this._toggleSmallClass();\n    var $workSpace = (0, _renderer2.default)(\"<div>\").appendTo(this.$element());\n\n    var countConfig = this._getViewCountConfig();\n\n    this._workSpace = this._createComponent($workSpace, VIEWS_CONFIG[this._getCurrentViewType()].workSpace, this._workSpaceConfig(groups, countConfig));\n    this._allowDragging() && this._workSpace.initDragBehavior(this);\n\n    this._workSpace.getWorkArea().append(this._appointments.$element());\n\n    this._recalculateWorkspace();\n\n    countConfig.startDate && this._header && this._header.option(\"currentDate\", this._workSpace._getHeaderDate());\n\n    this._appointments.option(\"_collectorOffset\", this.getCollectorOffset());\n  },\n  _getViewCountConfig: function () {\n    var currentView = this.option(\"currentView\");\n\n    var view = this._getViewByName(currentView);\n\n    var viewCount = view && view.intervalCount || 1;\n    var startDate = view && view.startDate || null;\n    return {\n      intervalCount: viewCount,\n      startDate: startDate\n    };\n  },\n  _getViewByName: function (name) {\n    var views = this.option(\"views\");\n\n    for (var i = 0; i < views.length; i++) {\n      if (views[i].name === name || views[i].type === name || views[i] === name) {\n        return views[i];\n      }\n    }\n  },\n  _recalculateWorkspace: function () {\n    var _this6 = this;\n\n    this._workSpaceRecalculation = new Deferred();\n\n    this._waitAsyncTemplates(function () {\n      _dom2.default.triggerResizeEvent(_this6._workSpace.$element());\n\n      _this6._workSpace._refreshDateTimeIndication();\n    });\n  },\n  _workSpaceConfig: function (groups, countConfig) {\n    var _this7 = this;\n\n    var result;\n\n    var currentViewOptions = this._getCurrentViewOptions();\n\n    result = (0, _extend.extend)({\n      noDataText: this.option(\"noDataText\"),\n      firstDayOfWeek: this.option(\"firstDayOfWeek\"),\n      startDayHour: this.option(\"startDayHour\"),\n      endDayHour: this.option(\"endDayHour\"),\n      tabIndex: this.option(\"tabIndex\"),\n      accessKey: this.option(\"accessKey\"),\n      focusStateEnabled: this.option(\"focusStateEnabled\"),\n      cellDuration: this.option(\"cellDuration\"),\n      showAllDayPanel: this.option(\"showAllDayPanel\"),\n      showCurrentTimeIndicator: this.option(\"showCurrentTimeIndicator\"),\n      indicatorTime: this.option(\"indicatorTime\"),\n      indicatorUpdateInterval: this.option(\"indicatorUpdateInterval\"),\n      shadeUntilCurrentTime: this.option(\"shadeUntilCurrentTime\"),\n      allDayExpanded: this._appointments.option(\"items\"),\n      crossScrollingEnabled: this.option(\"crossScrollingEnabled\"),\n      dataCellTemplate: this.option(\"dataCellTemplate\"),\n      timeCellTemplate: this.option(\"timeCellTemplate\"),\n      resourceCellTemplate: this.option(\"resourceCellTemplate\"),\n      dateCellTemplate: this.option(\"dateCellTemplate\"),\n      allowMultipleCellSelection: this.option(\"allowMultipleCellSelection\"),\n      selectedCellData: this.option(\"selectedCellData\"),\n      onSelectionChanged: function (args) {\n        _this7.option(\"selectedCellData\", args.selectedCellData);\n      },\n      groupByDate: this._getCurrentViewOption(\"groupByDate\")\n    }, currentViewOptions);\n    result.observer = this;\n    result.intervalCount = countConfig.intervalCount;\n    result.startDate = countConfig.startDate;\n    result.groups = groups;\n    result.onCellClick = this._createActionByOption(\"onCellClick\");\n    result.onCellContextMenu = this._createActionByOption(\"onCellContextMenu\");\n    result.min = new Date(this._dateOption(\"min\"));\n    result.max = new Date(this._dateOption(\"max\"));\n    result.currentDate = _date2.default.trimTime(new Date(this._dateOption(\"currentDate\")));\n    result.hoursInterval = result.cellDuration / 60;\n    result.allDayExpanded = this._isAllDayExpanded(this.getFilteredItems());\n    result.dataCellTemplate = result.dataCellTemplate ? this._getTemplate(result.dataCellTemplate) : null;\n    result.timeCellTemplate = result.timeCellTemplate ? this._getTemplate(result.timeCellTemplate) : null;\n    result.resourceCellTemplate = result.resourceCellTemplate ? this._getTemplate(result.resourceCellTemplate) : null;\n    result.dateCellTemplate = result.dateCellTemplate ? this._getTemplate(result.dateCellTemplate) : null;\n    return result;\n  },\n  _getCurrentViewOptions: function () {\n    return this._currentView;\n  },\n  _getCurrentViewOption: function (optionName) {\n    var currentViewOptions = this._getCurrentViewOptions();\n\n    if (currentViewOptions && void 0 !== currentViewOptions[optionName]) {\n      return currentViewOptions[optionName];\n    }\n\n    return this.option(optionName);\n  },\n  _getAppointmentTemplate: function (optionName) {\n    var currentViewOptions = this._getCurrentViewOptions();\n\n    if (currentViewOptions && currentViewOptions[optionName]) {\n      return this._getTemplate(currentViewOptions[optionName]);\n    }\n\n    return this._getTemplateByOption(optionName);\n  },\n  _updateOption: function (viewName, optionName, value) {\n    var currentViewOptions = this._getCurrentViewOptions();\n\n    if (!currentViewOptions || !_type2.default.isDefined(currentViewOptions[optionName])) {\n      this[\"_\" + viewName].option(optionName, value);\n    }\n  },\n  _refreshWorkSpace: function (groups) {\n    var _this8 = this;\n\n    this._cleanWorkspace();\n\n    delete this._workSpace;\n\n    this._renderWorkSpace(groups);\n\n    if (this._readyToRenderAppointments) {\n      this._appointments.option({\n        fixedContainer: this._workSpace.getFixedContainer(),\n        allDayContainer: this._workSpace.getAllDayContainer()\n      });\n\n      this._waitAsyncTemplates(function () {\n        _this8._workSpaceRecalculation.resolve();\n      });\n    }\n  },\n  _cleanWorkspace: function () {\n    this._appointments.$element().detach();\n\n    this._workSpace._dispose();\n\n    this._workSpace.$element().remove();\n\n    this.option(\"selectedCellData\", []);\n  },\n  getWorkSpaceScrollable: function () {\n    return this._workSpace.getScrollable();\n  },\n  getWorkSpaceScrollableScrollTop: function (allDay) {\n    return this._workSpace.getGroupedScrollableScrollTop(allDay);\n  },\n  getWorkSpaceScrollableScrollLeft: function () {\n    return this._workSpace.getScrollableScrollLeft();\n  },\n  getWorkSpaceScrollableContainer: function () {\n    return this._workSpace.getScrollableContainer();\n  },\n  getWorkSpaceAllDayHeight: function () {\n    return this._workSpace.getAllDayHeight();\n  },\n  getWorkSpaceAllDayOffset: function () {\n    return this._workSpace.getAllDayOffset();\n  },\n  getWorkSpaceHeaderPanelHeight: function () {\n    return this._workSpace.getHeaderPanelHeight();\n  },\n  getWorkSpaceDateTableOffset: function () {\n    return !this.option(\"crossScrollingEnabled\") || this.option(\"rtlEnabled\") ? this._workSpace.getWorkSpaceLeftOffset() : 0;\n  },\n  getWorkSpace: function () {\n    return this._workSpace;\n  },\n  getAppointmentModel: function () {\n    return this._appointmentModel;\n  },\n  getHeader: function () {\n    return this._header;\n  },\n  getMaxAppointmentsPerCell: function () {\n    return this._getCurrentViewOption(\"maxAppointmentsPerCell\");\n  },\n  _cleanPopup: function () {\n    this._appointmentPopup.dispose();\n  },\n  _convertDatesByTimezoneBack: function (applyAppointmentTimezone, sourceAppointmentData, targetAppointmentData) {\n    targetAppointmentData = targetAppointmentData || sourceAppointmentData;\n    var processedStartDate = this.fire(\"convertDateByTimezoneBack\", this.fire(\"getField\", \"startDate\", sourceAppointmentData), applyAppointmentTimezone && this.fire(\"getField\", \"startDateTimeZone\", sourceAppointmentData));\n    var processedEndDate = this.fire(\"convertDateByTimezoneBack\", this.fire(\"getField\", \"endDate\", sourceAppointmentData), applyAppointmentTimezone && this.fire(\"getField\", \"endDateTimeZone\", sourceAppointmentData));\n    this.fire(\"setField\", \"startDate\", targetAppointmentData, processedStartDate);\n    this.fire(\"setField\", \"endDate\", targetAppointmentData, processedEndDate);\n  },\n  _checkRecurringAppointment: function (targetAppointment, singleAppointment, exceptionDate, callback, isDeleted, isPopupEditing, dragEvent) {\n    delete this._updatedRecAppointment;\n    var recurrenceRule = this.fire(\"getField\", \"recurrenceRule\", targetAppointment);\n\n    if (!_utils2.default.getRecurrenceRule(recurrenceRule).isValid || !this._editing.allowUpdating) {\n      callback();\n      return;\n    }\n\n    var editMode = this.option(\"recurrenceEditMode\");\n\n    switch (editMode) {\n      case \"series\":\n        callback();\n        break;\n\n      case \"occurrence\":\n        this._singleAppointmentChangesHandler(targetAppointment, singleAppointment, exceptionDate, isDeleted, isPopupEditing, dragEvent);\n\n        break;\n\n      default:\n        if (dragEvent) {\n          dragEvent.cancel = new Deferred();\n        }\n\n        this._showRecurrenceChangeConfirm(isDeleted).done(function (result) {\n          result && callback();\n          !result && this._singleAppointmentChangesHandler(targetAppointment, singleAppointment, exceptionDate, isDeleted, isPopupEditing, dragEvent);\n        }.bind(this)).fail(function () {\n          this._appointments.moveAppointmentBack(dragEvent);\n        }.bind(this));\n\n    }\n  },\n  _singleAppointmentChangesHandler: function (targetAppointment, singleAppointment, exceptionDate, isDeleted, isPopupEditing, dragEvent) {\n    exceptionDate = new Date(exceptionDate);\n\n    function processAppointmentDates(appointment, commonTimezoneOffset) {\n      var startDate = this.fire(\"getField\", \"startDate\", appointment);\n      var processedStartDate = this.fire(\"convertDateByTimezoneBack\", startDate, this.fire(\"getField\", \"startDateTimeZone\", appointment));\n      var endDate = this.fire(\"getField\", \"endDate\", appointment);\n      var processedEndDate = this.fire(\"convertDateByTimezoneBack\", endDate, this.fire(\"getField\", \"endDateTimeZone\", appointment));\n\n      if (\"number\" === typeof commonTimezoneOffset && !isNaN(commonTimezoneOffset)) {\n        var startDateClientTzOffset = -(this._subscribes.getClientTimezoneOffset(startDate) / toMs(\"hour\"));\n        var endDateClientTzOffset = -(this._subscribes.getClientTimezoneOffset(endDate) / toMs(\"hour\"));\n        var processedStartDateInUTC = processedStartDate.getTime() - startDateClientTzOffset * toMs(\"hour\");\n        var processedEndDateInUTC = processedEndDate.getTime() - endDateClientTzOffset * toMs(\"hour\");\n        processedStartDate = new Date(processedStartDateInUTC + commonTimezoneOffset * toMs(\"hour\"));\n        processedEndDate = new Date(processedEndDateInUTC + commonTimezoneOffset * toMs(\"hour\"));\n      }\n\n      this.fire(\"setField\", \"startDate\", appointment, processedStartDate);\n      this.fire(\"setField\", \"endDate\", appointment, processedEndDate);\n    }\n\n    this.fire(\"setField\", \"recurrenceRule\", singleAppointment, \"\");\n    this.fire(\"setField\", \"recurrenceException\", singleAppointment, \"\");\n\n    if (!isDeleted && !isPopupEditing) {\n      processAppointmentDates.call(this, singleAppointment, this._getTimezoneOffsetByOption());\n      this.addAppointment(singleAppointment);\n    }\n\n    var recurrenceException = this._makeDateAsRecurrenceException(exceptionDate, targetAppointment);\n\n    var updatedAppointment = (0, _extend.extend)({}, targetAppointment);\n    this.fire(\"setField\", \"recurrenceException\", updatedAppointment, recurrenceException);\n\n    if (isPopupEditing) {\n      this._updatedRecAppointment = updatedAppointment;\n      processAppointmentDates.call(this, singleAppointment);\n\n      this._showAppointmentPopup(singleAppointment, true, true);\n\n      this._editAppointmentData = targetAppointment;\n    } else {\n      this._updateAppointment(targetAppointment, updatedAppointment, function () {\n        this._appointments.moveAppointmentBack(dragEvent);\n      }, dragEvent);\n    }\n  },\n  _makeDateAsRecurrenceException: function (exceptionDate, targetAppointment) {\n    var startDate = this._getStartDate(targetAppointment, true);\n\n    var startDateTimeZone = this.fire(\"getField\", \"startDateTimeZone\", targetAppointment);\n\n    var exceptionByDate = this._getRecurrenceExceptionDate(exceptionDate, startDate, startDateTimeZone);\n\n    var recurrenceException = this.fire(\"getField\", \"recurrenceException\", targetAppointment);\n    return recurrenceException ? recurrenceException + \",\" + exceptionByDate : exceptionByDate;\n  },\n  _getRecurrenceExceptionDate: function (exceptionStartDate, targetStartDate, startDateTimeZone) {\n    exceptionStartDate = this.fire(\"convertDateByTimezoneBack\", exceptionStartDate, startDateTimeZone);\n    var appointmentStartDate = this.fire(\"convertDateByTimezoneBack\", targetStartDate, startDateTimeZone);\n    exceptionStartDate.setHours(appointmentStartDate.getHours(), appointmentStartDate.getMinutes(), appointmentStartDate.getSeconds(), appointmentStartDate.getMilliseconds());\n    var timezoneDiff = targetStartDate.getTimezoneOffset() - exceptionStartDate.getTimezoneOffset();\n    exceptionStartDate = new Date(exceptionStartDate.getTime() - timezoneDiff * toMs(\"minute\"));\n    return _date_serialization2.default.serializeDate(exceptionStartDate, UTC_FULL_DATE_FORMAT);\n  },\n  _showRecurrenceChangeConfirm: function (isDeleted) {\n    var message = _message2.default.format(isDeleted ? \"dxScheduler-confirmRecurrenceDeleteMessage\" : \"dxScheduler-confirmRecurrenceEditMessage\");\n\n    var seriesText = _message2.default.format(isDeleted ? \"dxScheduler-confirmRecurrenceDeleteSeries\" : \"dxScheduler-confirmRecurrenceEditSeries\");\n\n    var occurrenceText = _message2.default.format(isDeleted ? \"dxScheduler-confirmRecurrenceDeleteOccurrence\" : \"dxScheduler-confirmRecurrenceEditOccurrence\");\n\n    return _dialog2.default.custom({\n      messageHtml: message,\n      showCloseButton: true,\n      showTitle: true,\n      buttons: [{\n        text: seriesText,\n        onClick: function () {\n          return true;\n        }\n      }, {\n        text: occurrenceText,\n        onClick: function () {\n          return false;\n        }\n      }]\n    }).show();\n  },\n  _getUpdatedData: function (options) {\n    var target = options.data || options;\n    var cellData = this.getTargetCellData();\n    var targetAllDay = this.fire(\"getField\", \"allDay\", target);\n    var targetStartDate = new Date(this.fire(\"getField\", \"startDate\", target));\n    var targetEndDate = new Date(this.fire(\"getField\", \"endDate\", target));\n    var date = cellData.date || targetStartDate;\n    var duration = targetEndDate.getTime() - targetStartDate.getTime();\n\n    if (this._workSpace.keepOriginalHours() && !isNaN(targetStartDate.getTime())) {\n      var diff = targetStartDate.getTime() - _date2.default.trimTime(targetStartDate).getTime();\n\n      date = new Date(_date2.default.trimTime(date).getTime() + diff);\n    }\n\n    var updatedData = {};\n    var allDay = cellData.allDay;\n    this.fire(\"setField\", \"allDay\", updatedData, allDay);\n    this.fire(\"setField\", \"startDate\", updatedData, date);\n    var endDate = new Date(date.getTime() + duration);\n\n    if (this.appointmentTakesAllDay(target) && !updatedData.allDay && this._workSpace.supportAllDayRow()) {\n      endDate = this._workSpace.calculateEndDate(date);\n    }\n\n    if (targetAllDay && !this._workSpace.supportAllDayRow() && !this._workSpace.keepOriginalHours()) {\n      var dateCopy = new Date(date);\n      dateCopy.setHours(0);\n      endDate = new Date(dateCopy.getTime() + duration);\n\n      if (0 !== endDate.getHours()) {\n        endDate.setHours(this._getCurrentViewOption(\"endDayHour\"));\n      }\n    }\n\n    endDate = new Date(endDate.getTime() - _utils4.default.getTimezoneOffsetChangeInMs(targetStartDate, targetEndDate, date, endDate));\n    this.fire(\"setField\", \"endDate\", updatedData, endDate);\n\n    this._resourcesManager.setResourcesToItem(updatedData, cellData.groups);\n\n    return updatedData;\n  },\n  _getCoordinates: function (initialDates, dates, appointmentResources, allDay) {\n    var result = [];\n\n    for (var i = 0; i < dates.length; i++) {\n      var currentCoords = this._workSpace.getCoordinatesByDateInGroup(dates[i], appointmentResources, allDay);\n\n      for (var j = 0; j < currentCoords.length; j++) {\n        (0, _extend.extend)(currentCoords[j], {\n          startDate: dates[i],\n          initialStartDate: initialDates[i]\n        });\n      }\n\n      result = result.concat(currentCoords);\n    }\n\n    return result;\n  },\n  _isAppointmentRecurrence: function (appointmentData) {\n    var recurrenceRule = this.fire(\"getField\", \"recurrenceRule\", appointmentData);\n    return recurrenceRule && _utils2.default.getRecurrenceRule(recurrenceRule).isValid;\n  },\n  resizePopup: function () {\n    this._appointmentPopup.triggerResize();\n  },\n  _getSingleAppointmentData: function (appointmentData, options) {\n    options = options || {};\n    var $appointment = options.$appointment;\n    var updatedData = options.skipDateCalculation ? {} : this._getUpdatedData(options);\n    var resultAppointmentData = (0, _extend.extend)({}, appointmentData, updatedData);\n    var allDay = this.fire(\"getField\", \"allDay\", appointmentData);\n    var isAllDay = this._workSpace.supportAllDayRow() && allDay;\n    var startDate = new Date(this.fire(\"getField\", \"startDate\", resultAppointmentData));\n    var endDate = new Date(this.fire(\"getField\", \"endDate\", resultAppointmentData));\n    var appointmentDuration = endDate.getTime() - startDate.getTime();\n    var updatedStartDate = startDate;\n    var appointmentStartDate;\n\n    if (_type2.default.isDefined($appointment) && (this._isAppointmentRecurrence(appointmentData) || this._needUpdateAppointmentData($appointment))) {\n      var apptDataCalculator = this.getRenderingStrategyInstance().getAppointmentDataCalculator();\n\n      if (_type2.default.isFunction(apptDataCalculator)) {\n        updatedStartDate = apptDataCalculator($appointment, startDate).startDate;\n      } else {\n        if (options.isAppointmentResized) {\n          var coordinates = _translator2.default.locate($appointment);\n\n          updatedStartDate = new Date(this._workSpace.getCellDataByCoordinates(coordinates, isAllDay).startDate);\n        } else {\n          appointmentStartDate = $appointment.data(\"dxAppointmentSettings\") && $appointment.data(\"dxAppointmentSettings\").startDate;\n\n          if ($appointment.hasClass(_constants.REDUCED_APPOINTMENT_CLASS)) {\n            appointmentStartDate = $appointment.data(\"dxAppointmentStartDate\");\n          }\n\n          if (appointmentStartDate) {\n            updatedStartDate = appointmentStartDate;\n          }\n        }\n\n        if (!options.skipHoursProcessing) {\n          this.fire(\"convertDateByTimezoneBack\", updatedStartDate, this.fire(\"getField\", \"startDateTimeZone\", appointmentData));\n        }\n      }\n\n      this.fire(\"setField\", \"startDate\", resultAppointmentData, updatedStartDate);\n      this.fire(\"setField\", \"endDate\", resultAppointmentData, new Date(updatedStartDate.getTime() + appointmentDuration));\n    }\n\n    return resultAppointmentData;\n  },\n  _needUpdateAppointmentData: function ($appointment) {\n    return $appointment.hasClass(_constants.COMPACT_APPOINTMENT_CLASS) || $appointment.hasClass(_constants.RECURRENCE_APPOINTMENT_CLASS);\n  },\n  subscribe: function (subject, action) {\n    this._subscribes[subject] = _uiScheduler2.default[subject] = action;\n  },\n  fire: function (subject) {\n    var callback = this._subscribes[subject];\n    var args = Array.prototype.slice.call(arguments);\n\n    if (!_type2.default.isFunction(callback)) {\n      throw _ui2.default.Error(\"E1031\", subject);\n    }\n\n    return callback.apply(this, args.slice(1));\n  },\n  getTargetCellData: function () {\n    return this._workSpace.getDataByDroppableCell();\n  },\n  _updateAppointment: function (target, appointment, onUpdatePrevented, dragEvent) {\n    var updatingOptions = {\n      newData: appointment,\n      oldData: (0, _extend.extend)({}, target),\n      cancel: false\n    };\n\n    var performFailAction = function (err) {\n      if (_type2.default.isFunction(onUpdatePrevented)) {\n        onUpdatePrevented.call(this);\n      }\n\n      if (err && \"Error\" === err.name) {\n        throw err;\n      }\n    }.bind(this);\n\n    this._actions.onAppointmentUpdating(updatingOptions);\n\n    if (dragEvent && !_type2.default.isDeferred(dragEvent.cancel)) {\n      dragEvent.cancel = new Deferred();\n    }\n\n    this._processActionResult(updatingOptions, function (canceled) {\n      if (!canceled) {\n        this._expandAllDayPanel(appointment);\n\n        try {\n          this._appointmentModel.update(target, appointment).done(function () {\n            dragEvent && dragEvent.cancel.resolve(false);\n          }).always(function (e) {\n            this._executeActionWhenOperationIsCompleted(this._actions.onAppointmentUpdated, appointment, e);\n          }.bind(this)).fail(function () {\n            performFailAction();\n          });\n        } catch (err) {\n          performFailAction(err);\n        }\n      } else {\n        performFailAction();\n      }\n    });\n  },\n  _processActionResult: function (actionOptions, callback) {\n    var _this9 = this;\n\n    if (_type2.default.isPromise(actionOptions.cancel)) {\n      when(_deferred2.default.fromPromise(actionOptions.cancel)).always(function (cancel) {\n        if (!_type2.default.isDefined(cancel)) {\n          cancel = \"rejected\" === actionOptions.cancel.state();\n        }\n\n        callback.call(_this9, cancel);\n      });\n    } else {\n      callback.call(this, actionOptions.cancel);\n    }\n  },\n  _expandAllDayPanel: function (appointment) {\n    if (!this._isAllDayExpanded(this.getFilteredItems()) && this.appointmentTakesAllDay(appointment)) {\n      this._workSpace.option(\"allDayExpanded\", true);\n    }\n  },\n  _executeActionWhenOperationIsCompleted: function (action, appointment, e) {\n    var options = {\n      appointmentData: appointment\n    };\n    var isError = e && \"Error\" === e.name;\n\n    if (isError) {\n      options.error = e;\n    } else {\n      this._appointmentPopup.isVisible() && this._appointmentPopup.hide();\n    }\n\n    action(options);\n\n    this._fireContentReadyAction();\n  },\n  _showAppointmentPopup: function (data, visibleButtons, isProcessTimeZone) {\n    this._appointmentPopup.show(data, visibleButtons, isProcessTimeZone);\n  },\n  getAppointmentPopup: function () {\n    return this._appointmentPopup.getPopup();\n  },\n  getAppointmentDetailsForm: function () {\n    return this._appointmentPopup._appointmentForm;\n  },\n  getUpdatedAppointment: function () {\n    return this._appointmentModel.getUpdatedAppointment();\n  },\n  getUpdatedAppointmentKeys: function () {\n    return this._appointmentModel.getUpdatedAppointmentKeys();\n  },\n  getAppointmentsInstance: function () {\n    return this._appointments;\n  },\n  getResourceManager: function () {\n    return this._resourcesManager;\n  },\n  getLayoutManager: function () {\n    return this._layoutManager;\n  },\n  getRenderingStrategyInstance: function () {\n    return this._layoutManager.getRenderingStrategyInstance();\n  },\n  getFilteredItems: function () {\n    return this._filteredItems;\n  },\n  getActions: function () {\n    return this._actions;\n  },\n  appointmentTakesAllDay: function (appointment) {\n    return this._appointmentModel.appointmentTakesAllDay(appointment, this._getCurrentViewOption(\"startDayHour\"), this._getCurrentViewOption(\"endDayHour\"));\n  },\n  _getStartDate: function (appointment, skipNormalize) {\n    var startDate = this.fire(\"getField\", \"startDate\", appointment);\n    var startDateTimeZone = this.fire(\"getField\", \"startDateTimeZone\", appointment);\n    startDate = this.fire(\"convertDateByTimezone\", _date2.default.makeDate(startDate), startDateTimeZone);\n    return !skipNormalize ? this.fire(\"updateAppointmentStartDate\", {\n      startDate: startDate,\n      appointment: appointment\n    }) : startDate;\n  },\n  _getEndDate: function (appointment, skipNormalize) {\n    var endDate = new Date(this.fire(\"getField\", \"endDate\", appointment));\n    var startDate = new Date(this.fire(\"getField\", \"startDate\", appointment));\n\n    var isSameDate = _date2.default.sameDate(startDate, endDate);\n\n    if (endDate) {\n      var endDateTimeZone = this.fire(\"getField\", \"endDateTimeZone\", appointment);\n      endDate = this.fire(\"convertDateByTimezone\", _date2.default.makeDate(endDate), endDateTimeZone);\n      return !skipNormalize ? this.fire(\"updateAppointmentEndDate\", {\n        endDate: endDate,\n        isSameDate: isSameDate\n      }) : endDate;\n    }\n\n    return endDate;\n  },\n  _getRecurrenceException: function (appointmentData) {\n    var recurrenceException = this.fire(\"getField\", \"recurrenceException\", appointmentData);\n\n    if (recurrenceException) {\n      var startDate = this.fire(\"getField\", \"startDate\", appointmentData);\n      var exceptions = recurrenceException.split(\",\");\n      var startDateTimeZone = this.fire(\"getField\", \"startDateTimeZone\", appointmentData);\n      var exceptionByStartDate = this.fire(\"convertDateByTimezone\", startDate, startDateTimeZone);\n\n      for (var i = 0; i < exceptions.length; i++) {\n        exceptions[i] = this._convertRecurrenceException(exceptions[i], exceptionByStartDate, startDateTimeZone);\n      }\n\n      recurrenceException = exceptions.join();\n    }\n\n    return recurrenceException;\n  },\n  _convertRecurrenceException: function (exception, exceptionByStartDate, startDateTimeZone) {\n    exception = exception.replace(/\\s/g, \"\");\n    exception = _date_serialization2.default.deserializeDate(exception);\n    exception = this.fire(\"convertDateByTimezone\", exception, startDateTimeZone);\n    exception.setHours(exceptionByStartDate.getHours());\n    exception = _date_serialization2.default.serializeDate(exception, FULL_DATE_FORMAT);\n    return exception;\n  },\n  recurrenceEditorVisibilityChanged: function (visible) {\n    if (this._appointmentPopup._appointmentForm) {\n      this._appointmentPopup._appointmentForm.$element().find(\".\" + RECURRENCE_EDITOR_ITEM_CLASS).toggleClass(RECURRENCE_EDITOR_OPENED_ITEM_CLASS, visible);\n    }\n  },\n  dayHasAppointment: function (day, appointment, trimTime) {\n    var startDate = new Date(this.fire(\"getField\", \"startDate\", appointment));\n    var endDate = new Date(this.fire(\"getField\", \"endDate\", appointment));\n    var startDateTimeZone = this.fire(\"getField\", \"startDateTimeZone\", appointment);\n    var endDateTimeZone = this.fire(\"getField\", \"endDateTimeZone\", appointment);\n    startDate = this.fire(\"convertDateByTimezone\", startDate, startDateTimeZone);\n    endDate = this.fire(\"convertDateByTimezone\", endDate, endDateTimeZone);\n\n    if (day.getTime() === endDate.getTime()) {\n      return startDate.getTime() === endDate.getTime();\n    }\n\n    if (trimTime) {\n      day = _date2.default.trimTime(day);\n      startDate = _date2.default.trimTime(startDate);\n      endDate = _date2.default.trimTime(endDate);\n    }\n\n    var dayTimeStamp = day.getTime();\n    var startDateTimeStamp = startDate.getTime();\n    var endDateTimeStamp = endDate.getTime();\n    return (0, _array.inArray)(dayTimeStamp, [startDateTimeStamp, endDateTimeStamp]) > -1 || startDateTimeStamp < dayTimeStamp && endDateTimeStamp > dayTimeStamp;\n  },\n  setTargetedAppointmentResources: function (targetedAppointment, appointmentElement, appointmentIndex) {\n    var groups = this._getCurrentViewOption(\"groups\");\n\n    if (groups && groups.length) {\n      var resourcesSetter = this._resourcesManager._dataAccessors.setter;\n      var workSpace = this._workSpace;\n      var getGroups;\n      var setResourceCallback;\n\n      if (this._isAgenda()) {\n        getGroups = function () {\n          var apptSettings = this.getLayoutManager()._positionMap[appointmentIndex];\n\n          return workSpace._getCellGroups(apptSettings[0].groupIndex);\n        };\n\n        setResourceCallback = function (_, group) {\n          resourcesSetter[group.name](targetedAppointment, group.id);\n        };\n      } else {\n        getGroups = function () {\n          var setting = (0, _renderer2.default)(appointmentElement).data(\"dxAppointmentSettings\") || {};\n          return workSpace.getCellDataByCoordinates({\n            left: setting.left,\n            top: setting.top\n          }).groups;\n        };\n\n        setResourceCallback = function (field, value) {\n          resourcesSetter[field](targetedAppointment, value);\n        };\n      }\n\n      (0, _iterator.each)(getGroups.call(this), setResourceCallback);\n    }\n  },\n  getStartViewDate: function () {\n    return this._workSpace.getStartViewDate();\n  },\n  getEndViewDate: function () {\n    return this._workSpace.getEndViewDate();\n  },\n  showAppointmentPopup: function (appointmentData, createNewAppointment, currentAppointmentData) {\n    var singleAppointment = currentAppointmentData || this._getSingleAppointmentData(appointmentData, {\n      skipDateCalculation: true\n    });\n\n    var startDate = this.fire(\"getField\", \"startDate\", currentAppointmentData || appointmentData);\n\n    this._checkRecurringAppointment(appointmentData, singleAppointment, startDate, function () {\n      if (createNewAppointment || _type2.default.isEmptyObject(appointmentData)) {\n        delete this._editAppointmentData;\n        this._editing.allowAdding && this._showAppointmentPopup(appointmentData, true, false);\n      } else {\n        this._editAppointmentData = appointmentData;\n\n        this._showAppointmentPopup(appointmentData, this._editing.allowUpdating, true);\n      }\n    }.bind(this), false, true);\n  },\n  hideAppointmentPopup: function (saveChanges) {\n    if (this._appointmentPopup.isVisible()) {\n      saveChanges && this._appointmentPopup.saveChanges();\n\n      this._appointmentPopup.hide();\n    }\n  },\n  showAppointmentTooltip: function (appointmentData, target, currentAppointmentData) {\n    if (appointmentData) {\n      this.showAppointmentTooltipCore(target, [{\n        color: this._appointments._tryGetAppointmentColor(target),\n        data: appointmentData,\n        currentData: currentAppointmentData\n      }]);\n    }\n  },\n  showAppointmentTooltipCore: function (target, data, options) {\n    if (this._appointmentTooltip.isAlreadyShown(target)) {\n      this.hideAppointmentTooltip();\n    } else {\n      this._appointmentTooltip.show(target, data, (0, _extend.extend)(this._getExtraAppointmentTooltipOptions(), options));\n    }\n  },\n  hideAppointmentTooltip: function () {\n    this._appointmentTooltip.hide();\n  },\n  scrollToTime: function (hours, minutes, date) {\n    this._workSpace.scrollToTime(hours, minutes, date);\n  },\n  addAppointment: function (appointment) {\n    var text = this.fire(\"getField\", \"text\", appointment);\n\n    if (!text) {\n      this.fire(\"setField\", \"text\", appointment, \"\");\n    }\n\n    this._convertDatesByTimezoneBack(true, appointment);\n\n    var addingOptions = {\n      appointmentData: appointment,\n      cancel: false\n    };\n\n    this._actions.onAppointmentAdding(addingOptions);\n\n    this._processActionResult(addingOptions, function (canceled) {\n      if (!canceled) {\n        this._expandAllDayPanel(appointment);\n\n        this._appointmentModel.add(appointment, {\n          value: this._getTimezoneOffsetByOption(),\n          clientOffset: this.fire(\"getClientTimezoneOffset\")\n        }).always(function (e) {\n          this._executeActionWhenOperationIsCompleted(this._actions.onAppointmentAdded, appointment, e);\n        }.bind(this));\n      }\n    });\n  },\n  updateAppointment: function (target, appointment) {\n    this._updateAppointment(target, appointment);\n  },\n  deleteAppointment: function (appointment) {\n    var deletingOptions = {\n      appointmentData: appointment,\n      cancel: false\n    };\n\n    this._actions.onAppointmentDeleting(deletingOptions);\n\n    this._processActionResult(deletingOptions, function (canceled) {\n      if (!canceled) {\n        this._appointmentModel.remove(appointment).always(function (e) {\n          this._executeActionWhenOperationIsCompleted(this._actions.onAppointmentDeleted, appointment, e);\n        }.bind(this));\n      }\n    });\n  },\n  focus: function () {\n    if (this._editAppointmentData) {\n      this._appointments.focus();\n    } else {\n      this._workSpace.focus();\n    }\n  },\n  getFirstDayOfWeek: function () {\n    return _type2.default.isDefined(this.option(\"firstDayOfWeek\")) ? this.option(\"firstDayOfWeek\") : _date4.default.firstDayOfWeekIndex();\n  }\n}).include(_async_template_mixin2.default, _data_helper2.default);\n\n(0, _component_registrator2.default)(\"dxScheduler\", Scheduler);\nmodule.exports = Scheduler;","map":{"version":3,"sources":["C:/Users/Swizzle/Desktop/SE Project/Application/csh/node_modules/devextreme/ui/scheduler/ui.scheduler.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_callbacks","_callbacks2","_translator","_translator2","_ui","_ui2","_window","_window2","_dialog","_dialog2","_utils","_utils2","_dom","_dom2","_date","_date2","_iterator","_extend","_array","_common","_type","_type2","_devices","_devices2","_config","_config2","_data","_data2","_component_registrator","_component_registrator2","_message","_message2","_date_serialization","_date_serialization2","_date3","_date4","_ui3","_ui4","_uiScheduler","_uiScheduler2","_desktopTooltipStrategy","_mobileTooltipStrategy","_appointmentPopup","_appointmentPopup2","_uiScheduler3","_uiScheduler4","_uiScheduler5","_uiScheduler6","_uiScheduler7","_uiScheduler8","_uiScheduler9","_uiScheduler10","_uiScheduler11","_uiScheduler12","_uiScheduler13","_uiScheduler14","_uiScheduler15","_uiScheduler16","_uiScheduler17","_uiScheduler18","_uiScheduler19","_uiScheduler20","_uiScheduler21","_uiScheduler22","_uiScheduler23","_uiScheduler24","_uiScheduler25","_uiScheduler26","_uiScheduler27","_uiScheduler28","_uiSchedulerAppointments","_uiSchedulerAppointments2","_compactAppointmentsHelper","_uiScheduler29","_uiScheduler30","_async_template_mixin","_async_template_mixin2","_data_helper","_data_helper2","_ui5","_ui6","_deferred","_deferred2","_empty_template","_bindable_template","_themes","_themes2","_browser","_browser2","_support","_utils3","_utils4","_constants","obj","__esModule","when","default","Deferred","toMs","dateToMilliseconds","WIDGET_CLASS","WIDGET_SMALL_CLASS","concat","WIDGET_ADAPTIVE_CLASS","WIDGET_WIN_NO_TOUCH_CLASS","WIDGET_READONLY_CLASS","RECURRENCE_EDITOR_ITEM_CLASS","RECURRENCE_EDITOR_OPENED_ITEM_CLASS","WIDGET_SMALL_WIDTH","FULL_DATE_FORMAT","UTC_FULL_DATE_FORMAT","VIEWS_CONFIG","day","workSpace","renderingStrategy","week","workWeek","month","timelineDay","timelineWeek","timelineWorkWeek","timelineMonth","agenda","Scheduler","inherit","_getDefaultOptions","extend","callBase","views","currentView","currentDate","trimTime","Date","min","max","dateSerializationFormat","firstDayOfWeek","groups","resources","dataSource","customizeDateNavigatorText","appointmentTemplate","dropDownAppointmentTemplate","appointmentCollectorTemplate","dataCellTemplate","timeCellTemplate","resourceCellTemplate","dateCellTemplate","startDayHour","endDayHour","editing","allowAdding","allowDeleting","allowDragging","allowResizing","allowUpdating","showAllDayPanel","showCurrentTimeIndicator","shadeUntilCurrentTime","indicatorUpdateInterval","indicatorTime","recurrenceEditMode","cellDuration","maxAppointmentsPerCell","selectedCellData","groupByDate","onAppointmentRendered","onAppointmentClick","onAppointmentDblClick","onAppointmentContextMenu","onCellClick","onCellContextMenu","onAppointmentAdding","onAppointmentAdded","onAppointmentUpdating","onAppointmentUpdated","onAppointmentDeleting","onAppointmentDeleted","onAppointmentFormOpening","appointmentTooltipTemplate","appointmentPopupTemplate","crossScrollingEnabled","useDropDownViewSwitcher","startDateExpr","endDateExpr","textExpr","descriptionExpr","allDayExpr","recurrenceRuleExpr","recurrenceExceptionExpr","remoteFiltering","timeZone","startDateTimeZoneExpr","endDateTimeZoneExpr","noDataText","format","adaptivityEnabled","allowMultipleCellSelection","_appointmentTooltipOffset","x","y","_appointmentTooltipButtonsPosition","_appointmentTooltipOpenButtonText","_dropDownButtonIcon","_appointmentCountPerCell","_collectorOffset","_appointmentOffset","_defaultOptionsRules","device","real","deviceType","isSimulator","options","focusStateEnabled","current","generic","isMaterial","data","index","element","text","split","forEach","span","addClass","append","_setDeprecatedOptions","_deprecatedOptions","onAppointmentFormCreated","since","alias","message","_postponeDataSourceLoading","promise","postponedOperations","add","_reloadDataSource","bind","_postponeResourceLoading","_this","whenLoaded","_loadResources","resolveCallbacks","done","resolve","_optionChanged","args","_this2","value","name","_updateOption","_dateOption","option","_workSpace","_header","_getViewStartByOptions","_appointments","_filterAppointmentsByDate","_initDataSource","_customizeStoreLoadOptions","_appointmentModel","setDataSource","_dataSource","_processCurrentView","_getCurrentViewOptions","repaint","getLayoutManager","initRenderingStrategy","_getAppointmentsRenderingStrategy","items","allowDrag","_allowDragging","allowResize","_allowResizing","itemTemplate","_getAppointmentTemplate","_refreshWorkSpace","_updateHeader","_resourcesManager","setResources","setDataAccessors","_combineDataAccessors","_actions","_createActionByOption","_getAppointmentRenderedAction","_readyToRenderAppointments","_getAppointmentsToRepaint","_dimensionChanged","_initEditing","_editing","_bringEditingModeToAppointments","hideAppointmentTooltip","_cleanPopup","_updateExpression","_initAppointmentTemplate","_toggleAdaptiveClass","viewCountConfig","_getViewCountConfig","intervalCount","_getCurrentViewOption","_currentView","optionName","optionValue","deserializeDate","_getSerializationFormat","isString","getDateSerializationFormat","editingConfig","allowDelete","_isAgenda","allowAllDayResize","_supportAllDayResizing","_allowAllDayResizing","_getCurrentViewType","_isAllDayExpanded","hasAllDayAppointments","_getTimezoneOffsetByOption","date","_calculateTimezoneByValue","timezone","result","dateUtc","UTC","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getTimezoneOffsetById","dateRange","getDateRange","filterByDate","loadResources","_loadedResources","_dataSourceLoadedCallback","load","hide","_fireContentReadyAction","fail","reject","isLoading","show","container","$element","position","of","filteredItems","getFilteredItems","_toggleSmallClass","_isVisible","_cleanAllowedPositions","appointments","_layoutManager","createAppointmentsMap","resizePopup","updatePopupFullScreenMode","_clean","width","get","getBoundingClientRect","toggleClass","_visibilityChanged","visible","_dataSourceOptions","paginate","_init","_initExpressions","startDate","endDate","startDateTimeZone","endDateTimeZone","allDay","description","recurrenceRule","recurrenceException","_proxiedCustomizeStoreLoadOptionsHandler","_customizeStoreLoadOptionsHandler","msie","touch","combinedDataAccessors","getAppointmentDurationInMinutes","_initActions","CompactAppointmentsHelper","_subscribes","_initTemplates","_defaultTemplates","appointmentTooltip","EmptyTemplate","dropDownAppointment","setDefaultTemplate","templateName","template","_this3","expr","_dataAccessors","createGetter","property","compileGetter","item","BindableTemplate","$container","model","getAppointmentsInstance","_renderAppointmentTemplate","resourcesDataAccessors","each","type","accessor","_renderContent","_renderContentImpl","_dataSourceChangedHandler","_workSpaceRecalculation","_filteredItems","fire","getRenderingStrategyInstance","calculateRows","length","cleanModelState","_renderView","fireWith","getRepaintedAppointments","fields","isDateField","field","getter","setter","compileSetter","dateGetter","dateSetter","that","apply","arguments","forceIsoDateParsing","object","serializeDate","call","exprObj","replace","isObject","_isReadOnly","prop","Object","prototype","hasOwnProperty","on","_dispose","_appointmentTooltip","dispose","hideAppointmentPopup","_cleanAsyncTemplatesTimer","off","storeLoadOptions","dxScheduler","getStartViewDate","getEndViewDate","excludeValidators","_renderFocusTarget","noop","_initMarkup","_renderHeader","_createComponent","_appointmentsConfig","MobileTooltipStrategy","DesktopTooltipStrategy","_getAppointmentTooltipOptions","_isLoaded","_initMarkupCore","_this4","createComponent","getScrollableContainer","getWorkSpaceScrollableContainer","getAppointmentTemplate","showAppointmentPopup","getTextAndFormatDate","currentData","checkAndDeleteAppointment","isAppointmentInAllDayPanel","getSingleAppointmentData","appointmentData","targetElement","$appointment","_getSingleAppointmentData","target","_checkRecurringAppointment","deleteAppointment","_getExtraAppointmentTooltipOptions","rtlEnabled","offset","itTakesAllDay","appointmentTakesAllDay","supportAllDayRow","_this5","hasWindow","_cleanWorkspace","_renderWorkSpace","fixedContainer","getFixedContainer","allDayContainer","getAllDayContainer","_waitAsyncTemplates","_isResourcesLoaded","_isDataSourceLoaded","isDefined","isLoaded","_render","$header","appendTo","_headerConfig","currentViewOptions","countConfig","tabIndex","observer","config","onItemRendered","onItemClick","onItemContextMenu","onContentReady","getCollectorOffset","needApplyCollectorOffset","_","view","isViewIsObject","viewName","viewType","$workSpace","_workSpaceConfig","initDragBehavior","getWorkArea","_recalculateWorkspace","_getHeaderDate","_getViewByName","viewCount","i","_this6","triggerResizeEvent","_refreshDateTimeIndication","_this7","accessKey","allDayExpanded","onSelectionChanged","hoursInterval","_getTemplate","_getTemplateByOption","_this8","detach","remove","getWorkSpaceScrollable","getScrollable","getWorkSpaceScrollableScrollTop","getGroupedScrollableScrollTop","getWorkSpaceScrollableScrollLeft","getScrollableScrollLeft","getWorkSpaceAllDayHeight","getAllDayHeight","getWorkSpaceAllDayOffset","getAllDayOffset","getWorkSpaceHeaderPanelHeight","getHeaderPanelHeight","getWorkSpaceDateTableOffset","getWorkSpaceLeftOffset","getWorkSpace","getAppointmentModel","getHeader","getMaxAppointmentsPerCell","_convertDatesByTimezoneBack","applyAppointmentTimezone","sourceAppointmentData","targetAppointmentData","processedStartDate","processedEndDate","targetAppointment","singleAppointment","exceptionDate","callback","isDeleted","isPopupEditing","dragEvent","_updatedRecAppointment","getRecurrenceRule","isValid","editMode","_singleAppointmentChangesHandler","cancel","_showRecurrenceChangeConfirm","moveAppointmentBack","processAppointmentDates","appointment","commonTimezoneOffset","isNaN","startDateClientTzOffset","getClientTimezoneOffset","endDateClientTzOffset","processedStartDateInUTC","getTime","processedEndDateInUTC","addAppointment","_makeDateAsRecurrenceException","updatedAppointment","_showAppointmentPopup","_editAppointmentData","_updateAppointment","_getStartDate","exceptionByDate","_getRecurrenceExceptionDate","exceptionStartDate","targetStartDate","appointmentStartDate","setHours","getHours","getMinutes","getSeconds","getMilliseconds","timezoneDiff","getTimezoneOffset","seriesText","occurrenceText","custom","messageHtml","showCloseButton","showTitle","buttons","onClick","_getUpdatedData","cellData","getTargetCellData","targetAllDay","targetEndDate","duration","keepOriginalHours","diff","updatedData","calculateEndDate","dateCopy","getTimezoneOffsetChangeInMs","setResourcesToItem","_getCoordinates","initialDates","dates","appointmentResources","currentCoords","getCoordinatesByDateInGroup","j","initialStartDate","_isAppointmentRecurrence","triggerResize","skipDateCalculation","resultAppointmentData","isAllDay","appointmentDuration","updatedStartDate","_needUpdateAppointmentData","apptDataCalculator","getAppointmentDataCalculator","isFunction","isAppointmentResized","coordinates","locate","getCellDataByCoordinates","hasClass","REDUCED_APPOINTMENT_CLASS","skipHoursProcessing","COMPACT_APPOINTMENT_CLASS","RECURRENCE_APPOINTMENT_CLASS","subscribe","subject","action","Array","slice","Error","getDataByDroppableCell","onUpdatePrevented","updatingOptions","newData","oldData","performFailAction","err","isDeferred","_processActionResult","canceled","_expandAllDayPanel","update","always","e","_executeActionWhenOperationIsCompleted","actionOptions","_this9","isPromise","fromPromise","state","isError","error","isVisible","visibleButtons","isProcessTimeZone","getAppointmentPopup","getPopup","getAppointmentDetailsForm","_appointmentForm","getUpdatedAppointment","getUpdatedAppointmentKeys","getResourceManager","getActions","skipNormalize","makeDate","_getEndDate","isSameDate","sameDate","_getRecurrenceException","exceptions","exceptionByStartDate","_convertRecurrenceException","join","exception","recurrenceEditorVisibilityChanged","find","dayHasAppointment","dayTimeStamp","startDateTimeStamp","endDateTimeStamp","inArray","setTargetedAppointmentResources","targetedAppointment","appointmentElement","appointmentIndex","resourcesSetter","getGroups","setResourceCallback","apptSettings","_positionMap","_getCellGroups","groupIndex","group","id","setting","left","top","createNewAppointment","currentAppointmentData","isEmptyObject","saveChanges","showAppointmentTooltip","showAppointmentTooltipCore","color","_tryGetAppointmentColor","isAlreadyShown","scrollToTime","hours","minutes","addingOptions","clientOffset","updateAppointment","deletingOptions","focus","getFirstDayOfWeek","firstDayOfWeekIndex","include","module","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _callbacks = require(\"../../core/utils/callbacks\");\r\nvar _callbacks2 = _interopRequireDefault(_callbacks);\r\nvar _translator = require(\"../../animation/translator\");\r\nvar _translator2 = _interopRequireDefault(_translator);\r\nvar _ui = require(\"../widget/ui.errors\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _window2 = _interopRequireDefault(_window);\r\nvar _dialog = require(\"../dialog\");\r\nvar _dialog2 = _interopRequireDefault(_dialog);\r\nvar _utils = require(\"./utils.recurrence\");\r\nvar _utils2 = _interopRequireDefault(_utils);\r\nvar _dom = require(\"../../core/utils/dom\");\r\nvar _dom2 = _interopRequireDefault(_dom);\r\nvar _date = require(\"../../core/utils/date\");\r\nvar _date2 = _interopRequireDefault(_date);\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _array = require(\"../../core/utils/array\");\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _type2 = _interopRequireDefault(_type);\r\nvar _devices = require(\"../../core/devices\");\r\nvar _devices2 = _interopRequireDefault(_devices);\r\nvar _config = require(\"../../core/config\");\r\nvar _config2 = _interopRequireDefault(_config);\r\nvar _data = require(\"../../core/utils/data\");\r\nvar _data2 = _interopRequireDefault(_data);\r\nvar _component_registrator = require(\"../../core/component_registrator\");\r\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _date_serialization = require(\"../../core/utils/date_serialization\");\r\nvar _date_serialization2 = _interopRequireDefault(_date_serialization);\r\nvar _date3 = require(\"../../localization/date\");\r\nvar _date4 = _interopRequireDefault(_date3);\r\nvar _ui3 = require(\"../widget/ui.widget\");\r\nvar _ui4 = _interopRequireDefault(_ui3);\r\nvar _uiScheduler = require(\"./ui.scheduler.subscribes\");\r\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\r\nvar _desktopTooltipStrategy = require(\"./tooltip_strategies/desktopTooltipStrategy\");\r\nvar _mobileTooltipStrategy = require(\"./tooltip_strategies/mobileTooltipStrategy\");\r\nvar _appointmentPopup = require(\"./appointmentPopup\");\r\nvar _appointmentPopup2 = _interopRequireDefault(_appointmentPopup);\r\nvar _uiScheduler3 = require(\"./ui.scheduler.header\");\r\nvar _uiScheduler4 = _interopRequireDefault(_uiScheduler3);\r\nvar _uiScheduler5 = require(\"./workspaces/ui.scheduler.work_space_day\");\r\nvar _uiScheduler6 = _interopRequireDefault(_uiScheduler5);\r\nvar _uiScheduler7 = require(\"./workspaces/ui.scheduler.work_space_week\");\r\nvar _uiScheduler8 = _interopRequireDefault(_uiScheduler7);\r\nvar _uiScheduler9 = require(\"./workspaces/ui.scheduler.work_space_work_week\");\r\nvar _uiScheduler10 = _interopRequireDefault(_uiScheduler9);\r\nvar _uiScheduler11 = require(\"./workspaces/ui.scheduler.work_space_month\");\r\nvar _uiScheduler12 = _interopRequireDefault(_uiScheduler11);\r\nvar _uiScheduler13 = require(\"./workspaces/ui.scheduler.timeline_day\");\r\nvar _uiScheduler14 = _interopRequireDefault(_uiScheduler13);\r\nvar _uiScheduler15 = require(\"./workspaces/ui.scheduler.timeline_week\");\r\nvar _uiScheduler16 = _interopRequireDefault(_uiScheduler15);\r\nvar _uiScheduler17 = require(\"./workspaces/ui.scheduler.timeline_work_week\");\r\nvar _uiScheduler18 = _interopRequireDefault(_uiScheduler17);\r\nvar _uiScheduler19 = require(\"./workspaces/ui.scheduler.timeline_month\");\r\nvar _uiScheduler20 = _interopRequireDefault(_uiScheduler19);\r\nvar _uiScheduler21 = require(\"./workspaces/ui.scheduler.agenda\");\r\nvar _uiScheduler22 = _interopRequireDefault(_uiScheduler21);\r\nvar _uiScheduler23 = require(\"./ui.scheduler.resource_manager\");\r\nvar _uiScheduler24 = _interopRequireDefault(_uiScheduler23);\r\nvar _uiScheduler25 = require(\"./ui.scheduler.appointment_model\");\r\nvar _uiScheduler26 = _interopRequireDefault(_uiScheduler25);\r\nvar _uiScheduler27 = require(\"./ui.scheduler.appointments\");\r\nvar _uiScheduler28 = _interopRequireDefault(_uiScheduler27);\r\nvar _uiSchedulerAppointments = require(\"./ui.scheduler.appointments.layout_manager\");\r\nvar _uiSchedulerAppointments2 = _interopRequireDefault(_uiSchedulerAppointments);\r\nvar _compactAppointmentsHelper = require(\"./compactAppointmentsHelper\");\r\nvar _uiScheduler29 = require(\"./timezones/ui.scheduler.timezones\");\r\nvar _uiScheduler30 = _interopRequireDefault(_uiScheduler29);\r\nvar _async_template_mixin = require(\"../shared/async_template_mixin\");\r\nvar _async_template_mixin2 = _interopRequireDefault(_async_template_mixin);\r\nvar _data_helper = require(\"../../data_helper\");\r\nvar _data_helper2 = _interopRequireDefault(_data_helper);\r\nvar _ui5 = require(\"./ui.loading\");\r\nvar _ui6 = _interopRequireDefault(_ui5);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _deferred2 = _interopRequireDefault(_deferred);\r\nvar _empty_template = require(\"../../core/templates/empty_template\");\r\nvar _bindable_template = require(\"../../core/templates/bindable_template\");\r\nvar _themes = require(\"../themes\");\r\nvar _themes2 = _interopRequireDefault(_themes);\r\nvar _browser = require(\"../../core/utils/browser\");\r\nvar _browser2 = _interopRequireDefault(_browser);\r\nvar _support = require(\"../../core/utils/support\");\r\nvar _utils3 = require(\"./utils\");\r\nvar _utils4 = _interopRequireDefault(_utils3);\r\nvar _constants = require(\"./constants\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar when = _deferred2.default.when;\r\nvar Deferred = _deferred2.default.Deferred;\r\nvar toMs = _date2.default.dateToMilliseconds;\r\nvar WIDGET_CLASS = \"dx-scheduler\";\r\nvar WIDGET_SMALL_CLASS = \"\".concat(WIDGET_CLASS, \"-small\");\r\nvar WIDGET_ADAPTIVE_CLASS = \"\".concat(WIDGET_CLASS, \"-adaptive\");\r\nvar WIDGET_WIN_NO_TOUCH_CLASS = \"\".concat(WIDGET_CLASS, \"-win-no-touch\");\r\nvar WIDGET_READONLY_CLASS = \"\".concat(WIDGET_CLASS, \"-readonly\");\r\nvar RECURRENCE_EDITOR_ITEM_CLASS = \"\".concat(WIDGET_CLASS, \"-recurrence-rule-item\");\r\nvar RECURRENCE_EDITOR_OPENED_ITEM_CLASS = \"\".concat(WIDGET_CLASS, \"-recurrence-rule-item-opened\");\r\nvar WIDGET_SMALL_WIDTH = 400;\r\nvar FULL_DATE_FORMAT = \"yyyyMMddTHHmmss\";\r\nvar UTC_FULL_DATE_FORMAT = FULL_DATE_FORMAT + \"Z\";\r\nvar VIEWS_CONFIG = {\r\n    day: {\r\n        workSpace: _uiScheduler6.default,\r\n        renderingStrategy: \"vertical\"\r\n    },\r\n    week: {\r\n        workSpace: _uiScheduler8.default,\r\n        renderingStrategy: \"vertical\"\r\n    },\r\n    workWeek: {\r\n        workSpace: _uiScheduler10.default,\r\n        renderingStrategy: \"vertical\"\r\n    },\r\n    month: {\r\n        workSpace: _uiScheduler12.default,\r\n        renderingStrategy: \"horizontalMonth\"\r\n    },\r\n    timelineDay: {\r\n        workSpace: _uiScheduler14.default,\r\n        renderingStrategy: \"horizontal\"\r\n    },\r\n    timelineWeek: {\r\n        workSpace: _uiScheduler16.default,\r\n        renderingStrategy: \"horizontal\"\r\n    },\r\n    timelineWorkWeek: {\r\n        workSpace: _uiScheduler18.default,\r\n        renderingStrategy: \"horizontal\"\r\n    },\r\n    timelineMonth: {\r\n        workSpace: _uiScheduler20.default,\r\n        renderingStrategy: \"horizontalMonthLine\"\r\n    },\r\n    agenda: {\r\n        workSpace: _uiScheduler22.default,\r\n        renderingStrategy: \"agenda\"\r\n    }\r\n};\r\nvar Scheduler = _ui4.default.inherit({\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            views: [\"day\", \"week\"],\r\n            currentView: \"day\",\r\n            currentDate: _date2.default.trimTime(new Date),\r\n            min: void 0,\r\n            max: void 0,\r\n            dateSerializationFormat: void 0,\r\n            firstDayOfWeek: void 0,\r\n            groups: [],\r\n            resources: [],\r\n            dataSource: null,\r\n            customizeDateNavigatorText: void 0,\r\n            appointmentTemplate: \"item\",\r\n            dropDownAppointmentTemplate: \"dropDownAppointment\",\r\n            appointmentCollectorTemplate: \"appointmentCollector\",\r\n            dataCellTemplate: null,\r\n            timeCellTemplate: null,\r\n            resourceCellTemplate: null,\r\n            dateCellTemplate: null,\r\n            startDayHour: 0,\r\n            endDayHour: 24,\r\n            editing: {\r\n                allowAdding: true,\r\n                allowDeleting: true,\r\n                allowDragging: true,\r\n                allowResizing: true,\r\n                allowUpdating: true\r\n            },\r\n            showAllDayPanel: true,\r\n            showCurrentTimeIndicator: true,\r\n            shadeUntilCurrentTime: false,\r\n            indicatorUpdateInterval: 3e5,\r\n            indicatorTime: void 0,\r\n            recurrenceEditMode: \"dialog\",\r\n            cellDuration: 30,\r\n            maxAppointmentsPerCell: \"auto\",\r\n            selectedCellData: [],\r\n            groupByDate: false,\r\n            onAppointmentRendered: null,\r\n            onAppointmentClick: null,\r\n            onAppointmentDblClick: null,\r\n            onAppointmentContextMenu: null,\r\n            onCellClick: null,\r\n            onCellContextMenu: null,\r\n            onAppointmentAdding: null,\r\n            onAppointmentAdded: null,\r\n            onAppointmentUpdating: null,\r\n            onAppointmentUpdated: null,\r\n            onAppointmentDeleting: null,\r\n            onAppointmentDeleted: null,\r\n            onAppointmentFormOpening: null,\r\n            appointmentTooltipTemplate: \"appointmentTooltip\",\r\n            appointmentPopupTemplate: \"appointmentPopup\",\r\n            crossScrollingEnabled: false,\r\n            useDropDownViewSwitcher: false,\r\n            startDateExpr: \"startDate\",\r\n            endDateExpr: \"endDate\",\r\n            textExpr: \"text\",\r\n            descriptionExpr: \"description\",\r\n            allDayExpr: \"allDay\",\r\n            recurrenceRuleExpr: \"recurrenceRule\",\r\n            recurrenceExceptionExpr: \"recurrenceException\",\r\n            remoteFiltering: false,\r\n            timeZone: \"\",\r\n            startDateTimeZoneExpr: \"startDateTimeZone\",\r\n            endDateTimeZoneExpr: \"endDateTimeZone\",\r\n            noDataText: _message2.default.format(\"dxCollectionWidget-noDataText\"),\r\n            adaptivityEnabled: false,\r\n            allowMultipleCellSelection: true,\r\n            _appointmentTooltipOffset: {\r\n                x: 0,\r\n                y: 0\r\n            },\r\n            _appointmentTooltipButtonsPosition: \"bottom\",\r\n            _appointmentTooltipOpenButtonText: _message2.default.format(\"dxScheduler-openAppointment\"),\r\n            _dropDownButtonIcon: \"overflow\",\r\n            _appointmentCountPerCell: 2,\r\n            _collectorOffset: 0,\r\n            _appointmentOffset: 26\r\n        })\r\n    },\r\n    _defaultOptionsRules: function() {\r\n        return this.callBase().concat([{\r\n            device: function() {\r\n                return \"desktop\" === _devices2.default.real().deviceType && !_devices2.default.isSimulator()\r\n            },\r\n            options: {\r\n                focusStateEnabled: true\r\n            }\r\n        }, {\r\n            device: function() {\r\n                return !_devices2.default.current().generic\r\n            },\r\n            options: {\r\n                useDropDownViewSwitcher: true,\r\n                editing: {\r\n                    allowDragging: false,\r\n                    allowResizing: false\r\n                }\r\n            }\r\n        }, {\r\n            device: function() {\r\n                return _themes2.default.isMaterial()\r\n            },\r\n            options: {\r\n                useDropDownViewSwitcher: true,\r\n                dateCellTemplate: function(data, index, element) {\r\n                    var text = data.text;\r\n                    text.split(\" \").forEach(function(text, index) {\r\n                        var span = (0, _renderer2.default)(\"<span>\").text(text).addClass(\"dx-scheduler-header-panel-cell-date\");\r\n                        (0, _renderer2.default)(element).append(span);\r\n                        if (!index) {\r\n                            (0, _renderer2.default)(element).append(\" \")\r\n                        }\r\n                    })\r\n                },\r\n                _appointmentTooltipOffset: {\r\n                    x: 0,\r\n                    y: 11\r\n                },\r\n                _appointmentTooltipButtonsPosition: \"top\",\r\n                _appointmentTooltipOpenButtonText: null,\r\n                _dropDownButtonIcon: \"chevrondown\",\r\n                _appointmentCountPerCell: 1,\r\n                _collectorOffset: 20,\r\n                _appointmentOffset: 30\r\n            }\r\n        }])\r\n    },\r\n    _setDeprecatedOptions: function() {\r\n        this.callBase();\r\n        (0, _extend.extend)(this._deprecatedOptions, {\r\n            onAppointmentFormCreated: {\r\n                since: \"18.2\",\r\n                alias: \"onAppointmentFormOpening\"\r\n            },\r\n            dropDownAppointmentTemplate: {\r\n                since: \"19.2\",\r\n                message: \"appointmentTooltipTemplate\"\r\n            }\r\n        })\r\n    },\r\n    _postponeDataSourceLoading: function(promise) {\r\n        this.postponedOperations.add(\"_reloadDataSource\", this._reloadDataSource.bind(this), promise)\r\n    },\r\n    _postponeResourceLoading: function() {\r\n        var _this = this;\r\n        var whenLoaded = this.postponedOperations.add(\"_loadResources\", function() {\r\n            return _this._loadResources()\r\n        });\r\n        var resolveCallbacks = new Deferred;\r\n        whenLoaded.done(function(resources) {\r\n            resolveCallbacks.resolve(resources)\r\n        });\r\n        this._postponeDataSourceLoading(whenLoaded);\r\n        return resolveCallbacks.promise()\r\n    },\r\n    _optionChanged: function(args) {\r\n        var _this2 = this;\r\n        var value = args.value;\r\n        var name = args.name;\r\n        switch (args.name) {\r\n            case \"customizeDateNavigatorText\":\r\n                this._updateOption(\"header\", name, value);\r\n                break;\r\n            case \"firstDayOfWeek\":\r\n                this._updateOption(\"workSpace\", name, value);\r\n                this._updateOption(\"header\", name, value);\r\n                break;\r\n            case \"currentDate\":\r\n                value = this._dateOption(name);\r\n                value = _date2.default.trimTime(new Date(value));\r\n                this.option(\"selectedCellData\", []);\r\n                this._workSpace.option(name, new Date(value));\r\n                this._header.option(name, new Date(value));\r\n                this._header.option(\"displayedDate\", this._workSpace._getViewStartByOptions());\r\n                this._appointments.option(\"items\", []);\r\n                this._filterAppointmentsByDate();\r\n                this._postponeDataSourceLoading();\r\n                break;\r\n            case \"dataSource\":\r\n                this._initDataSource();\r\n                this._customizeStoreLoadOptions();\r\n                this._appointmentModel.setDataSource(this._dataSource);\r\n                this._postponeResourceLoading().done(function(resources) {\r\n                    _this2._filterAppointmentsByDate();\r\n                    _this2._updateOption(\"workSpace\", \"showAllDayPanel\", _this2.option(\"showAllDayPanel\"))\r\n                });\r\n                break;\r\n            case \"min\":\r\n            case \"max\":\r\n                value = this._dateOption(name);\r\n                this._updateOption(\"header\", name, new Date(value));\r\n                this._updateOption(\"workSpace\", name, new Date(value));\r\n                break;\r\n            case \"views\":\r\n                this._processCurrentView();\r\n                if (this._getCurrentViewOptions()) {\r\n                    this.repaint()\r\n                } else {\r\n                    this._header.option(name, value)\r\n                }\r\n                break;\r\n            case \"useDropDownViewSwitcher\":\r\n                this._header.option(name, value);\r\n                break;\r\n            case \"currentView\":\r\n                this._processCurrentView();\r\n                this.getLayoutManager().initRenderingStrategy(this._getAppointmentsRenderingStrategy());\r\n                this._appointments.option({\r\n                    items: [],\r\n                    allowDrag: this._allowDragging(),\r\n                    allowResize: this._allowResizing(),\r\n                    itemTemplate: this._getAppointmentTemplate(\"appointmentTemplate\")\r\n                });\r\n                this._postponeResourceLoading().done(function(resources) {\r\n                    _this2._refreshWorkSpace(resources);\r\n                    _this2._updateHeader();\r\n                    _this2._filterAppointmentsByDate();\r\n                    _this2._appointments.option(\"allowAllDayResize\", \"day\" !== value)\r\n                });\r\n                break;\r\n            case \"appointmentTemplate\":\r\n                this._appointments.option(\"itemTemplate\", value);\r\n                break;\r\n            case \"dateCellTemplate\":\r\n            case \"resourceCellTemplate\":\r\n            case \"dataCellTemplate\":\r\n            case \"timeCellTemplate\":\r\n                this._updateOption(\"workSpace\", name, value);\r\n                this.repaint();\r\n                break;\r\n            case \"groups\":\r\n                this._postponeResourceLoading().done(function(resources) {\r\n                    _this2._refreshWorkSpace(resources);\r\n                    _this2._filterAppointmentsByDate()\r\n                });\r\n                break;\r\n            case \"resources\":\r\n                this._resourcesManager.setResources(this.option(\"resources\"));\r\n                this._appointmentModel.setDataAccessors(this._combineDataAccessors());\r\n                this._postponeResourceLoading().done(function(resources) {\r\n                    _this2._appointments.option(\"items\", []);\r\n                    _this2._refreshWorkSpace(resources);\r\n                    _this2._filterAppointmentsByDate()\r\n                });\r\n                break;\r\n            case \"startDayHour\":\r\n            case \"endDayHour\":\r\n                this._appointments.option(\"items\", []);\r\n                this._updateOption(\"workSpace\", name, value);\r\n                this._appointments.repaint();\r\n                this._filterAppointmentsByDate();\r\n                this._postponeDataSourceLoading();\r\n                break;\r\n            case \"onAppointmentAdding\":\r\n            case \"onAppointmentAdded\":\r\n            case \"onAppointmentUpdating\":\r\n            case \"onAppointmentUpdated\":\r\n            case \"onAppointmentDeleting\":\r\n            case \"onAppointmentDeleted\":\r\n            case \"onAppointmentFormOpening\":\r\n                this._actions[name] = this._createActionByOption(name);\r\n                break;\r\n            case \"onAppointmentRendered\":\r\n                this._appointments.option(\"onItemRendered\", this._getAppointmentRenderedAction());\r\n                break;\r\n            case \"onAppointmentClick\":\r\n                this._appointments.option(\"onItemClick\", this._createActionByOption(name));\r\n                break;\r\n            case \"onAppointmentDblClick\":\r\n                this._appointments.option(name, this._createActionByOption(name));\r\n                break;\r\n            case \"onAppointmentContextMenu\":\r\n                this._appointments.option(\"onItemContextMenu\", this._createActionByOption(name));\r\n                break;\r\n            case \"noDataText\":\r\n            case \"allowMultipleCellSelection\":\r\n            case \"selectedCellData\":\r\n            case \"accessKey\":\r\n            case \"onCellClick\":\r\n                this._workSpace.option(name, value);\r\n                break;\r\n            case \"onCellContextMenu\":\r\n                this._workSpace.option(name, value);\r\n                break;\r\n            case \"crossScrollingEnabled\":\r\n                this._postponeResourceLoading().done(function(resources) {\r\n                    _this2._appointments.option(\"items\", []);\r\n                    _this2._refreshWorkSpace(resources);\r\n                    if (_this2._readyToRenderAppointments) {\r\n                        _this2._appointments.option(\"items\", _this2._getAppointmentsToRepaint())\r\n                    }\r\n                });\r\n                break;\r\n            case \"cellDuration\":\r\n                this._appointments.option(\"items\", []);\r\n                if (this._readyToRenderAppointments) {\r\n                    this._updateOption(\"workSpace\", \"hoursInterval\", value / 60);\r\n                    this._appointments.option(\"items\", this._getAppointmentsToRepaint())\r\n                }\r\n                break;\r\n            case \"tabIndex\":\r\n            case \"focusStateEnabled\":\r\n                this._updateOption(\"header\", name, value);\r\n                this._updateOption(\"workSpace\", name, value);\r\n                this._appointments.option(name, value);\r\n                this.callBase(args);\r\n                break;\r\n            case \"width\":\r\n                this._updateOption(\"header\", name, value);\r\n                if (this.option(\"crossScrollingEnabled\")) {\r\n                    this._updateOption(\"workSpace\", \"width\", value)\r\n                }\r\n                this.callBase(args);\r\n                this._dimensionChanged();\r\n                break;\r\n            case \"height\":\r\n                this.callBase(args);\r\n                this._dimensionChanged();\r\n                break;\r\n            case \"editing\":\r\n                this._initEditing();\r\n                var editing = this._editing;\r\n                this._bringEditingModeToAppointments(editing);\r\n                this.hideAppointmentTooltip();\r\n                this._cleanPopup();\r\n                break;\r\n            case \"showAllDayPanel\":\r\n                this._postponeResourceLoading().done(function(resources) {\r\n                    _this2._filterAppointmentsByDate();\r\n                    _this2._updateOption(\"workSpace\", \"allDayExpanded\", value);\r\n                    _this2._updateOption(\"workSpace\", name, value)\r\n                });\r\n                break;\r\n            case \"showCurrentTimeIndicator\":\r\n            case \"indicatorTime\":\r\n            case \"indicatorUpdateInterval\":\r\n            case \"shadeUntilCurrentTime\":\r\n            case \"groupByDate\":\r\n                this._updateOption(\"workSpace\", name, value);\r\n                this.repaint();\r\n                break;\r\n            case \"appointmentDragging\":\r\n            case \"appointmentTooltipTemplate\":\r\n            case \"appointmentPopupTemplate\":\r\n            case \"recurrenceEditMode\":\r\n            case \"remoteFiltering\":\r\n            case \"timeZone\":\r\n            case \"dropDownAppointmentTemplate\":\r\n            case \"appointmentCollectorTemplate\":\r\n            case \"_appointmentTooltipOffset\":\r\n            case \"_appointmentTooltipButtonsPosition\":\r\n            case \"_appointmentTooltipOpenButtonText\":\r\n            case \"_dropDownButtonIcon\":\r\n            case \"_appointmentCountPerCell\":\r\n            case \"_collectorOffset\":\r\n            case \"_appointmentOffset\":\r\n                this.repaint();\r\n                break;\r\n            case \"dateSerializationFormat\":\r\n                break;\r\n            case \"maxAppointmentsPerCell\":\r\n                break;\r\n            case \"startDateExpr\":\r\n            case \"endDateExpr\":\r\n            case \"startDateTimeZoneExpr\":\r\n            case \"endDateTimeZoneExpr\":\r\n            case \"textExpr\":\r\n            case \"descriptionExpr\":\r\n            case \"allDayExpr\":\r\n            case \"recurrenceRuleExpr\":\r\n            case \"recurrenceExceptionExpr\":\r\n                this._updateExpression(name, value);\r\n                this._appointmentModel.setDataAccessors(this._combineDataAccessors());\r\n                this._initAppointmentTemplate();\r\n                this.repaint();\r\n                break;\r\n            case \"adaptivityEnabled\":\r\n                this._toggleAdaptiveClass();\r\n                this.repaint();\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _updateHeader: function() {\r\n        var viewCountConfig = this._getViewCountConfig();\r\n        this._header.option(\"intervalCount\", viewCountConfig.intervalCount);\r\n        this._header.option(\"displayedDate\", this._workSpace._getViewStartByOptions());\r\n        this._header.option(\"min\", this._dateOption(\"min\"));\r\n        this._header.option(\"max\", this._dateOption(\"max\"));\r\n        this._header.option(\"currentDate\", this._dateOption(\"currentDate\"));\r\n        this._header.option(\"firstDayOfWeek\", this._getCurrentViewOption(\"firstDayOfWeek\"));\r\n        this._header.option(\"currentView\", this._currentView)\r\n    },\r\n    _dateOption: function(optionName) {\r\n        var optionValue = this._getCurrentViewOption(optionName);\r\n        return _date_serialization2.default.deserializeDate(optionValue)\r\n    },\r\n    _getSerializationFormat: function(optionName) {\r\n        var value = this._getCurrentViewOption(optionName);\r\n        if (\"number\" === typeof value) {\r\n            return \"number\"\r\n        }\r\n        if (!_type2.default.isString(value)) {\r\n            return\r\n        }\r\n        return _date_serialization2.default.getDateSerializationFormat(value)\r\n    },\r\n    _bringEditingModeToAppointments: function(editing) {\r\n        var editingConfig = {\r\n            allowDelete: editing.allowUpdating && editing.allowDeleting\r\n        };\r\n        if (!this._isAgenda()) {\r\n            editingConfig.allowDrag = editing.allowDragging;\r\n            editingConfig.allowResize = editing.allowResizing;\r\n            editingConfig.allowAllDayResize = editing.allowResizing && this._supportAllDayResizing()\r\n        }\r\n        this._appointments.option(editingConfig);\r\n        this.repaint()\r\n    },\r\n    _isAgenda: function() {\r\n        return \"agenda\" === this._getAppointmentsRenderingStrategy()\r\n    },\r\n    _allowDragging: function() {\r\n        return this._editing.allowDragging && !this._isAgenda()\r\n    },\r\n    _allowResizing: function() {\r\n        return this._editing.allowResizing && !this._isAgenda()\r\n    },\r\n    _allowAllDayResizing: function() {\r\n        return this._editing.allowResizing && this._supportAllDayResizing()\r\n    },\r\n    _supportAllDayResizing: function() {\r\n        return \"day\" !== this._getCurrentViewType() || this._currentView.intervalCount > 1\r\n    },\r\n    _isAllDayExpanded: function(items) {\r\n        return this.option(\"showAllDayPanel\") && this._appointmentModel.hasAllDayAppointments(items, this._getCurrentViewOption(\"startDayHour\"), this._getCurrentViewOption(\"endDayHour\"))\r\n    },\r\n    _getTimezoneOffsetByOption: function(date) {\r\n        return this._calculateTimezoneByValue(this.option(\"timeZone\"), date)\r\n    },\r\n    _calculateTimezoneByValue: function(timezone, date) {\r\n        var result = timezone;\r\n        if (\"string\" === typeof timezone) {\r\n            date = date || new Date;\r\n            var dateUtc = Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes());\r\n            result = _uiScheduler30.default.getTimezoneOffsetById(timezone, dateUtc)\r\n        }\r\n        return result\r\n    },\r\n    _filterAppointmentsByDate: function() {\r\n        var dateRange = this._workSpace.getDateRange();\r\n        this._appointmentModel.filterByDate(dateRange[0], dateRange[1], this.option(\"remoteFiltering\"), this.option(\"dateSerializationFormat\"))\r\n    },\r\n    _loadResources: function() {\r\n        var groups = this._getCurrentViewOption(\"groups\");\r\n        var result = new Deferred;\r\n        this._resourcesManager.loadResources(groups).done(function(resources) {\r\n            this._loadedResources = resources;\r\n            result.resolve(resources)\r\n        }.bind(this));\r\n        return result.promise()\r\n    },\r\n    _dataSourceLoadedCallback: (0, _callbacks2.default)(),\r\n    _reloadDataSource: function() {\r\n        var result = new Deferred;\r\n        if (this._dataSource) {\r\n            this._dataSource.load().done(function() {\r\n                _ui6.default.hide();\r\n                this._fireContentReadyAction(result)\r\n            }.bind(this)).fail(function() {\r\n                _ui6.default.hide();\r\n                result.reject()\r\n            });\r\n            this._dataSource.isLoading() && _ui6.default.show({\r\n                container: this.$element(),\r\n                position: {\r\n                    of: this.$element()\r\n                }\r\n            })\r\n        } else {\r\n            this._fireContentReadyAction(result)\r\n        }\r\n        return result.promise()\r\n    },\r\n    _fireContentReadyAction: function(result) {\r\n        this.callBase();\r\n        result && result.resolve()\r\n    },\r\n    _dimensionChanged: function() {\r\n        var filteredItems = this.getFilteredItems();\r\n        this._toggleSmallClass();\r\n        if (!this._isAgenda() && filteredItems && this._isVisible()) {\r\n            this._workSpace._cleanAllowedPositions();\r\n            this._workSpace.option(\"allDayExpanded\", this._isAllDayExpanded(filteredItems));\r\n            this._workSpace._dimensionChanged();\r\n            var appointments = this._layoutManager.createAppointmentsMap(filteredItems);\r\n            this._appointments.option(\"items\", appointments)\r\n        }\r\n        this.hideAppointmentTooltip();\r\n        this.resizePopup();\r\n        this._appointmentPopup.updatePopupFullScreenMode()\r\n    },\r\n    _clean: function() {\r\n        this._cleanPopup();\r\n        this.callBase()\r\n    },\r\n    _toggleSmallClass: function() {\r\n        var width = this.$element().get(0).getBoundingClientRect().width;\r\n        this.$element().toggleClass(WIDGET_SMALL_CLASS, width < WIDGET_SMALL_WIDTH)\r\n    },\r\n    _toggleAdaptiveClass: function() {\r\n        this.$element().toggleClass(WIDGET_ADAPTIVE_CLASS, this.option(\"adaptivityEnabled\"))\r\n    },\r\n    _visibilityChanged: function(visible) {\r\n        visible && this._dimensionChanged()\r\n    },\r\n    _dataSourceOptions: function() {\r\n        return {\r\n            paginate: false\r\n        }\r\n    },\r\n    _init: function() {\r\n        this._initExpressions({\r\n            startDate: this.option(\"startDateExpr\"),\r\n            endDate: this.option(\"endDateExpr\"),\r\n            startDateTimeZone: this.option(\"startDateTimeZoneExpr\"),\r\n            endDateTimeZone: this.option(\"endDateTimeZoneExpr\"),\r\n            allDay: this.option(\"allDayExpr\"),\r\n            text: this.option(\"textExpr\"),\r\n            description: this.option(\"descriptionExpr\"),\r\n            recurrenceRule: this.option(\"recurrenceRuleExpr\"),\r\n            recurrenceException: this.option(\"recurrenceExceptionExpr\")\r\n        });\r\n        this.callBase();\r\n        this._initDataSource();\r\n        this._loadedResources = [];\r\n        this._proxiedCustomizeStoreLoadOptionsHandler = this._customizeStoreLoadOptionsHandler.bind(this);\r\n        this._customizeStoreLoadOptions();\r\n        this.$element().addClass(WIDGET_CLASS).toggleClass(WIDGET_WIN_NO_TOUCH_CLASS, !!(_browser2.default.msie && _support.touch));\r\n        this._initEditing();\r\n        this._resourcesManager = new _uiScheduler24.default(this.option(\"resources\"));\r\n        var combinedDataAccessors = this._combineDataAccessors();\r\n        this._appointmentModel = new _uiScheduler26.default(this._dataSource, combinedDataAccessors, this.getAppointmentDurationInMinutes());\r\n        this._initActions();\r\n        this._compactAppointmentsHelper = new _compactAppointmentsHelper.CompactAppointmentsHelper(this);\r\n        this._subscribes = _uiScheduler2.default\r\n    },\r\n    _initTemplates: function() {\r\n        this.callBase();\r\n        this._initAppointmentTemplate();\r\n        this._defaultTemplates.appointmentTooltip = new _empty_template.EmptyTemplate;\r\n        this._defaultTemplates.dropDownAppointment = new _empty_template.EmptyTemplate\r\n    },\r\n    setDefaultTemplate: function(templateName, template) {\r\n        this._defaultTemplates[templateName] = template\r\n    },\r\n    _initAppointmentTemplate: function() {\r\n        var _this3 = this;\r\n        var expr = this._dataAccessors.expr;\r\n        var createGetter = function(property) {\r\n            return _data2.default.compileGetter(\"appointmentData.\".concat(property))\r\n        };\r\n        this._defaultTemplates.item = new _bindable_template.BindableTemplate(function($container, data, model) {\r\n            _this3.getAppointmentsInstance()._renderAppointmentTemplate($container, data, model)\r\n        }, [\"html\", \"text\", \"startDate\", \"endDate\", \"allDay\", \"description\", \"recurrenceRule\", \"recurrenceException\", \"startDateTimeZone\", \"endDateTimeZone\"], this.option(\"integrationOptions.watchMethod\"), {\r\n            text: createGetter(expr.textExpr),\r\n            startDate: createGetter(expr.startDateExpr),\r\n            endDate: createGetter(expr.endDateExpr),\r\n            startDateTimeZone: createGetter(expr.startDateTimeZoneExpr),\r\n            endDateTimeZone: createGetter(expr.endDateTimeZoneExpr),\r\n            allDay: createGetter(expr.allDayExpr),\r\n            recurrenceRule: createGetter(expr.recurrenceRuleExpr)\r\n        })\r\n    },\r\n    _combineDataAccessors: function() {\r\n        var resourcesDataAccessors = this._resourcesManager._dataAccessors;\r\n        var result = (0, _extend.extend)(true, {}, this._dataAccessors);\r\n        (0, _iterator.each)(resourcesDataAccessors, function(type, accessor) {\r\n            result[type].resources = accessor\r\n        }.bind(this));\r\n        return result\r\n    },\r\n    _renderContent: function() {\r\n        this._renderContentImpl()\r\n    },\r\n    _dataSourceChangedHandler: function(result) {\r\n        if (this._readyToRenderAppointments) {\r\n            this._workSpaceRecalculation.done(function() {\r\n                this._filteredItems = this.fire(\"prerenderFilter\");\r\n                this._workSpace.option(\"allDayExpanded\", this._isAllDayExpanded(this._filteredItems));\r\n                if (this._isAgenda()) {\r\n                    this.getRenderingStrategyInstance().calculateRows(this._filteredItems, 7, this.option(\"currentDate\"), true)\r\n                }\r\n                if (this._filteredItems.length && this._isVisible()) {\r\n                    this._appointments.option(\"items\", this._getAppointmentsToRepaint());\r\n                    this._appointmentModel.cleanModelState()\r\n                } else {\r\n                    this._appointments.option(\"items\", [])\r\n                }\r\n                if (this._isAgenda()) {\r\n                    this._workSpace._renderView();\r\n                    this._dataSourceLoadedCallback.fireWith(this, [result])\r\n                }\r\n            }.bind(this))\r\n        }\r\n    },\r\n    _getAppointmentsToRepaint: function() {\r\n        var appointments = this._layoutManager.createAppointmentsMap(this._filteredItems);\r\n        return this._layoutManager.getRepaintedAppointments(appointments, this.getAppointmentsInstance().option(\"items\"))\r\n    },\r\n    _initExpressions: function(fields) {\r\n        var isDateField = function(field) {\r\n            return \"startDate\" === field || \"endDate\" === field\r\n        };\r\n        if (!this._dataAccessors) {\r\n            this._dataAccessors = {\r\n                getter: {},\r\n                setter: {},\r\n                expr: {}\r\n            }\r\n        }(0, _iterator.each)(fields, function(name, expr) {\r\n            if (expr) {\r\n                var getter = _data2.default.compileGetter(expr);\r\n                var setter = _data2.default.compileSetter(expr);\r\n                var dateGetter;\r\n                var dateSetter;\r\n                if (isDateField(name)) {\r\n                    var that = this;\r\n                    dateGetter = function() {\r\n                        var value = getter.apply(this, arguments);\r\n                        if ((0, _config2.default)().forceIsoDateParsing) {\r\n                            if (!that.option(\"dateSerializationFormat\")) {\r\n                                var format = _date_serialization2.default.getDateSerializationFormat(value);\r\n                                if (format) {\r\n                                    that.option(\"dateSerializationFormat\", format)\r\n                                }\r\n                            }\r\n                            value = _date_serialization2.default.deserializeDate(value)\r\n                        }\r\n                        return value\r\n                    };\r\n                    dateSetter = function(object, value) {\r\n                        if ((0, _config2.default)().forceIsoDateParsing || that.option(\"dateSerializationFormat\")) {\r\n                            value = _date_serialization2.default.serializeDate(value, that.option(\"dateSerializationFormat\"))\r\n                        }\r\n                        setter.call(this, object, value)\r\n                    }\r\n                }\r\n                this._dataAccessors.getter[name] = dateGetter || getter;\r\n                this._dataAccessors.setter[name] = dateSetter || setter;\r\n                this._dataAccessors.expr[name + \"Expr\"] = expr\r\n            } else {\r\n                delete this._dataAccessors.getter[name];\r\n                delete this._dataAccessors.setter[name];\r\n                delete this._dataAccessors.expr[name + \"Expr\"]\r\n            }\r\n        }.bind(this))\r\n    },\r\n    _updateExpression: function(name, value) {\r\n        var exprObj = {};\r\n        exprObj[name.replace(\"Expr\", \"\")] = value;\r\n        this._initExpressions(exprObj)\r\n    },\r\n    _initEditing: function() {\r\n        var editing = this.option(\"editing\");\r\n        this._editing = {\r\n            allowAdding: !!editing,\r\n            allowUpdating: !!editing,\r\n            allowDeleting: !!editing,\r\n            allowResizing: !!editing,\r\n            allowDragging: !!editing\r\n        };\r\n        if (_type2.default.isObject(editing)) {\r\n            this._editing = (0, _extend.extend)(this._editing, editing)\r\n        }\r\n        this._editing.allowDragging = this._editing.allowDragging && this._editing.allowUpdating;\r\n        this._editing.allowResizing = this._editing.allowResizing && this._editing.allowUpdating;\r\n        this.$element().toggleClass(WIDGET_READONLY_CLASS, this._isReadOnly())\r\n    },\r\n    _isReadOnly: function() {\r\n        var result = true;\r\n        var editing = this._editing;\r\n        for (var prop in editing) {\r\n            if (Object.prototype.hasOwnProperty.call(editing, prop)) {\r\n                result = result && !editing[prop]\r\n            }\r\n        }\r\n        return result\r\n    },\r\n    _customizeStoreLoadOptions: function() {\r\n        this._dataSource && this._dataSource.on(\"customizeStoreLoadOptions\", this._proxiedCustomizeStoreLoadOptionsHandler)\r\n    },\r\n    _dispose: function() {\r\n        this._appointmentTooltip && this._appointmentTooltip.dispose();\r\n        this.hideAppointmentPopup();\r\n        this.hideAppointmentTooltip();\r\n        this._cleanAsyncTemplatesTimer();\r\n        this._dataSource && this._dataSource.off(\"customizeStoreLoadOptions\", this._proxiedCustomizeStoreLoadOptionsHandler);\r\n        this.callBase()\r\n    },\r\n    _customizeStoreLoadOptionsHandler: function(options) {\r\n        options.storeLoadOptions.dxScheduler = {\r\n            startDate: this.getStartViewDate(),\r\n            endDate: this.getEndViewDate(),\r\n            resources: this.option(\"resources\")\r\n        }\r\n    },\r\n    _initActions: function() {\r\n        this._actions = {\r\n            onAppointmentAdding: this._createActionByOption(\"onAppointmentAdding\"),\r\n            onAppointmentAdded: this._createActionByOption(\"onAppointmentAdded\"),\r\n            onAppointmentUpdating: this._createActionByOption(\"onAppointmentUpdating\"),\r\n            onAppointmentUpdated: this._createActionByOption(\"onAppointmentUpdated\"),\r\n            onAppointmentDeleting: this._createActionByOption(\"onAppointmentDeleting\"),\r\n            onAppointmentDeleted: this._createActionByOption(\"onAppointmentDeleted\"),\r\n            onAppointmentFormOpening: this._createActionByOption(\"onAppointmentFormOpening\")\r\n        }\r\n    },\r\n    _getAppointmentRenderedAction: function() {\r\n        return this._createActionByOption(\"onAppointmentRendered\", {\r\n            excludeValidators: [\"disabled\", \"readOnly\"]\r\n        })\r\n    },\r\n    _renderFocusTarget: _common.noop,\r\n    _initMarkup: function() {\r\n        this.callBase();\r\n        this._processCurrentView();\r\n        this._renderHeader();\r\n        this._layoutManager = new _uiSchedulerAppointments2.default(this, this._getAppointmentsRenderingStrategy());\r\n        this._appointments = this._createComponent(\"<div>\", _uiScheduler28.default, this._appointmentsConfig());\r\n        this._appointments.option(\"itemTemplate\", this._getAppointmentTemplate(\"appointmentTemplate\"));\r\n        this._appointmentTooltip = new(this.option(\"adaptivityEnabled\") ? _mobileTooltipStrategy.MobileTooltipStrategy : _desktopTooltipStrategy.DesktopTooltipStrategy)(this._getAppointmentTooltipOptions());\r\n        this._appointmentPopup = new _appointmentPopup2.default(this);\r\n        if (this._isLoaded()) {\r\n            this._initMarkupCore(this._loadedResources);\r\n            this._dataSourceChangedHandler(this._dataSource.items());\r\n            this._fireContentReadyAction()\r\n        } else {\r\n            this._loadResources().done(function(resources) {\r\n                this._initMarkupCore(resources);\r\n                this._reloadDataSource()\r\n            }.bind(this))\r\n        }\r\n    },\r\n    _getAppointmentTooltipOptions: function() {\r\n        var _this4 = this;\r\n        var that = this;\r\n        return {\r\n            createComponent: that._createComponent.bind(that),\r\n            container: that.$element(),\r\n            getScrollableContainer: that.getWorkSpaceScrollableContainer.bind(that),\r\n            setDefaultTemplate: that.setDefaultTemplate.bind(that),\r\n            getAppointmentTemplate: that._getAppointmentTemplate.bind(that),\r\n            showAppointmentPopup: that.showAppointmentPopup.bind(that),\r\n            getTextAndFormatDate: function(data, currentData, format) {\r\n                return that.fire(\"getTextAndFormatDate\", data, currentData, format)\r\n            },\r\n            checkAndDeleteAppointment: that.checkAndDeleteAppointment.bind(that),\r\n            isAppointmentInAllDayPanel: that.isAppointmentInAllDayPanel.bind(that),\r\n            getSingleAppointmentData: function(appointmentData, targetElement) {\r\n                var $appointment = (0, _renderer2.default)(targetElement);\r\n                return _this4._getSingleAppointmentData(appointmentData, {\r\n                    data: appointmentData,\r\n                    target: $appointment.get(0),\r\n                    $appointment: $appointment\r\n                })\r\n            }\r\n        }\r\n    },\r\n    checkAndDeleteAppointment: function(data, appointmentData) {\r\n        var that = this;\r\n        var startDate = that.fire(\"getField\", \"startDate\", appointmentData);\r\n        that._checkRecurringAppointment(data, appointmentData, startDate, function() {\r\n            that.deleteAppointment(data)\r\n        }, true)\r\n    },\r\n    _getExtraAppointmentTooltipOptions: function() {\r\n        return {\r\n            rtlEnabled: this.option(\"rtlEnabled\"),\r\n            focusStateEnabled: this.option(\"focusStateEnabled\"),\r\n            editing: this.option(\"editing\"),\r\n            offset: this.option(\"_appointmentTooltipOffset\")\r\n        }\r\n    },\r\n    isAppointmentInAllDayPanel: function(appointmentData) {\r\n        var workSpace = this._workSpace;\r\n        var itTakesAllDay = this.appointmentTakesAllDay(appointmentData);\r\n        return itTakesAllDay && workSpace.supportAllDayRow() && workSpace.option(\"showAllDayPanel\")\r\n    },\r\n    _initMarkupCore: function(resources) {\r\n        var _this5 = this;\r\n        this._readyToRenderAppointments = _window2.default.hasWindow();\r\n        this._workSpace && this._cleanWorkspace();\r\n        this._renderWorkSpace(resources);\r\n        this._appointments.option({\r\n            fixedContainer: this._workSpace.getFixedContainer(),\r\n            allDayContainer: this._workSpace.getAllDayContainer()\r\n        });\r\n        this._waitAsyncTemplates(function() {\r\n            _this5._workSpaceRecalculation && _this5._workSpaceRecalculation.resolve()\r\n        });\r\n        this._filterAppointmentsByDate()\r\n    },\r\n    _isLoaded: function() {\r\n        return this._isResourcesLoaded() && this._isDataSourceLoaded()\r\n    },\r\n    _isResourcesLoaded: function() {\r\n        return _type2.default.isDefined(this._loadedResources)\r\n    },\r\n    _isDataSourceLoaded: function() {\r\n        return this._dataSource && this._dataSource.isLoaded()\r\n    },\r\n    _render: function() {\r\n        this._toggleSmallClass();\r\n        this._toggleAdaptiveClass();\r\n        this.callBase()\r\n    },\r\n    _renderHeader: function() {\r\n        var $header = (0, _renderer2.default)(\"<div>\").appendTo(this.$element());\r\n        this._header = this._createComponent($header, _uiScheduler4.default, this._headerConfig())\r\n    },\r\n    _headerConfig: function() {\r\n        var result;\r\n        var currentViewOptions = this._getCurrentViewOptions();\r\n        var countConfig = this._getViewCountConfig();\r\n        result = (0, _extend.extend)({\r\n            firstDayOfWeek: this.option(\"firstDayOfWeek\"),\r\n            currentView: this._currentView,\r\n            tabIndex: this.option(\"tabIndex\"),\r\n            focusStateEnabled: this.option(\"focusStateEnabled\"),\r\n            width: this.option(\"width\"),\r\n            rtlEnabled: this.option(\"rtlEnabled\"),\r\n            useDropDownViewSwitcher: this.option(\"useDropDownViewSwitcher\"),\r\n            _dropDownButtonIcon: this.option(\"_dropDownButtonIcon\"),\r\n            customizeDateNavigatorText: this.option(\"customizeDateNavigatorText\")\r\n        }, currentViewOptions);\r\n        result.observer = this;\r\n        result.intervalCount = countConfig.intervalCount;\r\n        result.views = this.option(\"views\");\r\n        result.min = new Date(this._dateOption(\"min\"));\r\n        result.max = new Date(this._dateOption(\"max\"));\r\n        result.currentDate = _date2.default.trimTime(new Date(this._dateOption(\"currentDate\")));\r\n        return result\r\n    },\r\n    _appointmentsConfig: function() {\r\n        var that = this;\r\n        var config = {\r\n            observer: this,\r\n            onItemRendered: this._getAppointmentRenderedAction(),\r\n            onItemClick: this._createActionByOption(\"onAppointmentClick\"),\r\n            onItemContextMenu: this._createActionByOption(\"onAppointmentContextMenu\"),\r\n            onAppointmentDblClick: this._createActionByOption(\"onAppointmentDblClick\"),\r\n            tabIndex: this.option(\"tabIndex\"),\r\n            focusStateEnabled: this.option(\"focusStateEnabled\"),\r\n            allowDrag: this._allowDragging(),\r\n            allowDelete: this._editing.allowUpdating && this._editing.allowDeleting,\r\n            allowResize: this._allowResizing(),\r\n            allowAllDayResize: this._allowAllDayResizing(),\r\n            rtlEnabled: this.option(\"rtlEnabled\"),\r\n            currentView: this.option(\"currentView\"),\r\n            onContentReady: function() {\r\n                that._workSpace && that._workSpace.option(\"allDayExpanded\", that._isAllDayExpanded(that.getFilteredItems()))\r\n            }\r\n        };\r\n        return config\r\n    },\r\n    getCollectorOffset: function() {\r\n        if (this._workSpace.needApplyCollectorOffset() && !this.option(\"adaptivityEnabled\")) {\r\n            return this.option(\"_collectorOffset\")\r\n        } else {\r\n            return 0\r\n        }\r\n    },\r\n    getAppointmentDurationInMinutes: function() {\r\n        return this._getCurrentViewOption(\"cellDuration\")\r\n    },\r\n    _processCurrentView: function() {\r\n        var views = this.option(\"views\");\r\n        var currentView = this.option(\"currentView\");\r\n        var that = this;\r\n        this._currentView = currentView;\r\n        (0, _iterator.each)(views, function(_, view) {\r\n            var isViewIsObject = _type2.default.isObject(view);\r\n            var viewName = isViewIsObject ? view.name : view;\r\n            var viewType = view.type;\r\n            if (currentView === viewName || currentView === viewType) {\r\n                that._currentView = view;\r\n                return false\r\n            }\r\n        })\r\n    },\r\n    _getCurrentViewType: function() {\r\n        return this._currentView.type || this._currentView\r\n    },\r\n    _getAppointmentsRenderingStrategy: function() {\r\n        return VIEWS_CONFIG[this._getCurrentViewType()].renderingStrategy\r\n    },\r\n    _renderWorkSpace: function(groups) {\r\n        this._readyToRenderAppointments && this._toggleSmallClass();\r\n        var $workSpace = (0, _renderer2.default)(\"<div>\").appendTo(this.$element());\r\n        var countConfig = this._getViewCountConfig();\r\n        this._workSpace = this._createComponent($workSpace, VIEWS_CONFIG[this._getCurrentViewType()].workSpace, this._workSpaceConfig(groups, countConfig));\r\n        this._allowDragging() && this._workSpace.initDragBehavior(this);\r\n        this._workSpace.getWorkArea().append(this._appointments.$element());\r\n        this._recalculateWorkspace();\r\n        countConfig.startDate && this._header && this._header.option(\"currentDate\", this._workSpace._getHeaderDate());\r\n        this._appointments.option(\"_collectorOffset\", this.getCollectorOffset())\r\n    },\r\n    _getViewCountConfig: function() {\r\n        var currentView = this.option(\"currentView\");\r\n        var view = this._getViewByName(currentView);\r\n        var viewCount = view && view.intervalCount || 1;\r\n        var startDate = view && view.startDate || null;\r\n        return {\r\n            intervalCount: viewCount,\r\n            startDate: startDate\r\n        }\r\n    },\r\n    _getViewByName: function(name) {\r\n        var views = this.option(\"views\");\r\n        for (var i = 0; i < views.length; i++) {\r\n            if (views[i].name === name || views[i].type === name || views[i] === name) {\r\n                return views[i]\r\n            }\r\n        }\r\n    },\r\n    _recalculateWorkspace: function() {\r\n        var _this6 = this;\r\n        this._workSpaceRecalculation = new Deferred;\r\n        this._waitAsyncTemplates(function() {\r\n            _dom2.default.triggerResizeEvent(_this6._workSpace.$element());\r\n            _this6._workSpace._refreshDateTimeIndication()\r\n        })\r\n    },\r\n    _workSpaceConfig: function(groups, countConfig) {\r\n        var _this7 = this;\r\n        var result;\r\n        var currentViewOptions = this._getCurrentViewOptions();\r\n        result = (0, _extend.extend)({\r\n            noDataText: this.option(\"noDataText\"),\r\n            firstDayOfWeek: this.option(\"firstDayOfWeek\"),\r\n            startDayHour: this.option(\"startDayHour\"),\r\n            endDayHour: this.option(\"endDayHour\"),\r\n            tabIndex: this.option(\"tabIndex\"),\r\n            accessKey: this.option(\"accessKey\"),\r\n            focusStateEnabled: this.option(\"focusStateEnabled\"),\r\n            cellDuration: this.option(\"cellDuration\"),\r\n            showAllDayPanel: this.option(\"showAllDayPanel\"),\r\n            showCurrentTimeIndicator: this.option(\"showCurrentTimeIndicator\"),\r\n            indicatorTime: this.option(\"indicatorTime\"),\r\n            indicatorUpdateInterval: this.option(\"indicatorUpdateInterval\"),\r\n            shadeUntilCurrentTime: this.option(\"shadeUntilCurrentTime\"),\r\n            allDayExpanded: this._appointments.option(\"items\"),\r\n            crossScrollingEnabled: this.option(\"crossScrollingEnabled\"),\r\n            dataCellTemplate: this.option(\"dataCellTemplate\"),\r\n            timeCellTemplate: this.option(\"timeCellTemplate\"),\r\n            resourceCellTemplate: this.option(\"resourceCellTemplate\"),\r\n            dateCellTemplate: this.option(\"dateCellTemplate\"),\r\n            allowMultipleCellSelection: this.option(\"allowMultipleCellSelection\"),\r\n            selectedCellData: this.option(\"selectedCellData\"),\r\n            onSelectionChanged: function(args) {\r\n                _this7.option(\"selectedCellData\", args.selectedCellData)\r\n            },\r\n            groupByDate: this._getCurrentViewOption(\"groupByDate\")\r\n        }, currentViewOptions);\r\n        result.observer = this;\r\n        result.intervalCount = countConfig.intervalCount;\r\n        result.startDate = countConfig.startDate;\r\n        result.groups = groups;\r\n        result.onCellClick = this._createActionByOption(\"onCellClick\");\r\n        result.onCellContextMenu = this._createActionByOption(\"onCellContextMenu\");\r\n        result.min = new Date(this._dateOption(\"min\"));\r\n        result.max = new Date(this._dateOption(\"max\"));\r\n        result.currentDate = _date2.default.trimTime(new Date(this._dateOption(\"currentDate\")));\r\n        result.hoursInterval = result.cellDuration / 60;\r\n        result.allDayExpanded = this._isAllDayExpanded(this.getFilteredItems());\r\n        result.dataCellTemplate = result.dataCellTemplate ? this._getTemplate(result.dataCellTemplate) : null;\r\n        result.timeCellTemplate = result.timeCellTemplate ? this._getTemplate(result.timeCellTemplate) : null;\r\n        result.resourceCellTemplate = result.resourceCellTemplate ? this._getTemplate(result.resourceCellTemplate) : null;\r\n        result.dateCellTemplate = result.dateCellTemplate ? this._getTemplate(result.dateCellTemplate) : null;\r\n        return result\r\n    },\r\n    _getCurrentViewOptions: function() {\r\n        return this._currentView\r\n    },\r\n    _getCurrentViewOption: function(optionName) {\r\n        var currentViewOptions = this._getCurrentViewOptions();\r\n        if (currentViewOptions && void 0 !== currentViewOptions[optionName]) {\r\n            return currentViewOptions[optionName]\r\n        }\r\n        return this.option(optionName)\r\n    },\r\n    _getAppointmentTemplate: function(optionName) {\r\n        var currentViewOptions = this._getCurrentViewOptions();\r\n        if (currentViewOptions && currentViewOptions[optionName]) {\r\n            return this._getTemplate(currentViewOptions[optionName])\r\n        }\r\n        return this._getTemplateByOption(optionName)\r\n    },\r\n    _updateOption: function(viewName, optionName, value) {\r\n        var currentViewOptions = this._getCurrentViewOptions();\r\n        if (!currentViewOptions || !_type2.default.isDefined(currentViewOptions[optionName])) {\r\n            this[\"_\" + viewName].option(optionName, value)\r\n        }\r\n    },\r\n    _refreshWorkSpace: function(groups) {\r\n        var _this8 = this;\r\n        this._cleanWorkspace();\r\n        delete this._workSpace;\r\n        this._renderWorkSpace(groups);\r\n        if (this._readyToRenderAppointments) {\r\n            this._appointments.option({\r\n                fixedContainer: this._workSpace.getFixedContainer(),\r\n                allDayContainer: this._workSpace.getAllDayContainer()\r\n            });\r\n            this._waitAsyncTemplates(function() {\r\n                _this8._workSpaceRecalculation.resolve()\r\n            })\r\n        }\r\n    },\r\n    _cleanWorkspace: function() {\r\n        this._appointments.$element().detach();\r\n        this._workSpace._dispose();\r\n        this._workSpace.$element().remove();\r\n        this.option(\"selectedCellData\", [])\r\n    },\r\n    getWorkSpaceScrollable: function() {\r\n        return this._workSpace.getScrollable()\r\n    },\r\n    getWorkSpaceScrollableScrollTop: function(allDay) {\r\n        return this._workSpace.getGroupedScrollableScrollTop(allDay)\r\n    },\r\n    getWorkSpaceScrollableScrollLeft: function() {\r\n        return this._workSpace.getScrollableScrollLeft()\r\n    },\r\n    getWorkSpaceScrollableContainer: function() {\r\n        return this._workSpace.getScrollableContainer()\r\n    },\r\n    getWorkSpaceAllDayHeight: function() {\r\n        return this._workSpace.getAllDayHeight()\r\n    },\r\n    getWorkSpaceAllDayOffset: function() {\r\n        return this._workSpace.getAllDayOffset()\r\n    },\r\n    getWorkSpaceHeaderPanelHeight: function() {\r\n        return this._workSpace.getHeaderPanelHeight()\r\n    },\r\n    getWorkSpaceDateTableOffset: function() {\r\n        return !this.option(\"crossScrollingEnabled\") || this.option(\"rtlEnabled\") ? this._workSpace.getWorkSpaceLeftOffset() : 0\r\n    },\r\n    getWorkSpace: function() {\r\n        return this._workSpace\r\n    },\r\n    getAppointmentModel: function() {\r\n        return this._appointmentModel\r\n    },\r\n    getHeader: function() {\r\n        return this._header\r\n    },\r\n    getMaxAppointmentsPerCell: function() {\r\n        return this._getCurrentViewOption(\"maxAppointmentsPerCell\")\r\n    },\r\n    _cleanPopup: function() {\r\n        this._appointmentPopup.dispose()\r\n    },\r\n    _convertDatesByTimezoneBack: function(applyAppointmentTimezone, sourceAppointmentData, targetAppointmentData) {\r\n        targetAppointmentData = targetAppointmentData || sourceAppointmentData;\r\n        var processedStartDate = this.fire(\"convertDateByTimezoneBack\", this.fire(\"getField\", \"startDate\", sourceAppointmentData), applyAppointmentTimezone && this.fire(\"getField\", \"startDateTimeZone\", sourceAppointmentData));\r\n        var processedEndDate = this.fire(\"convertDateByTimezoneBack\", this.fire(\"getField\", \"endDate\", sourceAppointmentData), applyAppointmentTimezone && this.fire(\"getField\", \"endDateTimeZone\", sourceAppointmentData));\r\n        this.fire(\"setField\", \"startDate\", targetAppointmentData, processedStartDate);\r\n        this.fire(\"setField\", \"endDate\", targetAppointmentData, processedEndDate)\r\n    },\r\n    _checkRecurringAppointment: function(targetAppointment, singleAppointment, exceptionDate, callback, isDeleted, isPopupEditing, dragEvent) {\r\n        delete this._updatedRecAppointment;\r\n        var recurrenceRule = this.fire(\"getField\", \"recurrenceRule\", targetAppointment);\r\n        if (!_utils2.default.getRecurrenceRule(recurrenceRule).isValid || !this._editing.allowUpdating) {\r\n            callback();\r\n            return\r\n        }\r\n        var editMode = this.option(\"recurrenceEditMode\");\r\n        switch (editMode) {\r\n            case \"series\":\r\n                callback();\r\n                break;\r\n            case \"occurrence\":\r\n                this._singleAppointmentChangesHandler(targetAppointment, singleAppointment, exceptionDate, isDeleted, isPopupEditing, dragEvent);\r\n                break;\r\n            default:\r\n                if (dragEvent) {\r\n                    dragEvent.cancel = new Deferred\r\n                }\r\n                this._showRecurrenceChangeConfirm(isDeleted).done(function(result) {\r\n                    result && callback();\r\n                    !result && this._singleAppointmentChangesHandler(targetAppointment, singleAppointment, exceptionDate, isDeleted, isPopupEditing, dragEvent)\r\n                }.bind(this)).fail(function() {\r\n                    this._appointments.moveAppointmentBack(dragEvent)\r\n                }.bind(this))\r\n        }\r\n    },\r\n    _singleAppointmentChangesHandler: function(targetAppointment, singleAppointment, exceptionDate, isDeleted, isPopupEditing, dragEvent) {\r\n        exceptionDate = new Date(exceptionDate);\r\n\r\n        function processAppointmentDates(appointment, commonTimezoneOffset) {\r\n            var startDate = this.fire(\"getField\", \"startDate\", appointment);\r\n            var processedStartDate = this.fire(\"convertDateByTimezoneBack\", startDate, this.fire(\"getField\", \"startDateTimeZone\", appointment));\r\n            var endDate = this.fire(\"getField\", \"endDate\", appointment);\r\n            var processedEndDate = this.fire(\"convertDateByTimezoneBack\", endDate, this.fire(\"getField\", \"endDateTimeZone\", appointment));\r\n            if (\"number\" === typeof commonTimezoneOffset && !isNaN(commonTimezoneOffset)) {\r\n                var startDateClientTzOffset = -(this._subscribes.getClientTimezoneOffset(startDate) / toMs(\"hour\"));\r\n                var endDateClientTzOffset = -(this._subscribes.getClientTimezoneOffset(endDate) / toMs(\"hour\"));\r\n                var processedStartDateInUTC = processedStartDate.getTime() - startDateClientTzOffset * toMs(\"hour\");\r\n                var processedEndDateInUTC = processedEndDate.getTime() - endDateClientTzOffset * toMs(\"hour\");\r\n                processedStartDate = new Date(processedStartDateInUTC + commonTimezoneOffset * toMs(\"hour\"));\r\n                processedEndDate = new Date(processedEndDateInUTC + commonTimezoneOffset * toMs(\"hour\"))\r\n            }\r\n            this.fire(\"setField\", \"startDate\", appointment, processedStartDate);\r\n            this.fire(\"setField\", \"endDate\", appointment, processedEndDate)\r\n        }\r\n        this.fire(\"setField\", \"recurrenceRule\", singleAppointment, \"\");\r\n        this.fire(\"setField\", \"recurrenceException\", singleAppointment, \"\");\r\n        if (!isDeleted && !isPopupEditing) {\r\n            processAppointmentDates.call(this, singleAppointment, this._getTimezoneOffsetByOption());\r\n            this.addAppointment(singleAppointment)\r\n        }\r\n        var recurrenceException = this._makeDateAsRecurrenceException(exceptionDate, targetAppointment);\r\n        var updatedAppointment = (0, _extend.extend)({}, targetAppointment);\r\n        this.fire(\"setField\", \"recurrenceException\", updatedAppointment, recurrenceException);\r\n        if (isPopupEditing) {\r\n            this._updatedRecAppointment = updatedAppointment;\r\n            processAppointmentDates.call(this, singleAppointment);\r\n            this._showAppointmentPopup(singleAppointment, true, true);\r\n            this._editAppointmentData = targetAppointment\r\n        } else {\r\n            this._updateAppointment(targetAppointment, updatedAppointment, function() {\r\n                this._appointments.moveAppointmentBack(dragEvent)\r\n            }, dragEvent)\r\n        }\r\n    },\r\n    _makeDateAsRecurrenceException: function(exceptionDate, targetAppointment) {\r\n        var startDate = this._getStartDate(targetAppointment, true);\r\n        var startDateTimeZone = this.fire(\"getField\", \"startDateTimeZone\", targetAppointment);\r\n        var exceptionByDate = this._getRecurrenceExceptionDate(exceptionDate, startDate, startDateTimeZone);\r\n        var recurrenceException = this.fire(\"getField\", \"recurrenceException\", targetAppointment);\r\n        return recurrenceException ? recurrenceException + \",\" + exceptionByDate : exceptionByDate\r\n    },\r\n    _getRecurrenceExceptionDate: function(exceptionStartDate, targetStartDate, startDateTimeZone) {\r\n        exceptionStartDate = this.fire(\"convertDateByTimezoneBack\", exceptionStartDate, startDateTimeZone);\r\n        var appointmentStartDate = this.fire(\"convertDateByTimezoneBack\", targetStartDate, startDateTimeZone);\r\n        exceptionStartDate.setHours(appointmentStartDate.getHours(), appointmentStartDate.getMinutes(), appointmentStartDate.getSeconds(), appointmentStartDate.getMilliseconds());\r\n        var timezoneDiff = targetStartDate.getTimezoneOffset() - exceptionStartDate.getTimezoneOffset();\r\n        exceptionStartDate = new Date(exceptionStartDate.getTime() - timezoneDiff * toMs(\"minute\"));\r\n        return _date_serialization2.default.serializeDate(exceptionStartDate, UTC_FULL_DATE_FORMAT)\r\n    },\r\n    _showRecurrenceChangeConfirm: function(isDeleted) {\r\n        var message = _message2.default.format(isDeleted ? \"dxScheduler-confirmRecurrenceDeleteMessage\" : \"dxScheduler-confirmRecurrenceEditMessage\");\r\n        var seriesText = _message2.default.format(isDeleted ? \"dxScheduler-confirmRecurrenceDeleteSeries\" : \"dxScheduler-confirmRecurrenceEditSeries\");\r\n        var occurrenceText = _message2.default.format(isDeleted ? \"dxScheduler-confirmRecurrenceDeleteOccurrence\" : \"dxScheduler-confirmRecurrenceEditOccurrence\");\r\n        return _dialog2.default.custom({\r\n            messageHtml: message,\r\n            showCloseButton: true,\r\n            showTitle: true,\r\n            buttons: [{\r\n                text: seriesText,\r\n                onClick: function() {\r\n                    return true\r\n                }\r\n            }, {\r\n                text: occurrenceText,\r\n                onClick: function() {\r\n                    return false\r\n                }\r\n            }]\r\n        }).show()\r\n    },\r\n    _getUpdatedData: function(options) {\r\n        var target = options.data || options;\r\n        var cellData = this.getTargetCellData();\r\n        var targetAllDay = this.fire(\"getField\", \"allDay\", target);\r\n        var targetStartDate = new Date(this.fire(\"getField\", \"startDate\", target));\r\n        var targetEndDate = new Date(this.fire(\"getField\", \"endDate\", target));\r\n        var date = cellData.date || targetStartDate;\r\n        var duration = targetEndDate.getTime() - targetStartDate.getTime();\r\n        if (this._workSpace.keepOriginalHours() && !isNaN(targetStartDate.getTime())) {\r\n            var diff = targetStartDate.getTime() - _date2.default.trimTime(targetStartDate).getTime();\r\n            date = new Date(_date2.default.trimTime(date).getTime() + diff)\r\n        }\r\n        var updatedData = {};\r\n        var allDay = cellData.allDay;\r\n        this.fire(\"setField\", \"allDay\", updatedData, allDay);\r\n        this.fire(\"setField\", \"startDate\", updatedData, date);\r\n        var endDate = new Date(date.getTime() + duration);\r\n        if (this.appointmentTakesAllDay(target) && !updatedData.allDay && this._workSpace.supportAllDayRow()) {\r\n            endDate = this._workSpace.calculateEndDate(date)\r\n        }\r\n        if (targetAllDay && !this._workSpace.supportAllDayRow() && !this._workSpace.keepOriginalHours()) {\r\n            var dateCopy = new Date(date);\r\n            dateCopy.setHours(0);\r\n            endDate = new Date(dateCopy.getTime() + duration);\r\n            if (0 !== endDate.getHours()) {\r\n                endDate.setHours(this._getCurrentViewOption(\"endDayHour\"))\r\n            }\r\n        }\r\n        endDate = new Date(endDate.getTime() - _utils4.default.getTimezoneOffsetChangeInMs(targetStartDate, targetEndDate, date, endDate));\r\n        this.fire(\"setField\", \"endDate\", updatedData, endDate);\r\n        this._resourcesManager.setResourcesToItem(updatedData, cellData.groups);\r\n        return updatedData\r\n    },\r\n    _getCoordinates: function(initialDates, dates, appointmentResources, allDay) {\r\n        var result = [];\r\n        for (var i = 0; i < dates.length; i++) {\r\n            var currentCoords = this._workSpace.getCoordinatesByDateInGroup(dates[i], appointmentResources, allDay);\r\n            for (var j = 0; j < currentCoords.length; j++) {\r\n                (0, _extend.extend)(currentCoords[j], {\r\n                    startDate: dates[i],\r\n                    initialStartDate: initialDates[i]\r\n                })\r\n            }\r\n            result = result.concat(currentCoords)\r\n        }\r\n        return result\r\n    },\r\n    _isAppointmentRecurrence: function(appointmentData) {\r\n        var recurrenceRule = this.fire(\"getField\", \"recurrenceRule\", appointmentData);\r\n        return recurrenceRule && _utils2.default.getRecurrenceRule(recurrenceRule).isValid\r\n    },\r\n    resizePopup: function() {\r\n        this._appointmentPopup.triggerResize()\r\n    },\r\n    _getSingleAppointmentData: function(appointmentData, options) {\r\n        options = options || {};\r\n        var $appointment = options.$appointment;\r\n        var updatedData = options.skipDateCalculation ? {} : this._getUpdatedData(options);\r\n        var resultAppointmentData = (0, _extend.extend)({}, appointmentData, updatedData);\r\n        var allDay = this.fire(\"getField\", \"allDay\", appointmentData);\r\n        var isAllDay = this._workSpace.supportAllDayRow() && allDay;\r\n        var startDate = new Date(this.fire(\"getField\", \"startDate\", resultAppointmentData));\r\n        var endDate = new Date(this.fire(\"getField\", \"endDate\", resultAppointmentData));\r\n        var appointmentDuration = endDate.getTime() - startDate.getTime();\r\n        var updatedStartDate = startDate;\r\n        var appointmentStartDate;\r\n        if (_type2.default.isDefined($appointment) && (this._isAppointmentRecurrence(appointmentData) || this._needUpdateAppointmentData($appointment))) {\r\n            var apptDataCalculator = this.getRenderingStrategyInstance().getAppointmentDataCalculator();\r\n            if (_type2.default.isFunction(apptDataCalculator)) {\r\n                updatedStartDate = apptDataCalculator($appointment, startDate).startDate\r\n            } else {\r\n                if (options.isAppointmentResized) {\r\n                    var coordinates = _translator2.default.locate($appointment);\r\n                    updatedStartDate = new Date(this._workSpace.getCellDataByCoordinates(coordinates, isAllDay).startDate)\r\n                } else {\r\n                    appointmentStartDate = $appointment.data(\"dxAppointmentSettings\") && $appointment.data(\"dxAppointmentSettings\").startDate;\r\n                    if ($appointment.hasClass(_constants.REDUCED_APPOINTMENT_CLASS)) {\r\n                        appointmentStartDate = $appointment.data(\"dxAppointmentStartDate\")\r\n                    }\r\n                    if (appointmentStartDate) {\r\n                        updatedStartDate = appointmentStartDate\r\n                    }\r\n                }\r\n                if (!options.skipHoursProcessing) {\r\n                    this.fire(\"convertDateByTimezoneBack\", updatedStartDate, this.fire(\"getField\", \"startDateTimeZone\", appointmentData))\r\n                }\r\n            }\r\n            this.fire(\"setField\", \"startDate\", resultAppointmentData, updatedStartDate);\r\n            this.fire(\"setField\", \"endDate\", resultAppointmentData, new Date(updatedStartDate.getTime() + appointmentDuration))\r\n        }\r\n        return resultAppointmentData\r\n    },\r\n    _needUpdateAppointmentData: function($appointment) {\r\n        return $appointment.hasClass(_constants.COMPACT_APPOINTMENT_CLASS) || $appointment.hasClass(_constants.RECURRENCE_APPOINTMENT_CLASS)\r\n    },\r\n    subscribe: function(subject, action) {\r\n        this._subscribes[subject] = _uiScheduler2.default[subject] = action\r\n    },\r\n    fire: function(subject) {\r\n        var callback = this._subscribes[subject];\r\n        var args = Array.prototype.slice.call(arguments);\r\n        if (!_type2.default.isFunction(callback)) {\r\n            throw _ui2.default.Error(\"E1031\", subject)\r\n        }\r\n        return callback.apply(this, args.slice(1))\r\n    },\r\n    getTargetCellData: function() {\r\n        return this._workSpace.getDataByDroppableCell()\r\n    },\r\n    _updateAppointment: function(target, appointment, onUpdatePrevented, dragEvent) {\r\n        var updatingOptions = {\r\n            newData: appointment,\r\n            oldData: (0, _extend.extend)({}, target),\r\n            cancel: false\r\n        };\r\n        var performFailAction = function(err) {\r\n            if (_type2.default.isFunction(onUpdatePrevented)) {\r\n                onUpdatePrevented.call(this)\r\n            }\r\n            if (err && \"Error\" === err.name) {\r\n                throw err\r\n            }\r\n        }.bind(this);\r\n        this._actions.onAppointmentUpdating(updatingOptions);\r\n        if (dragEvent && !_type2.default.isDeferred(dragEvent.cancel)) {\r\n            dragEvent.cancel = new Deferred\r\n        }\r\n        this._processActionResult(updatingOptions, function(canceled) {\r\n            if (!canceled) {\r\n                this._expandAllDayPanel(appointment);\r\n                try {\r\n                    this._appointmentModel.update(target, appointment).done(function() {\r\n                        dragEvent && dragEvent.cancel.resolve(false)\r\n                    }).always(function(e) {\r\n                        this._executeActionWhenOperationIsCompleted(this._actions.onAppointmentUpdated, appointment, e)\r\n                    }.bind(this)).fail(function() {\r\n                        performFailAction()\r\n                    })\r\n                } catch (err) {\r\n                    performFailAction(err)\r\n                }\r\n            } else {\r\n                performFailAction()\r\n            }\r\n        })\r\n    },\r\n    _processActionResult: function(actionOptions, callback) {\r\n        var _this9 = this;\r\n        if (_type2.default.isPromise(actionOptions.cancel)) {\r\n            when(_deferred2.default.fromPromise(actionOptions.cancel)).always(function(cancel) {\r\n                if (!_type2.default.isDefined(cancel)) {\r\n                    cancel = \"rejected\" === actionOptions.cancel.state()\r\n                }\r\n                callback.call(_this9, cancel)\r\n            })\r\n        } else {\r\n            callback.call(this, actionOptions.cancel)\r\n        }\r\n    },\r\n    _expandAllDayPanel: function(appointment) {\r\n        if (!this._isAllDayExpanded(this.getFilteredItems()) && this.appointmentTakesAllDay(appointment)) {\r\n            this._workSpace.option(\"allDayExpanded\", true)\r\n        }\r\n    },\r\n    _executeActionWhenOperationIsCompleted: function(action, appointment, e) {\r\n        var options = {\r\n            appointmentData: appointment\r\n        };\r\n        var isError = e && \"Error\" === e.name;\r\n        if (isError) {\r\n            options.error = e\r\n        } else {\r\n            this._appointmentPopup.isVisible() && this._appointmentPopup.hide()\r\n        }\r\n        action(options);\r\n        this._fireContentReadyAction()\r\n    },\r\n    _showAppointmentPopup: function(data, visibleButtons, isProcessTimeZone) {\r\n        this._appointmentPopup.show(data, visibleButtons, isProcessTimeZone)\r\n    },\r\n    getAppointmentPopup: function() {\r\n        return this._appointmentPopup.getPopup()\r\n    },\r\n    getAppointmentDetailsForm: function() {\r\n        return this._appointmentPopup._appointmentForm\r\n    },\r\n    getUpdatedAppointment: function() {\r\n        return this._appointmentModel.getUpdatedAppointment()\r\n    },\r\n    getUpdatedAppointmentKeys: function() {\r\n        return this._appointmentModel.getUpdatedAppointmentKeys()\r\n    },\r\n    getAppointmentsInstance: function() {\r\n        return this._appointments\r\n    },\r\n    getResourceManager: function() {\r\n        return this._resourcesManager\r\n    },\r\n    getLayoutManager: function() {\r\n        return this._layoutManager\r\n    },\r\n    getRenderingStrategyInstance: function() {\r\n        return this._layoutManager.getRenderingStrategyInstance()\r\n    },\r\n    getFilteredItems: function() {\r\n        return this._filteredItems\r\n    },\r\n    getActions: function() {\r\n        return this._actions\r\n    },\r\n    appointmentTakesAllDay: function(appointment) {\r\n        return this._appointmentModel.appointmentTakesAllDay(appointment, this._getCurrentViewOption(\"startDayHour\"), this._getCurrentViewOption(\"endDayHour\"))\r\n    },\r\n    _getStartDate: function(appointment, skipNormalize) {\r\n        var startDate = this.fire(\"getField\", \"startDate\", appointment);\r\n        var startDateTimeZone = this.fire(\"getField\", \"startDateTimeZone\", appointment);\r\n        startDate = this.fire(\"convertDateByTimezone\", _date2.default.makeDate(startDate), startDateTimeZone);\r\n        return !skipNormalize ? this.fire(\"updateAppointmentStartDate\", {\r\n            startDate: startDate,\r\n            appointment: appointment\r\n        }) : startDate\r\n    },\r\n    _getEndDate: function(appointment, skipNormalize) {\r\n        var endDate = new Date(this.fire(\"getField\", \"endDate\", appointment));\r\n        var startDate = new Date(this.fire(\"getField\", \"startDate\", appointment));\r\n        var isSameDate = _date2.default.sameDate(startDate, endDate);\r\n        if (endDate) {\r\n            var endDateTimeZone = this.fire(\"getField\", \"endDateTimeZone\", appointment);\r\n            endDate = this.fire(\"convertDateByTimezone\", _date2.default.makeDate(endDate), endDateTimeZone);\r\n            return !skipNormalize ? this.fire(\"updateAppointmentEndDate\", {\r\n                endDate: endDate,\r\n                isSameDate: isSameDate\r\n            }) : endDate\r\n        }\r\n        return endDate\r\n    },\r\n    _getRecurrenceException: function(appointmentData) {\r\n        var recurrenceException = this.fire(\"getField\", \"recurrenceException\", appointmentData);\r\n        if (recurrenceException) {\r\n            var startDate = this.fire(\"getField\", \"startDate\", appointmentData);\r\n            var exceptions = recurrenceException.split(\",\");\r\n            var startDateTimeZone = this.fire(\"getField\", \"startDateTimeZone\", appointmentData);\r\n            var exceptionByStartDate = this.fire(\"convertDateByTimezone\", startDate, startDateTimeZone);\r\n            for (var i = 0; i < exceptions.length; i++) {\r\n                exceptions[i] = this._convertRecurrenceException(exceptions[i], exceptionByStartDate, startDateTimeZone)\r\n            }\r\n            recurrenceException = exceptions.join()\r\n        }\r\n        return recurrenceException\r\n    },\r\n    _convertRecurrenceException: function(exception, exceptionByStartDate, startDateTimeZone) {\r\n        exception = exception.replace(/\\s/g, \"\");\r\n        exception = _date_serialization2.default.deserializeDate(exception);\r\n        exception = this.fire(\"convertDateByTimezone\", exception, startDateTimeZone);\r\n        exception.setHours(exceptionByStartDate.getHours());\r\n        exception = _date_serialization2.default.serializeDate(exception, FULL_DATE_FORMAT);\r\n        return exception\r\n    },\r\n    recurrenceEditorVisibilityChanged: function(visible) {\r\n        if (this._appointmentPopup._appointmentForm) {\r\n            this._appointmentPopup._appointmentForm.$element().find(\".\" + RECURRENCE_EDITOR_ITEM_CLASS).toggleClass(RECURRENCE_EDITOR_OPENED_ITEM_CLASS, visible)\r\n        }\r\n    },\r\n    dayHasAppointment: function(day, appointment, trimTime) {\r\n        var startDate = new Date(this.fire(\"getField\", \"startDate\", appointment));\r\n        var endDate = new Date(this.fire(\"getField\", \"endDate\", appointment));\r\n        var startDateTimeZone = this.fire(\"getField\", \"startDateTimeZone\", appointment);\r\n        var endDateTimeZone = this.fire(\"getField\", \"endDateTimeZone\", appointment);\r\n        startDate = this.fire(\"convertDateByTimezone\", startDate, startDateTimeZone);\r\n        endDate = this.fire(\"convertDateByTimezone\", endDate, endDateTimeZone);\r\n        if (day.getTime() === endDate.getTime()) {\r\n            return startDate.getTime() === endDate.getTime()\r\n        }\r\n        if (trimTime) {\r\n            day = _date2.default.trimTime(day);\r\n            startDate = _date2.default.trimTime(startDate);\r\n            endDate = _date2.default.trimTime(endDate)\r\n        }\r\n        var dayTimeStamp = day.getTime();\r\n        var startDateTimeStamp = startDate.getTime();\r\n        var endDateTimeStamp = endDate.getTime();\r\n        return (0, _array.inArray)(dayTimeStamp, [startDateTimeStamp, endDateTimeStamp]) > -1 || startDateTimeStamp < dayTimeStamp && endDateTimeStamp > dayTimeStamp\r\n    },\r\n    setTargetedAppointmentResources: function(targetedAppointment, appointmentElement, appointmentIndex) {\r\n        var groups = this._getCurrentViewOption(\"groups\");\r\n        if (groups && groups.length) {\r\n            var resourcesSetter = this._resourcesManager._dataAccessors.setter;\r\n            var workSpace = this._workSpace;\r\n            var getGroups;\r\n            var setResourceCallback;\r\n            if (this._isAgenda()) {\r\n                getGroups = function() {\r\n                    var apptSettings = this.getLayoutManager()._positionMap[appointmentIndex];\r\n                    return workSpace._getCellGroups(apptSettings[0].groupIndex)\r\n                };\r\n                setResourceCallback = function(_, group) {\r\n                    resourcesSetter[group.name](targetedAppointment, group.id)\r\n                }\r\n            } else {\r\n                getGroups = function() {\r\n                    var setting = (0, _renderer2.default)(appointmentElement).data(\"dxAppointmentSettings\") || {};\r\n                    return workSpace.getCellDataByCoordinates({\r\n                        left: setting.left,\r\n                        top: setting.top\r\n                    }).groups\r\n                };\r\n                setResourceCallback = function(field, value) {\r\n                    resourcesSetter[field](targetedAppointment, value)\r\n                }\r\n            }(0, _iterator.each)(getGroups.call(this), setResourceCallback)\r\n        }\r\n    },\r\n    getStartViewDate: function() {\r\n        return this._workSpace.getStartViewDate()\r\n    },\r\n    getEndViewDate: function() {\r\n        return this._workSpace.getEndViewDate()\r\n    },\r\n    showAppointmentPopup: function(appointmentData, createNewAppointment, currentAppointmentData) {\r\n        var singleAppointment = currentAppointmentData || this._getSingleAppointmentData(appointmentData, {\r\n            skipDateCalculation: true\r\n        });\r\n        var startDate = this.fire(\"getField\", \"startDate\", currentAppointmentData || appointmentData);\r\n        this._checkRecurringAppointment(appointmentData, singleAppointment, startDate, function() {\r\n            if (createNewAppointment || _type2.default.isEmptyObject(appointmentData)) {\r\n                delete this._editAppointmentData;\r\n                this._editing.allowAdding && this._showAppointmentPopup(appointmentData, true, false)\r\n            } else {\r\n                this._editAppointmentData = appointmentData;\r\n                this._showAppointmentPopup(appointmentData, this._editing.allowUpdating, true)\r\n            }\r\n        }.bind(this), false, true)\r\n    },\r\n    hideAppointmentPopup: function(saveChanges) {\r\n        if (this._appointmentPopup.isVisible()) {\r\n            saveChanges && this._appointmentPopup.saveChanges();\r\n            this._appointmentPopup.hide()\r\n        }\r\n    },\r\n    showAppointmentTooltip: function(appointmentData, target, currentAppointmentData) {\r\n        if (appointmentData) {\r\n            this.showAppointmentTooltipCore(target, [{\r\n                color: this._appointments._tryGetAppointmentColor(target),\r\n                data: appointmentData,\r\n                currentData: currentAppointmentData\r\n            }])\r\n        }\r\n    },\r\n    showAppointmentTooltipCore: function(target, data, options) {\r\n        if (this._appointmentTooltip.isAlreadyShown(target)) {\r\n            this.hideAppointmentTooltip()\r\n        } else {\r\n            this._appointmentTooltip.show(target, data, (0, _extend.extend)(this._getExtraAppointmentTooltipOptions(), options))\r\n        }\r\n    },\r\n    hideAppointmentTooltip: function() {\r\n        this._appointmentTooltip.hide()\r\n    },\r\n    scrollToTime: function(hours, minutes, date) {\r\n        this._workSpace.scrollToTime(hours, minutes, date)\r\n    },\r\n    addAppointment: function(appointment) {\r\n        var text = this.fire(\"getField\", \"text\", appointment);\r\n        if (!text) {\r\n            this.fire(\"setField\", \"text\", appointment, \"\")\r\n        }\r\n        this._convertDatesByTimezoneBack(true, appointment);\r\n        var addingOptions = {\r\n            appointmentData: appointment,\r\n            cancel: false\r\n        };\r\n        this._actions.onAppointmentAdding(addingOptions);\r\n        this._processActionResult(addingOptions, function(canceled) {\r\n            if (!canceled) {\r\n                this._expandAllDayPanel(appointment);\r\n                this._appointmentModel.add(appointment, {\r\n                    value: this._getTimezoneOffsetByOption(),\r\n                    clientOffset: this.fire(\"getClientTimezoneOffset\")\r\n                }).always(function(e) {\r\n                    this._executeActionWhenOperationIsCompleted(this._actions.onAppointmentAdded, appointment, e)\r\n                }.bind(this))\r\n            }\r\n        })\r\n    },\r\n    updateAppointment: function(target, appointment) {\r\n        this._updateAppointment(target, appointment)\r\n    },\r\n    deleteAppointment: function(appointment) {\r\n        var deletingOptions = {\r\n            appointmentData: appointment,\r\n            cancel: false\r\n        };\r\n        this._actions.onAppointmentDeleting(deletingOptions);\r\n        this._processActionResult(deletingOptions, function(canceled) {\r\n            if (!canceled) {\r\n                this._appointmentModel.remove(appointment).always(function(e) {\r\n                    this._executeActionWhenOperationIsCompleted(this._actions.onAppointmentDeleted, appointment, e)\r\n                }.bind(this))\r\n            }\r\n        })\r\n    },\r\n    focus: function() {\r\n        if (this._editAppointmentData) {\r\n            this._appointments.focus()\r\n        } else {\r\n            this._workSpace.focus()\r\n        }\r\n    },\r\n    getFirstDayOfWeek: function() {\r\n        return _type2.default.isDefined(this.option(\"firstDayOfWeek\")) ? this.option(\"firstDayOfWeek\") : _date4.default.firstDayOfWeekIndex()\r\n    }\r\n}).include(_async_template_mixin2.default, _data_helper2.default);\r\n(0, _component_registrator2.default)(\"dxScheduler\", Scheduler);\r\nmodule.exports = Scheduler;\r\n"]},"metadata":{},"sourceType":"script"}