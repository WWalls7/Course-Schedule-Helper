{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/workspaces/ui.scheduler.work_space.indicator.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _uiScheduler = require(\"./ui.scheduler.work_space\");\n\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\n\nvar _component_registrator = require(\"../../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _date = require(\"../../../core/utils/date\");\n\nvar _date2 = _interopRequireDefault(_date);\n\nvar _extend = require(\"../../../core/utils/extend\");\n\nvar _window = require(\"../../../core/utils/window\");\n\nvar _window2 = _interopRequireDefault(_window);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar toMs = _date2.default.dateToMilliseconds;\nvar SCHEDULER_DATE_TIME_INDICATOR_CLASS = \"dx-scheduler-date-time-indicator\";\nvar TIME_PANEL_CURRENT_TIME_CELL_CLASS = \"dx-scheduler-time-panel-current-time-cell\";\nvar HEADER_CURRENT_TIME_CELL_CLASS = \"dx-scheduler-header-panel-current-time-cell\";\n\nvar SchedulerWorkSpaceIndicator = _uiScheduler2.default.inherit({\n  _getToday: function () {\n    var date = this.option(\"indicatorTime\") || new Date();\n    return this.invoke(\"convertDateByTimezone\", date) || date;\n  },\n  _needRenderDateTimeIndicator: function () {\n    var today = this._getToday();\n\n    var endViewDate = _date2.default.trimTime(this.getEndViewDate());\n\n    return _date2.default.dateInRange(today, this._firstViewDate, new Date(endViewDate.getTime() + toMs(\"day\")));\n  },\n  needRenderDateTimeIndication: function () {\n    if (!_window2.default.hasWindow()) {\n      return false;\n    }\n\n    var today = this._getToday();\n\n    return today >= _date2.default.trimTime(new Date(this.getStartViewDate()));\n  },\n  _renderDateTimeIndication: function () {\n    if (this.needRenderDateTimeIndication()) {\n      if (this.option(\"shadeUntilCurrentTime\")) {\n        this._shader.render(this);\n      }\n\n      if (this.option(\"showCurrentTimeIndicator\") && this._needRenderDateTimeIndicator()) {\n        var groupCount = this._getGroupCount() || 1;\n\n        var $container = this._dateTableScrollable.$content();\n\n        var height = this.getIndicationHeight();\n\n        var rtlOffset = this._getRtlOffset(this.getCellWidth());\n\n        if (height > 0) {\n          this._renderIndicator(height, rtlOffset, $container, groupCount);\n        }\n      }\n    }\n  },\n  _renderIndicator: function (height, rtlOffset, $container, groupCount) {\n    for (var i = 0; i < groupCount; i++) {\n      var $indicator = this._createIndicator($container);\n\n      $indicator.width(this.getCellWidth());\n\n      this._groupedStrategy.shiftIndicator($indicator, height, rtlOffset, i);\n    }\n  },\n  _createIndicator: function ($container) {\n    var $indicator = (0, _renderer2.default)(\"<div>\").addClass(SCHEDULER_DATE_TIME_INDICATOR_CLASS);\n    $container.append($indicator);\n    return $indicator;\n  },\n  _getRtlOffset: function (width) {\n    return this.option(\"rtlEnabled\") ? this._dateTableScrollable.$content().get(0).getBoundingClientRect().width - this.getTimePanelWidth() - width : 0;\n  },\n  _setIndicationUpdateInterval: function () {\n    if (!this.option(\"showCurrentTimeIndicator\") || 0 === this.option(\"indicatorUpdateInterval\")) {\n      return;\n    }\n\n    this._clearIndicatorUpdateInterval();\n\n    this._indicatorInterval = setInterval(function () {\n      this._refreshDateTimeIndication();\n    }.bind(this), this.option(\"indicatorUpdateInterval\"));\n  },\n  _clearIndicatorUpdateInterval: function () {\n    if (this._indicatorInterval) {\n      clearInterval(this._indicatorInterval);\n      delete this._indicatorInterval;\n    }\n  },\n  _isVerticalShader: function () {\n    return true;\n  },\n  getIndicationWidth: function (groupIndex) {\n    var maxWidth = this.getCellWidth() * this._getCellCount();\n\n    var difference = this._getIndicatorDuration();\n\n    if (difference > this._getCellCount()) {\n      difference = this._getCellCount();\n    }\n\n    var width = difference * this.getRoundedCellWidth(groupIndex, groupIndex * this._getCellCount(), difference);\n    return maxWidth < width ? maxWidth : width;\n  },\n  getIndicatorOffset: function (groupIndex) {\n    var difference = this._getIndicatorDuration() - 1;\n    var offset = difference * this.getRoundedCellWidth(groupIndex, groupIndex * this._getCellCount(), difference);\n    return offset;\n  },\n  _getIndicatorDuration: function () {\n    var today = this._getToday();\n\n    var firstViewDate = new Date(this._firstViewDate);\n    var timeDiff = today.getTime() - firstViewDate.getTime();\n\n    if (\"workWeek\" === this.option(\"type\")) {\n      timeDiff -= this._getWeekendsCount(Math.round(timeDiff / toMs(\"day\"))) * toMs(\"day\");\n    }\n\n    return Math.ceil((timeDiff + 1) / toMs(\"day\"));\n  },\n  getIndicationHeight: function () {\n    var today = this._getToday();\n\n    var cellHeight = this.getCellHeight();\n    var date = new Date(this._firstViewDate);\n\n    if (this._needRenderDateTimeIndicator()) {\n      date.setFullYear(today.getFullYear(), today.getMonth(), today.getDate());\n    }\n\n    var duration = today.getTime() - date.getTime();\n    var cellCount = duration / this.getCellDuration();\n    return cellCount * cellHeight;\n  },\n  _dispose: function () {\n    this._clearIndicatorUpdateInterval();\n\n    this.callBase.apply(this, arguments);\n  },\n  _refreshDateTimeIndication: function () {\n    this._cleanDateTimeIndicator();\n\n    this._shader && this._shader.clean();\n\n    this._renderDateTimeIndication();\n  },\n  _isCurrentTime: function (date) {\n    if (this.option(\"showCurrentTimeIndicator\") && this._needRenderDateTimeIndicator()) {\n      var today = this._getToday();\n\n      var result = false;\n      date = new Date(date);\n      date.setFullYear(today.getFullYear(), today.getMonth(), today.getDate());\n      var startCellDate = new Date(date);\n      var endCellDate = new Date(date);\n\n      if (_date2.default.sameDate(today, date)) {\n        startCellDate = startCellDate.setMilliseconds(date.getMilliseconds() - this.getCellDuration() + 1);\n        endCellDate = endCellDate.setMilliseconds(date.getMilliseconds() + this.getCellDuration());\n        result = _date2.default.dateInRange(today, startCellDate, endCellDate);\n      }\n\n      return result;\n    }\n  },\n  _isCurrentTimeHeaderCell: function (headerIndex) {\n    var result = false;\n\n    if (this.option(\"showCurrentTimeIndicator\") && this._needRenderDateTimeIndicator()) {\n      var date = this._getDateByIndex(headerIndex);\n\n      var now = this.option(\"indicatorTime\") || new Date();\n      result = _date2.default.sameDate(date, now);\n    }\n\n    return result;\n  },\n  _getTimeCellClass: function (i) {\n    var startViewDate = this._getTimeCellDate(i);\n\n    var cellClass = this.callBase(i);\n\n    if (this._isCurrentTime(startViewDate)) {\n      return cellClass + \" \" + TIME_PANEL_CURRENT_TIME_CELL_CLASS;\n    }\n\n    return cellClass;\n  },\n  _getHeaderPanelCellClass: function (i) {\n    var cellClass = this.callBase(i);\n\n    if (this._isCurrentTimeHeaderCell(i)) {\n      return cellClass + \" \" + HEADER_CURRENT_TIME_CELL_CLASS;\n    }\n\n    return cellClass;\n  },\n  _cleanView: function () {\n    this.callBase();\n\n    this._cleanDateTimeIndicator();\n  },\n  _dimensionChanged: function () {\n    this.callBase();\n\n    this._refreshDateTimeIndication();\n  },\n  _cleanDateTimeIndicator: function () {\n    this.$element().find(\".\" + SCHEDULER_DATE_TIME_INDICATOR_CLASS).remove();\n  },\n  _cleanWorkSpace: function () {\n    this.callBase();\n\n    this._renderDateTimeIndication();\n\n    this._setIndicationUpdateInterval();\n  },\n  _optionChanged: function (args) {\n    switch (args.name) {\n      case \"showCurrentTimeIndicator\":\n      case \"indicatorTime\":\n        this._cleanWorkSpace();\n\n        break;\n\n      case \"indicatorUpdateInterval\":\n        this._setIndicationUpdateInterval();\n\n        break;\n\n      case \"showAllDayPanel\":\n        this.callBase(args);\n\n        this._refreshDateTimeIndication();\n\n        break;\n\n      case \"allDayExpanded\":\n        this.callBase(args);\n\n        this._refreshDateTimeIndication();\n\n        break;\n\n      case \"crossScrollingEnabled\":\n        this.callBase(args);\n\n        this._refreshDateTimeIndication();\n\n        break;\n\n      case \"shadeUntilCurrentTime\":\n        this._refreshDateTimeIndication();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _getDefaultOptions: function () {\n    return (0, _extend.extend)(this.callBase(), {\n      showCurrentTimeIndicator: true,\n      indicatorTime: new Date(),\n      indicatorUpdateInterval: 5 * toMs(\"minute\"),\n      shadeUntilCurrentTime: true\n    });\n  }\n});\n\n(0, _component_registrator2.default)(\"dxSchedulerWorkSpace\", SchedulerWorkSpaceIndicator);\nmodule.exports = SchedulerWorkSpaceIndicator;","map":{"version":3,"sources":["C:/Users/Swizzle/Desktop/SE Project/Application/csh/node_modules/devextreme/ui/scheduler/workspaces/ui.scheduler.work_space.indicator.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_uiScheduler","_uiScheduler2","_component_registrator","_component_registrator2","_date","_date2","_extend","_window","_window2","obj","__esModule","toMs","default","dateToMilliseconds","SCHEDULER_DATE_TIME_INDICATOR_CLASS","TIME_PANEL_CURRENT_TIME_CELL_CLASS","HEADER_CURRENT_TIME_CELL_CLASS","SchedulerWorkSpaceIndicator","inherit","_getToday","date","option","Date","invoke","_needRenderDateTimeIndicator","today","endViewDate","trimTime","getEndViewDate","dateInRange","_firstViewDate","getTime","needRenderDateTimeIndication","hasWindow","getStartViewDate","_renderDateTimeIndication","_shader","render","groupCount","_getGroupCount","$container","_dateTableScrollable","$content","height","getIndicationHeight","rtlOffset","_getRtlOffset","getCellWidth","_renderIndicator","i","$indicator","_createIndicator","width","_groupedStrategy","shiftIndicator","addClass","append","get","getBoundingClientRect","getTimePanelWidth","_setIndicationUpdateInterval","_clearIndicatorUpdateInterval","_indicatorInterval","setInterval","_refreshDateTimeIndication","bind","clearInterval","_isVerticalShader","getIndicationWidth","groupIndex","maxWidth","_getCellCount","difference","_getIndicatorDuration","getRoundedCellWidth","getIndicatorOffset","offset","firstViewDate","timeDiff","_getWeekendsCount","Math","round","ceil","cellHeight","getCellHeight","setFullYear","getFullYear","getMonth","getDate","duration","cellCount","getCellDuration","_dispose","callBase","apply","arguments","_cleanDateTimeIndicator","clean","_isCurrentTime","result","startCellDate","endCellDate","sameDate","setMilliseconds","getMilliseconds","_isCurrentTimeHeaderCell","headerIndex","_getDateByIndex","now","_getTimeCellClass","startViewDate","_getTimeCellDate","cellClass","_getHeaderPanelCellClass","_cleanView","_dimensionChanged","$element","find","remove","_cleanWorkSpace","_optionChanged","args","name","_getDefaultOptions","extend","showCurrentTimeIndicator","indicatorTime","indicatorUpdateInterval","shadeUntilCurrentTime","module","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/workspaces/ui.scheduler.work_space.indicator.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _uiScheduler = require(\"./ui.scheduler.work_space\");\r\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\r\nvar _component_registrator = require(\"../../../core/component_registrator\");\r\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\r\nvar _date = require(\"../../../core/utils/date\");\r\nvar _date2 = _interopRequireDefault(_date);\r\nvar _extend = require(\"../../../core/utils/extend\");\r\nvar _window = require(\"../../../core/utils/window\");\r\nvar _window2 = _interopRequireDefault(_window);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar toMs = _date2.default.dateToMilliseconds;\r\nvar SCHEDULER_DATE_TIME_INDICATOR_CLASS = \"dx-scheduler-date-time-indicator\";\r\nvar TIME_PANEL_CURRENT_TIME_CELL_CLASS = \"dx-scheduler-time-panel-current-time-cell\";\r\nvar HEADER_CURRENT_TIME_CELL_CLASS = \"dx-scheduler-header-panel-current-time-cell\";\r\nvar SchedulerWorkSpaceIndicator = _uiScheduler2.default.inherit({\r\n    _getToday: function() {\r\n        var date = this.option(\"indicatorTime\") || new Date;\r\n        return this.invoke(\"convertDateByTimezone\", date) || date\r\n    },\r\n    _needRenderDateTimeIndicator: function() {\r\n        var today = this._getToday();\r\n        var endViewDate = _date2.default.trimTime(this.getEndViewDate());\r\n        return _date2.default.dateInRange(today, this._firstViewDate, new Date(endViewDate.getTime() + toMs(\"day\")))\r\n    },\r\n    needRenderDateTimeIndication: function() {\r\n        if (!_window2.default.hasWindow()) {\r\n            return false\r\n        }\r\n        var today = this._getToday();\r\n        return today >= _date2.default.trimTime(new Date(this.getStartViewDate()))\r\n    },\r\n    _renderDateTimeIndication: function() {\r\n        if (this.needRenderDateTimeIndication()) {\r\n            if (this.option(\"shadeUntilCurrentTime\")) {\r\n                this._shader.render(this)\r\n            }\r\n            if (this.option(\"showCurrentTimeIndicator\") && this._needRenderDateTimeIndicator()) {\r\n                var groupCount = this._getGroupCount() || 1;\r\n                var $container = this._dateTableScrollable.$content();\r\n                var height = this.getIndicationHeight();\r\n                var rtlOffset = this._getRtlOffset(this.getCellWidth());\r\n                if (height > 0) {\r\n                    this._renderIndicator(height, rtlOffset, $container, groupCount)\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _renderIndicator: function(height, rtlOffset, $container, groupCount) {\r\n        for (var i = 0; i < groupCount; i++) {\r\n            var $indicator = this._createIndicator($container);\r\n            $indicator.width(this.getCellWidth());\r\n            this._groupedStrategy.shiftIndicator($indicator, height, rtlOffset, i)\r\n        }\r\n    },\r\n    _createIndicator: function($container) {\r\n        var $indicator = (0, _renderer2.default)(\"<div>\").addClass(SCHEDULER_DATE_TIME_INDICATOR_CLASS);\r\n        $container.append($indicator);\r\n        return $indicator\r\n    },\r\n    _getRtlOffset: function(width) {\r\n        return this.option(\"rtlEnabled\") ? this._dateTableScrollable.$content().get(0).getBoundingClientRect().width - this.getTimePanelWidth() - width : 0\r\n    },\r\n    _setIndicationUpdateInterval: function() {\r\n        if (!this.option(\"showCurrentTimeIndicator\") || 0 === this.option(\"indicatorUpdateInterval\")) {\r\n            return\r\n        }\r\n        this._clearIndicatorUpdateInterval();\r\n        this._indicatorInterval = setInterval(function() {\r\n            this._refreshDateTimeIndication()\r\n        }.bind(this), this.option(\"indicatorUpdateInterval\"))\r\n    },\r\n    _clearIndicatorUpdateInterval: function() {\r\n        if (this._indicatorInterval) {\r\n            clearInterval(this._indicatorInterval);\r\n            delete this._indicatorInterval\r\n        }\r\n    },\r\n    _isVerticalShader: function() {\r\n        return true\r\n    },\r\n    getIndicationWidth: function(groupIndex) {\r\n        var maxWidth = this.getCellWidth() * this._getCellCount();\r\n        var difference = this._getIndicatorDuration();\r\n        if (difference > this._getCellCount()) {\r\n            difference = this._getCellCount()\r\n        }\r\n        var width = difference * this.getRoundedCellWidth(groupIndex, groupIndex * this._getCellCount(), difference);\r\n        return maxWidth < width ? maxWidth : width\r\n    },\r\n    getIndicatorOffset: function(groupIndex) {\r\n        var difference = this._getIndicatorDuration() - 1;\r\n        var offset = difference * this.getRoundedCellWidth(groupIndex, groupIndex * this._getCellCount(), difference);\r\n        return offset\r\n    },\r\n    _getIndicatorDuration: function() {\r\n        var today = this._getToday();\r\n        var firstViewDate = new Date(this._firstViewDate);\r\n        var timeDiff = today.getTime() - firstViewDate.getTime();\r\n        if (\"workWeek\" === this.option(\"type\")) {\r\n            timeDiff -= this._getWeekendsCount(Math.round(timeDiff / toMs(\"day\"))) * toMs(\"day\")\r\n        }\r\n        return Math.ceil((timeDiff + 1) / toMs(\"day\"))\r\n    },\r\n    getIndicationHeight: function() {\r\n        var today = this._getToday();\r\n        var cellHeight = this.getCellHeight();\r\n        var date = new Date(this._firstViewDate);\r\n        if (this._needRenderDateTimeIndicator()) {\r\n            date.setFullYear(today.getFullYear(), today.getMonth(), today.getDate())\r\n        }\r\n        var duration = today.getTime() - date.getTime();\r\n        var cellCount = duration / this.getCellDuration();\r\n        return cellCount * cellHeight\r\n    },\r\n    _dispose: function() {\r\n        this._clearIndicatorUpdateInterval();\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _refreshDateTimeIndication: function() {\r\n        this._cleanDateTimeIndicator();\r\n        this._shader && this._shader.clean();\r\n        this._renderDateTimeIndication()\r\n    },\r\n    _isCurrentTime: function(date) {\r\n        if (this.option(\"showCurrentTimeIndicator\") && this._needRenderDateTimeIndicator()) {\r\n            var today = this._getToday();\r\n            var result = false;\r\n            date = new Date(date);\r\n            date.setFullYear(today.getFullYear(), today.getMonth(), today.getDate());\r\n            var startCellDate = new Date(date);\r\n            var endCellDate = new Date(date);\r\n            if (_date2.default.sameDate(today, date)) {\r\n                startCellDate = startCellDate.setMilliseconds(date.getMilliseconds() - this.getCellDuration() + 1);\r\n                endCellDate = endCellDate.setMilliseconds(date.getMilliseconds() + this.getCellDuration());\r\n                result = _date2.default.dateInRange(today, startCellDate, endCellDate)\r\n            }\r\n            return result\r\n        }\r\n    },\r\n    _isCurrentTimeHeaderCell: function(headerIndex) {\r\n        var result = false;\r\n        if (this.option(\"showCurrentTimeIndicator\") && this._needRenderDateTimeIndicator()) {\r\n            var date = this._getDateByIndex(headerIndex);\r\n            var now = this.option(\"indicatorTime\") || new Date;\r\n            result = _date2.default.sameDate(date, now)\r\n        }\r\n        return result\r\n    },\r\n    _getTimeCellClass: function(i) {\r\n        var startViewDate = this._getTimeCellDate(i);\r\n        var cellClass = this.callBase(i);\r\n        if (this._isCurrentTime(startViewDate)) {\r\n            return cellClass + \" \" + TIME_PANEL_CURRENT_TIME_CELL_CLASS\r\n        }\r\n        return cellClass\r\n    },\r\n    _getHeaderPanelCellClass: function(i) {\r\n        var cellClass = this.callBase(i);\r\n        if (this._isCurrentTimeHeaderCell(i)) {\r\n            return cellClass + \" \" + HEADER_CURRENT_TIME_CELL_CLASS\r\n        }\r\n        return cellClass\r\n    },\r\n    _cleanView: function() {\r\n        this.callBase();\r\n        this._cleanDateTimeIndicator()\r\n    },\r\n    _dimensionChanged: function() {\r\n        this.callBase();\r\n        this._refreshDateTimeIndication()\r\n    },\r\n    _cleanDateTimeIndicator: function() {\r\n        this.$element().find(\".\" + SCHEDULER_DATE_TIME_INDICATOR_CLASS).remove()\r\n    },\r\n    _cleanWorkSpace: function() {\r\n        this.callBase();\r\n        this._renderDateTimeIndication();\r\n        this._setIndicationUpdateInterval()\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"showCurrentTimeIndicator\":\r\n            case \"indicatorTime\":\r\n                this._cleanWorkSpace();\r\n                break;\r\n            case \"indicatorUpdateInterval\":\r\n                this._setIndicationUpdateInterval();\r\n                break;\r\n            case \"showAllDayPanel\":\r\n                this.callBase(args);\r\n                this._refreshDateTimeIndication();\r\n                break;\r\n            case \"allDayExpanded\":\r\n                this.callBase(args);\r\n                this._refreshDateTimeIndication();\r\n                break;\r\n            case \"crossScrollingEnabled\":\r\n                this.callBase(args);\r\n                this._refreshDateTimeIndication();\r\n                break;\r\n            case \"shadeUntilCurrentTime\":\r\n                this._refreshDateTimeIndication();\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            showCurrentTimeIndicator: true,\r\n            indicatorTime: new Date,\r\n            indicatorUpdateInterval: 5 * toMs(\"minute\"),\r\n            shadeUntilCurrentTime: true\r\n        })\r\n    }\r\n});\r\n(0, _component_registrator2.default)(\"dxSchedulerWorkSpace\", SchedulerWorkSpaceIndicator);\r\nmodule.exports = SchedulerWorkSpaceIndicator;\r\n"]},"metadata":{},"sourceType":"script"}